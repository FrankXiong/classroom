!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.AV=e.AV||{})}(this,function(e){"use strict";function t(e,t){return t={exports:{}},e(t,t.exports,s),t.exports}function n(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],t=e.signature,n=e.timestamp,r=e.nonce;if("string"!=typeof t||"number"!=typeof n||"string"!=typeof r)throw new Error("malformed signature");return{signature:t,timestamp:n,nonce:r}}var r="undefined"!=typeof window?window:"undefined"!=typeof r?r:this,i=void 0,o=o||function(e){throw new Error("Unexpected required "+e)},s="undefined"!=typeof window?window:"undefined"!=typeof r?r:this,a=window.process||{};a.env=a.env||{};var f=t(function(e){var t=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=t)}),u=f&&"object"==typeof f&&"default"in f?f["default"]:f,l=t(function(e){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")}),c=l&&"object"==typeof l&&"default"in l?l["default"]:l,h=t(function(e){var t=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++t+n).toString(36))}}),d=h&&"object"==typeof h&&"default"in h?h["default"]:h,p=t(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),y=p&&"object"==typeof p&&"default"in p?p["default"]:p,g=t(function(e){var t=y,n="__core-js_shared__",r=t[n]||(t[n]={});e.exports=function(e){return r[e]||(r[e]={})}}),m=g&&"object"==typeof g&&"default"in g?g["default"]:g,v=t(function(e){var t=m("keys"),n=d;e.exports=function(e){return t[e]||(t[e]=n(e))}}),b=v&&"object"==typeof v&&"default"in v?v["default"]:v,w=t(function(e){var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}}),E=w&&"object"==typeof w&&"default"in w?w["default"]:w,_=t(function(e){var t=E,n=Math.max,r=Math.min;e.exports=function(e,i){return e=t(e),0>e?n(e+i,0):r(e,i)}}),T=_&&"object"==typeof _&&"default"in _?_["default"]:_,S=t(function(e){var t=E,n=Math.min;e.exports=function(e){return e>0?n(t(e),9007199254740991):0}}),I=S&&"object"==typeof S&&"default"in S?S["default"]:S,j=t(function(e){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}}),x=j&&"object"==typeof j&&"default"in j?j["default"]:j,A=t(function(e){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}}),O=A&&"object"==typeof A&&"default"in A?A["default"]:A,P=t(function(e){var t=O;e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==t(e)?e.split(""):Object(e)}}),M=P&&"object"==typeof P&&"default"in P?P["default"]:P,R=t(function(e){var t=M,n=x;e.exports=function(e){return t(n(e))}}),C=R&&"object"==typeof R&&"default"in R?R["default"]:R,L=t(function(e){var t=C,n=I,r=T;e.exports=function(e){return function(i,o,s){var a,f=t(i),u=n(f.length),l=r(s,u);if(e&&o!=o){for(;u>l;)if(a=f[l++],a!=a)return!0}else for(;u>l;l++)if((e||l in f)&&f[l]===o)return e||l||0;return!e&&-1}}}),N=L&&"object"==typeof L&&"default"in L?L["default"]:L,k=t(function(e){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}}),F=k&&"object"==typeof k&&"default"in k?k["default"]:k,U=t(function(e){var t=F,n=C,r=N(!1),i=b("IE_PROTO");e.exports=function(e,o){var s,a=n(e),f=0,u=[];for(s in a)s!=i&&t(a,s)&&u.push(s);for(;o.length>f;)t(a,s=o[f++])&&(~r(u,s)||u.push(s));return u}}),Y=U&&"object"==typeof U&&"default"in U?U["default"]:U,B=t(function(e,t){var n=Y,r=c.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,r)}}),V=B&&"object"==typeof B&&"default"in B?B["default"]:B,D=t(function(e){var t=C,n=V.f,r={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(e){try{return n(e)}catch(t){return i.slice()}};e.exports.f=function(e){return i&&"[object Window]"==r.call(e)?o(e):n(t(e))}}),q=D&&"object"==typeof D&&"default"in D?D["default"]:D,z=t(function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}}),W=z&&"object"==typeof z&&"default"in z?z["default"]:z,$=t(function(e){e.exports=!W(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})}),Z=$&&"object"==typeof $&&"default"in $?$["default"]:$,J=t(function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}}),G=J&&"object"==typeof J&&"default"in J?J["default"]:J,H=t(function(e){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}}),X=H&&"object"==typeof H&&"default"in H?H["default"]:H,K=t(function(e){var t=X;e.exports=function(e,n){if(!t(e))return e;var r,i;if(n&&"function"==typeof(r=e.toString)&&!t(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!t(i=r.call(e)))return i;if(!n&&"function"==typeof(r=e.toString)&&!t(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}}),Q=K&&"object"==typeof K&&"default"in K?K["default"]:K,ee=t(function(e){var t=X,n=y.document,r=t(n)&&t(n.createElement);e.exports=function(e){return r?n.createElement(e):{}}}),te=ee&&"object"==typeof ee&&"default"in ee?ee["default"]:ee,ne=t(function(e){e.exports=!Z&&!W(function(){return 7!=Object.defineProperty(te("div"),"a",{get:function(){return 7}}).a})}),re=ne&&"object"==typeof ne&&"default"in ne?ne["default"]:ne,ie=t(function(e){var t=X;e.exports=function(e){if(!t(e))throw TypeError(e+" is not an object!");return e}}),oe=ie&&"object"==typeof ie&&"default"in ie?ie["default"]:ie,se=t(function(e,t){var n=oe,r=re,i=Q,o=Object.defineProperty;t.f=Z?Object.defineProperty:function(e,t,s){if(n(e),t=i(t,!0),n(s),r)try{return o(e,t,s)}catch(a){}if("get"in s||"set"in s)throw TypeError("Accessors not supported!");return"value"in s&&(e[t]=s.value),e}}),ae=se&&"object"==typeof se&&"default"in se?se["default"]:se,fe=t(function(e){var t=ae,n=G;e.exports=Z?function(e,r,i){return t.f(e,r,n(1,i))}:function(e,t,n){return e[t]=n,e}}),ue=fe&&"object"==typeof fe&&"default"in fe?fe["default"]:fe,le=t(function(e){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}}),ce=le&&"object"==typeof le&&"default"in le?le["default"]:le,he=t(function(e){var t=ce;e.exports=function(e,n,r){if(t(e),void 0===n)return e;switch(r){case 1:return function(t){return e.call(n,t)};case 2:return function(t,r){return e.call(n,t,r)};case 3:return function(t,r,i){return e.call(n,t,r,i)}}return function(){return e.apply(n,arguments)}}}),de=he&&"object"==typeof he&&"default"in he?he["default"]:he,pe=t(function(e,t){var n=y,r=u,i=de,o=ue,s="prototype",a=function(e,t,f){var u,l,c,h=e&a.F,d=e&a.G,p=e&a.S,y=e&a.P,g=e&a.B,m=e&a.W,v=d?r:r[t]||(r[t]={}),b=v[s],w=d?n:p?n[t]:(n[t]||{})[s];d&&(f=t);for(u in f)l=!h&&w&&void 0!==w[u],l&&u in v||(c=l?w[u]:f[u],v[u]=d&&"function"!=typeof w[u]?f[u]:g&&l?i(c,n):m&&w[u]==c?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t[s]=e[s],t}(c):y&&"function"==typeof c?i(Function.call,c):c,y&&((v.virtual||(v.virtual={}))[u]=c,e&a.R&&b&&!b[u]&&o(b,u,c)))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,e.exports=a}),ye=pe&&"object"==typeof pe&&"default"in pe?pe["default"]:pe,ge=t(function(e){var t=ye,n=u,r=W;e.exports=function(e,i){var o=(n.Object||{})[e]||Object[e],s={};s[e]=i(o),t(t.S+t.F*r(function(){o(1)}),"Object",s)}}),me=ge&&"object"==typeof ge&&"default"in ge?ge["default"]:ge,ve=(t(function(e){me("getOwnPropertyNames",function(){return q.f})}),t(function(e){var t=u.Object;e.exports=function(e){return t.getOwnPropertyNames(e)}})),be=ve&&"object"==typeof ve&&"default"in ve?ve["default"]:ve,we=t(function(e){e.exports={"default":be,__esModule:!0}}),Ee=we&&"object"==typeof we&&"default"in we?we["default"]:we,_e=t(function(e){e.exports=function(){}}),Te=_e&&"object"==typeof _e&&"default"in _e?_e["default"]:_e,Se=t(function(e){var t=m("wks"),n=d,r=y.Symbol,i="function"==typeof r,o=e.exports=function(e){return t[e]||(t[e]=i&&r[e]||(i?r:n)("Symbol."+e))};o.store=t}),Ie=Se&&"object"==typeof Se&&"default"in Se?Se["default"]:Se,je=t(function(e){var t=O;e.exports=Array.isArray||function(e){return"Array"==t(e)}}),xe=je&&"object"==typeof je&&"default"in je?je["default"]:je,Ae=t(function(e){var t=X,n=xe,r=Ie("species");e.exports=function(e){var i;return n(e)&&(i=e.constructor,"function"!=typeof i||i!==Array&&!n(i.prototype)||(i=void 0),t(i)&&(i=i[r],null===i&&(i=void 0))),void 0===i?Array:i}}),Oe=Ae&&"object"==typeof Ae&&"default"in Ae?Ae["default"]:Ae,Pe=t(function(e){var t=Oe;e.exports=function(e,n){return new(t(e))(n)}}),Me=Pe&&"object"==typeof Pe&&"default"in Pe?Pe["default"]:Pe,Re=t(function(e){var t=x;e.exports=function(e){return Object(t(e))}}),Ce=Re&&"object"==typeof Re&&"default"in Re?Re["default"]:Re,Le=t(function(e){var t=de,n=M,r=Ce,i=I,o=Me;e.exports=function(e,s){var a=1==e,f=2==e,u=3==e,l=4==e,c=6==e,h=5==e||c,d=s||o;return function(o,s,p){for(var y,g,m=r(o),v=n(m),b=t(s,p,3),w=i(v.length),E=0,_=a?d(o,w):f?d(o,0):void 0;w>E;E++)if((h||E in v)&&(y=v[E],g=b(y,E,m),e))if(a)_[E]=g;else if(g)switch(e){case 3:return!0;case 5:return y;case 6:return E;case 2:_.push(y)}else if(l)return!1;return c?-1:u||l?l:_}}}),Ne=Le&&"object"==typeof Le&&"default"in Le?Le["default"]:Le,ke=(t(function(e){var t=ye,n=Ne(5),r="find",i=!0;r in[]&&Array(1)[r](function(){i=!1}),t(t.P+t.F*i,"Array",{find:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),Te(r)}),t(function(e){e.exports=u.Array.find})),Fe=ke&&"object"==typeof ke&&"default"in ke?ke["default"]:ke,Ue=t(function(e){e.exports={"default":Fe,__esModule:!0}}),Ye=Ue&&"object"==typeof Ue&&"default"in Ue?Ue["default"]:Ue,Be=t(function(e){var t=Ie("iterator"),n=!1;try{var r=[7][t]();r["return"]=function(){n=!0},Array.from(r,function(){throw 2})}catch(i){}e.exports=function(e,r){if(!r&&!n)return!1;var i=!1;try{var o=[7],s=o[t]();s.next=function(){return{done:i=!0}},o[t]=function(){return s},e(o)}catch(a){}return i}}),Ve=Be&&"object"==typeof Be&&"default"in Be?Be["default"]:Be,De=t(function(e){var t=y,n=u,r=ae,i=Z,o=Ie("species");e.exports=function(e){var s="function"==typeof n[e]?n[e]:t[e];i&&s&&!s[o]&&r.f(s,o,{configurable:!0,get:function(){return this}})}}),qe=De&&"object"==typeof De&&"default"in De?De["default"]:De,ze=t(function(e){var t=ae.f,n=F,r=Ie("toStringTag");e.exports=function(e,i,o){e&&!n(e=o?e:e.prototype,r)&&t(e,r,{configurable:!0,value:i})}}),We=ze&&"object"==typeof ze&&"default"in ze?ze["default"]:ze,$e=t(function(e){var t=ue;e.exports=function(e,n,r){for(var i in n)r&&e[i]?e[i]=n[i]:t(e,i,n[i]);return e}}),Ze=$e&&"object"==typeof $e&&"default"in $e?$e["default"]:$e,Je=t(function(e){e.exports=y.document&&document.documentElement}),Ge=Je&&"object"==typeof Je&&"default"in Je?Je["default"]:Je,He=t(function(e){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}}),Xe=He&&"object"==typeof He&&"default"in He?He["default"]:He,Ke=t(function(e,t,n){var r,i,o,s=de,a=Xe,f=Ge,u=te,n=y,l=n.process,c=n.setImmediate,h=n.clearImmediate,d=n.MessageChannel,p=0,g={},m="onreadystatechange",v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},b=function(e){v.call(e.data)};c&&h||(c=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++p]=function(){a("function"==typeof e?e:Function(e),t)},r(p),p},h=function(e){delete g[e]},"process"==O(l)?r=function(e){l.nextTick(s(v,e,1))}:d?(i=new d,o=i.port2,i.port1.onmessage=b,r=s(o.postMessage,o,1)):n.addEventListener&&"function"==typeof postMessage&&!n.importScripts?(r=function(e){n.postMessage(e+"","*")},n.addEventListener("message",b,!1)):r=m in u("script")?function(e){f.appendChild(u("script"))[m]=function(){f.removeChild(this),v.call(e)}}:function(e){setTimeout(s(v,e,1),0)}),e.exports={set:c,clear:h}}),Qe=Ke&&"object"==typeof Ke&&"default"in Ke?Ke["default"]:Ke,et=t(function(e){var t=y,n=Qe.set,r=t.MutationObserver||t.WebKitMutationObserver,i=t.process,o=t.Promise,s="process"==O(i);e.exports=function(){var e,a,f,u=function(){var t,n;for(s&&(t=i.domain)&&t.exit();e;){n=e.fn,e=e.next;try{n()}catch(r){throw e?f():a=void 0,r}}a=void 0,t&&t.enter()};if(s)f=function(){i.nextTick(u)};else if(r){var l=!0,c=document.createTextNode("");new r(u).observe(c,{characterData:!0}),f=function(){c.data=l=!l}}else if(o&&o.resolve){var h=o.resolve();f=function(){h.then(u)}}else f=function(){n.call(t,u)};return function(t){var n={fn:t,next:void 0};a&&(a.next=n),e||(e=n,f()),a=n}}}),tt=et&&"object"==typeof et&&"default"in et?et["default"]:et,nt=t(function(e){var t=oe,n=ce,r=Ie("species");e.exports=function(e,i){var o,s=t(e).constructor;return void 0===s||void 0==(o=t(s)[r])?i:n(o)}}),rt=nt&&"object"==typeof nt&&"default"in nt?nt["default"]:nt,it=t(function(e,t){t.f={}.propertyIsEnumerable}),ot=it&&"object"==typeof it&&"default"in it?it["default"]:it,st=t(function(e,t){var n=ot,r=G,i=C,o=Q,s=F,a=re,f=Object.getOwnPropertyDescriptor;t.f=Z?f:function(e,t){if(e=i(e),t=o(t,!0),a)try{return f(e,t)}catch(u){}return s(e,t)?r(!n.f.call(e,t),e[t]):void 0}}),at=st&&"object"==typeof st&&"default"in st?st["default"]:st,ft=t(function(e){var t=X,n=oe,r=function(e,r){if(n(e),!t(r)&&null!==r)throw TypeError(r+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{n=de(Function.call,at.f(Object.prototype,"__proto__").set,2),n(e,[]),t=!(e instanceof Array)}catch(i){t=!0}return function(e,i){return r(e,i),t?e.__proto__=i:n(e,i),e}}({},!1):void 0),check:r}}),ut=ft&&"object"==typeof ft&&"default"in ft?ft["default"]:ft,lt=t(function(e){e.exports={}}),ct=lt&&"object"==typeof lt&&"default"in lt?lt["default"]:lt,ht=t(function(e){var t=O,n=Ie("toStringTag"),r="Arguments"==t(function(){return arguments}()),i=function(e,t){try{return e[t]}catch(n){}};e.exports=function(e){var o,s,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=i(o=Object(e),n))?s:r?t(o):"Object"==(a=t(o))&&"function"==typeof o.callee?"Arguments":a}}),dt=ht&&"object"==typeof ht&&"default"in ht?ht["default"]:ht,pt=t(function(e){var t=dt,n=Ie("iterator"),r=ct;e.exports=u.getIteratorMethod=function(e){return void 0!=e?e[n]||e["@@iterator"]||r[t(e)]:void 0}}),yt=pt&&"object"==typeof pt&&"default"in pt?pt["default"]:pt,gt=t(function(e){var t=ct,n=Ie("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(t.Array===e||r[n]===e)}}),mt=gt&&"object"==typeof gt&&"default"in gt?gt["default"]:gt,vt=t(function(e){var t=oe;e.exports=function(e,n,r,i){try{return i?n(t(r)[0],r[1]):n(r)}catch(o){var s=e["return"];throw void 0!==s&&t(s.call(e)),o}}}),bt=vt&&"object"==typeof vt&&"default"in vt?vt["default"]:vt,wt=t(function(e){var t=de,n=bt,r=mt,i=oe,o=I,s=yt,a={},f={},u=e.exports=function(e,u,l,c,h){var d,p,y,g,m=h?function(){return e}:s(e),v=t(l,c,u?2:1),b=0;if("function"!=typeof m)throw TypeError(e+" is not iterable!");if(r(m)){for(d=o(e.length);d>b;b++)if(g=u?v(i(p=e[b])[0],p[1]):v(e[b]),g===a||g===f)return g}else for(y=m.call(e);!(p=y.next()).done;)if(g=n(y,v,p.value,u),g===a||g===f)return g};u.BREAK=a,u.RETURN=f}),Et=wt&&"object"==typeof wt&&"default"in wt?wt["default"]:wt,_t=t(function(e){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}}),Tt=_t&&"object"==typeof _t&&"default"in _t?_t["default"]:_t,St=t(function(e){e.exports=!0}),It=St&&"object"==typeof St&&"default"in St?St["default"]:St,jt=(t(function(e,t,n){var r,i,o,s=It,n=y,a=de,f=dt,l=ye,c=X,h=ce,d=Tt,p=Et,g=(ut.set,rt),m=Qe.set,v=tt(),b="Promise",w=n.TypeError,E=n.process,_=n[b],E=n.process,T="process"==f(E),S=function(){},I=!!function(){try{var e=_.resolve(1),t=(e.constructor={})[Ie("species")]=function(e){e(S,S)};return(T||"function"==typeof PromiseRejectionEvent)&&e.then(S)instanceof t}catch(n){}}(),j=function(e,t){return e===t||e===_&&t===o},x=function(e){var t;return c(e)&&"function"==typeof(t=e.then)?t:!1},A=function(e){return j(_,e)?new O(e):new i(e)},O=i=function(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw w("Bad Promise constructor");t=e,n=r}),this.resolve=h(t),this.reject=h(n)},P=function(e){try{e()}catch(t){return{error:t}}},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s=i?t.ok:t.fail,a=t.resolve,f=t.reject,u=t.domain;try{s?(i||(2==e._h&&L(e),e._h=1),s===!0?n=r:(u&&u.enter(),n=s(r),u&&u.exit()),n===t.promise?f(w("Promise-chain cycle")):(o=x(n))?o.call(n,a,f):a(n)):f(r)}catch(l){f(l)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&R(e)})}},R=function(e){m.call(n,function(){var t,r,i,o=e._v;if(C(e)&&(t=P(function(){T?E.emit("unhandledRejection",o,e):(r=n.onunhandledrejection)?r({promise:e,reason:o}):(i=n.console)&&i.error&&i.error("Unhandled promise rejection",o)}),e._h=T||C(e)?2:1),e._a=void 0,t)throw t.error})},C=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if(t=n[r++],t.fail||!C(t.promise))return!1;return!0},L=function(e){m.call(n,function(){var t;T?E.emit("rejectionHandled",e):(t=n.onrejectionhandled)&&t({promise:e,reason:e._v})})},N=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},k=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw w("Promise can't be resolved itself");(t=x(e))?v(function(){var r={_w:n,_d:!1};try{t.call(e,a(k,r,1),a(N,r,1))}catch(i){N.call(r,i)}}):(n._v=e,n._s=1,M(n,!1))}catch(r){N.call({_w:n,_d:!1},r)}}};I||(_=function(e){d(this,_,b,"_h"),h(e),r.call(this);try{e(a(k,this,1),a(N,this,1))}catch(t){N.call(this,t)}},r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},r.prototype=Ze(_.prototype,{then:function(e,t){var n=A(g(this,_));return n.ok="function"==typeof e?e:!0,n.fail="function"==typeof t&&t,n.domain=T?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},"catch":function(e){return this.then(void 0,e)}}),O=function(){var e=new r;this.promise=e,this.resolve=a(k,e,1),this.reject=a(N,e,1)}),l(l.G+l.W+l.F*!I,{Promise:_}),We(_,b),qe(b),o=u[b],l(l.S+l.F*!I,b,{reject:function(e){var t=A(this),n=t.reject;return n(e),t.promise}}),l(l.S+l.F*(s||!I),b,{resolve:function(e){if(e instanceof _&&j(e.constructor,this))return e;var t=A(this),n=t.resolve;return n(e),t.promise}}),l(l.S+l.F*!(I&&Ve(function(e){_.all(e)["catch"](S)})),b,{all:function(e){var t=this,n=A(t),r=n.resolve,i=n.reject,o=P(function(){var n=[],o=0,s=1;p(e,!1,function(e){var a=o++,f=!1;n.push(void 0),s++,t.resolve(e).then(function(e){f||(f=!0,n[a]=e,--s||r(n))},i)}),--s||r(n)});return o&&i(o.error),n.promise},race:function(e){var t=this,n=A(t),r=n.reject,i=P(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i&&r(i.error),n.promise}})}),t(function(e){var t=F,n=Ce,r=b("IE_PROTO"),i=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=n(e),t(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?i:null}})),xt=jt&&"object"==typeof jt&&"default"in jt?jt["default"]:jt,At=t(function(e){var t=Y,n=c;e.exports=Object.keys||function(e){return t(e,n)}}),Ot=At&&"object"==typeof At&&"default"in At?At["default"]:At,Pt=t(function(e){var t=ae,n=oe,r=Ot;e.exports=Z?Object.defineProperties:function(e,i){n(e);for(var o,s=r(i),a=s.length,f=0;a>f;)t.f(e,o=s[f++],i[o]);return e}}),Mt=Pt&&"object"==typeof Pt&&"default"in Pt?Pt["default"]:Pt,Rt=t(function(e){var t=oe,n=Mt,r=c,i=b("IE_PROTO"),o=function(){},s="prototype",a=function(){var e,t=te("iframe"),n=r.length,i=">";for(t.style.display="none",Ge.appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object</script"+i),e.close(),a=e.F;n--;)delete a[s][r[n]];return a()};e.exports=Object.create||function(e,r){var f;return null!==e?(o[s]=t(e),f=new o,o[s]=null,f[i]=e):f=a(),void 0===r?f:n(f,r)}}),Ct=Rt&&"object"==typeof Rt&&"default"in Rt?Rt["default"]:Rt,Lt=t(function(e){var t=Ct,n=G,r=We,i={};ue(i,Ie("iterator"),function(){return this}),e.exports=function(e,o,s){e.prototype=t(i,{next:n(1,s)}),r(e,o+" Iterator")}}),Nt=Lt&&"object"==typeof Lt&&"default"in Lt?Lt["default"]:Lt,kt=t(function(e){e.exports=ue}),Ft=kt&&"object"==typeof kt&&"default"in kt?kt["default"]:kt,Ut=t(function(e){var t=It,n=ye,r=Ft,i=ue,o=F,s=ct,a=Nt,f=We,u=xt,l=Ie("iterator"),c=!([].keys&&"next"in[].keys()),h="@@iterator",d="keys",p="values",y=function(){return this};e.exports=function(e,g,m,v,b,w,E){a(m,g,v);var _,T,S,I=function(e){if(!c&&e in O)return O[e];switch(e){case d:return function(){return new m(this,e)};case p:return function(){return new m(this,e)}}return function(){return new m(this,e)}},j=g+" Iterator",x=b==p,A=!1,O=e.prototype,P=O[l]||O[h]||b&&O[b],M=P||I(b),R=b?x?I("entries"):M:void 0,C="Array"==g?O.entries||P:P;if(C&&(S=u(C.call(new e)),S!==Object.prototype&&(f(S,j,!0),t||o(S,l)||i(S,l,y))),x&&P&&P.name!==p&&(A=!0,M=function(){return P.call(this)}),t&&!E||!c&&!A&&O[l]||i(O,l,M),s[g]=M,s[j]=y,b)if(_={values:x?M:I(p),keys:w?M:I(d),entries:R},E)for(T in _)T in O||r(O,T,_[T]);else n(n.P+n.F*(c||A),g,_);return _}}),Yt=Ut&&"object"==typeof Ut&&"default"in Ut?Ut["default"]:Ut,Bt=t(function(e){e.exports=function(e,t){return{value:t,done:!!e}}}),Vt=Bt&&"object"==typeof Bt&&"default"in Bt?Bt["default"]:Bt,Dt=(t(function(e){var t=Te,n=Vt,r=ct,i=C;e.exports=Yt(Array,"Array",function(e,t){this._t=i(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,n(1)):"keys"==t?n(0,r):"values"==t?n(0,e[r]):n(0,[r,e[r]])},"values"),r.Arguments=r.Array,t("keys"),t("values"),t("entries")}),t(function(e){for(var t=y,n=ue,r=ct,i=Ie("toStringTag"),o=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],s=0;5>s;s++){var a=o[s],f=t[a],u=f&&f.prototype;u&&!u[i]&&n(u,i,a),r[a]=r.Array}}),t(function(e){var t=E,n=x;e.exports=function(e){return function(r,i){var o,s,a=String(n(r)),f=t(i),u=a.length;return 0>f||f>=u?e?"":void 0:(o=a.charCodeAt(f),55296>o||o>56319||f+1===u||(s=a.charCodeAt(f+1))<56320||s>57343?e?a.charAt(f):o:e?a.slice(f,f+2):(o-55296<<10)+(s-56320)+65536)}}})),qt=Dt&&"object"==typeof Dt&&"default"in Dt?Dt["default"]:Dt,zt=(t(function(e){var t=qt(!0);Yt(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(e=t(n,r),this._i+=e.length,{value:e,done:!1})})}),t(function(e){e.exports=u.Promise})),Wt=zt&&"object"==typeof zt&&"default"in zt?zt["default"]:zt,$t=t(function(e){e.exports={"default":Wt,__esModule:!0}}),Zt=$t&&"object"==typeof $t&&"default"in $t?$t["default"]:$t,Jt=t(function(e,t){t.f=Object.getOwnPropertySymbols}),Gt=Jt&&"object"==typeof Jt&&"default"in Jt?Jt["default"]:Jt,Ht=t(function(e){var t=Ot,n=Gt,r=ot,i=Ce,o=M,s=Object.assign;e.exports=!s||W(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=s({},e)[n]||Object.keys(s({},t)).join("")!=r})?function(e,s){for(var a=i(e),f=arguments.length,u=1,l=n.f,c=r.f;f>u;)for(var h,d=o(arguments[u++]),p=l?t(d).concat(l(d)):t(d),y=p.length,g=0;y>g;)c.call(d,h=p[g++])&&(a[h]=d[h]);return a}:s}),Xt=Ht&&"object"==typeof Ht&&"default"in Ht?Ht["default"]:Ht,Kt=(t(function(e){var t=ye;t(t.S+t.F,"Object",{assign:Xt})}),t(function(e){e.exports=u.Object.assign})),Qt=Kt&&"object"==typeof Kt&&"default"in Kt?Kt["default"]:Kt,en=t(function(e){e.exports={"default":Qt,__esModule:!0}}),tn=en&&"object"==typeof en&&"default"in en?en["default"]:en,nn=t(function(e,t){t.__esModule=!0,t["default"]=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}}),rn=nn&&"object"==typeof nn&&"default"in nn?nn["default"]:nn,on=t(function(e,t){t.f=Ie}),sn=on&&"object"==typeof on&&"default"in on?on["default"]:on,an=t(function(e){var t=y,n=u,r=It,i=sn,o=ae.f;e.exports=function(e){var s=n.Symbol||(n.Symbol=r?{}:t.Symbol||{});"_"==e.charAt(0)||e in s||o(s,e,{value:i.f(e)})}}),fn=an&&"object"==typeof an&&"default"in an?an["default"]:an,un=(t(function(e){fn("observable")}),t(function(e){fn("asyncIterator")}),t(function(e){var t=Ot,n=Gt,r=ot;e.exports=function(e){var i=t(e),o=n.f;if(o)for(var s,a=o(e),f=r.f,u=0;a.length>u;)f.call(e,s=a[u++])&&i.push(s);return i}})),ln=un&&"object"==typeof un&&"default"in un?un["default"]:un,cn=t(function(e){var t=Ot,n=C;e.exports=function(e,r){for(var i,o=n(e),s=t(o),a=s.length,f=0;a>f;)if(o[i=s[f++]]===r)return i}}),hn=cn&&"object"==typeof cn&&"default"in cn?cn["default"]:cn,dn=t(function(e){var t=d("meta"),n=X,r=F,i=ae.f,o=0,s=Object.isExtensible||function(){return!0},a=!W(function(){return s(Object.preventExtensions({}))}),f=function(e){i(e,t,{value:{i:"O"+ ++o,w:{}}})},u=function(e,i){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,t)){if(!s(e))return"F";if(!i)return"E";f(e)}return e[t].i},l=function(e,n){if(!r(e,t)){if(!s(e))return!0;if(!n)return!1;f(e)}return e[t].w},c=function(e){return a&&h.NEED&&s(e)&&!r(e,t)&&f(e),e},h=e.exports={KEY:t,NEED:!1,fastKey:u,getWeak:l,onFreeze:c}}),pn=dn&&"object"==typeof dn&&"default"in dn?dn["default"]:dn,yn=(t(function(e){var t=y,n=F,r=Z,i=ye,o=Ft,s=pn.KEY,a=W,f=m,u=We,l=d,c=Ie,h=sn,p=fn,g=hn,v=ln,b=xe,w=oe,E=C,_=Q,T=G,S=Ct,I=q,j=at,x=ae,A=Ot,O=j.f,P=x.f,M=I.f,R=t.Symbol,L=t.JSON,N=L&&L.stringify,k="prototype",U=c("_hidden"),Y=c("toPrimitive"),B={}.propertyIsEnumerable,D=f("symbol-registry"),z=f("symbols"),$=f("op-symbols"),J=Object[k],H="function"==typeof R,X=t.QObject,K=!X||!X[k]||!X[k].findChild,ee=r&&a(function(){return 7!=S(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=O(J,t);r&&delete J[t],P(e,t,n),r&&e!==J&&P(J,t,r)}:P,te=function(e){var t=z[e]=S(R[k]);return t._k=e,t},ne=H&&"symbol"==typeof R.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof R},re=function(e,t,r){return e===J&&re($,t,r),w(e),t=_(t,!0),w(r),n(z,t)?(r.enumerable?(n(e,U)&&e[U][t]&&(e[U][t]=!1),r=S(r,{enumerable:T(0,!1)})):(n(e,U)||P(e,U,T(1,{})),e[U][t]=!0),ee(e,t,r)):P(e,t,r)},ie=function(e,t){w(e);for(var n,r=v(t=E(t)),i=0,o=r.length;o>i;)re(e,n=r[i++],t[n]);return e},se=function(e,t){return void 0===t?S(e):ie(S(e),t)},fe=function(e){var t=B.call(this,e=_(e,!0));return this===J&&n(z,e)&&!n($,e)?!1:t||!n(this,e)||!n(z,e)||n(this,U)&&this[U][e]?t:!0},le=function(e,t){if(e=E(e),t=_(t,!0),e!==J||!n(z,t)||n($,t)){var r=O(e,t);return!r||!n(z,t)||n(e,U)&&e[U][t]||(r.enumerable=!0),r}},ce=function(e){for(var t,r=M(E(e)),i=[],o=0;r.length>o;)n(z,t=r[o++])||t==U||t==s||i.push(t);return i},he=function(e){for(var t,r=e===J,i=M(r?$:E(e)),o=[],s=0;i.length>s;)n(z,t=i[s++])&&(r?n(J,t):!0)&&o.push(z[t]);return o};H||(R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var e=l(arguments.length>0?arguments[0]:void 0),t=function(r){this===J&&t.call($,r),n(this,U)&&n(this[U],e)&&(this[U][e]=!1),ee(this,e,T(1,r))};return r&&K&&ee(J,e,{configurable:!0,set:t}),te(e)},o(R[k],"toString",function(){return this._k}),j.f=le,x.f=re,V.f=I.f=ce,ot.f=fe,Gt.f=he,r&&!It&&o(J,"propertyIsEnumerable",fe,!0),h.f=function(e){return te(c(e))}),i(i.G+i.W+i.F*!H,{Symbol:R});for(var de="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),pe=0;de.length>pe;)c(de[pe++]);for(var de=A(c.store),pe=0;de.length>pe;)p(de[pe++]);i(i.S+i.F*!H,"Symbol",{"for":function(e){return n(D,e+="")?D[e]:D[e]=R(e)},keyFor:function(e){if(ne(e))return g(D,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){K=!0},useSimple:function(){K=!1}}),i(i.S+i.F*!H,"Object",{create:se,defineProperty:re,defineProperties:ie,getOwnPropertyDescriptor:le,getOwnPropertyNames:ce,getOwnPropertySymbols:he}),L&&i(i.S+i.F*(!H||a(function(){var e=R();return"[null]"!=N([e])||"{}"!=N({a:e})||"{}"!=N(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!ne(e)){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);return t=r[1],"function"==typeof t&&(n=t),(n||!b(t))&&(t=function(e,t){return n&&(t=n.call(this,e,t)),ne(t)?void 0:t}),r[1]=t,N.apply(L,r)}}}),R[k][Y]||ue(R[k],Y,R[k].valueOf),u(R,"Symbol"),u(Math,"Math",!0),u(t.JSON,"JSON",!0)}),t(function(e){e.exports=u.Symbol})),gn=yn&&"object"==typeof yn&&"default"in yn?yn["default"]:yn,mn=t(function(e){e.exports={"default":gn,__esModule:!0}}),vn=mn&&"object"==typeof mn&&"default"in mn?mn["default"]:mn,bn=t(function(e){e.exports=sn.f("iterator")}),wn=bn&&"object"==typeof bn&&"default"in bn?bn["default"]:bn,En=t(function(e){e.exports={"default":wn,__esModule:!0}}),_n=En&&"object"==typeof En&&"default"in En?En["default"]:En,Tn=t(function(e,t){function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=_n,i=n(r),o=vn,s=n(o),a="function"==typeof s["default"]&&"symbol"==typeof i["default"]?function(e){return typeof e}:function(e){return e&&"function"==typeof s["default"]&&e.constructor===s["default"]?"symbol":typeof e};t["default"]="function"==typeof s["default"]&&"symbol"===a(i["default"])?function(e){return"undefined"==typeof e?"undefined":a(e)}:function(e){return e&&"function"==typeof s["default"]&&e.constructor===s["default"]?"symbol":"undefined"==typeof e?"undefined":a(e)}}),Sn=Tn&&"object"==typeof Tn&&"default"in Tn?Tn["default"]:Tn,In=t(function(e,t){function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=Sn,i=n(r);t["default"]=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==("undefined"==typeof t?"undefined":(0,i["default"])(t))&&"function"!=typeof t?e:t}}),jn=In&&"object"==typeof In&&"default"in In?In["default"]:In,xn=(t(function(e){var t=ye;t(t.S,"Object",{create:Ct})}),t(function(e){var t=u.Object;e.exports=function(e,n){return t.create(e,n)}})),An=xn&&"object"==typeof xn&&"default"in xn?xn["default"]:xn,On=t(function(e){e.exports={"default":An,__esModule:!0}}),Pn=On&&"object"==typeof On&&"default"in On?On["default"]:On,Mn=(t(function(e){var t=ye;t(t.S,"Object",{setPrototypeOf:ut.set})}),t(function(e){e.exports=u.Object.setPrototypeOf})),Rn=Mn&&"object"==typeof Mn&&"default"in Mn?Mn["default"]:Mn,Cn=t(function(e){e.exports={"default":Rn,__esModule:!0}}),Ln=Cn&&"object"==typeof Cn&&"default"in Cn?Cn["default"]:Cn,Nn=t(function(e,t){function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=Ln,i=n(r),o=Pn,s=n(o),a=Sn,f=n(a);t["default"]=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof t?"undefined":(0,f["default"])(t)));e.prototype=(0,s["default"])(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(i["default"]?(0,i["default"])(e,t):e.__proto__=t)}}),kn=Nn&&"object"==typeof Nn&&"default"in Nn?Nn["default"]:Nn,Fn=t(function(e){var t=u,n=t.JSON||(t.JSON={stringify:JSON.stringify});e.exports=function(e){return n.stringify.apply(n,arguments)}}),Un=Fn&&"object"==typeof Fn&&"default"in Fn?Fn["default"]:Fn,Yn=t(function(e){e.exports={"default":Un,__esModule:!0}}),Bn=Yn&&"object"==typeof Yn&&"default"in Yn?Yn["default"]:Yn,Vn=t(function(e){var t=y,n=ye,r=pn,i=W,o=ue,s=Ze,a=Et,f=Tt,u=X,l=We,c=ae.f,h=Ne(0),d=Z;e.exports=function(e,p,y,g,m,v){var b=t[e],w=b,E=m?"set":"add",_=w&&w.prototype,T={};return d&&"function"==typeof w&&(v||_.forEach&&!i(function(){(new w).entries().next()}))?(w=p(function(t,n){f(t,w,e,"_c"),t._c=new b,void 0!=n&&a(n,m,t[E],t)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){
var t="add"==e||"set"==e;e in _&&(!v||"clear"!=e)&&o(w.prototype,e,function(n,r){if(f(this,w,e),!t&&v&&!u(n))return"get"==e?void 0:!1;var i=this._c[e](0===n?0:n,r);return t?this:i})}),"size"in _&&c(w.prototype,"size",{get:function(){return this._c.size}})):(w=g.getConstructor(p,e,m,E),s(w.prototype,y),r.NEED=!0),l(w,e),T[e]=w,n(n.G+n.W+n.F,T),v||g.setStrong(w,e,m),w}}),Dn=Vn&&"object"==typeof Vn&&"default"in Vn?Vn["default"]:Vn,qn=t(function(e){var t=Ze,n=pn.getWeak,r=oe,i=X,o=Tt,s=Et,a=Ne,f=F,u=a(5),l=a(6),c=0,h=function(e){return e._l||(e._l=new d)},d=function(){this.a=[]},p=function(e,t){return u(e.a,function(e){return e[0]===t})};d.prototype={get:function(e){var t=p(this,e);return t?t[1]:void 0},has:function(e){return!!p(this,e)},set:function(e,t){var n=p(this,e);n?n[1]=t:this.a.push([e,t])},"delete":function(e){var t=l(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,r,a,u){var l=e(function(e,t){o(e,l,r,"_i"),e._i=c++,e._l=void 0,void 0!=t&&s(t,a,e[u],e)});return t(l.prototype,{"delete":function(e){if(!i(e))return!1;var t=n(e);return t===!0?h(this)["delete"](e):t&&f(t,this._i)&&delete t[this._i]},has:function(e){if(!i(e))return!1;var t=n(e);return t===!0?h(this).has(e):t&&f(t,this._i)}}),l},def:function(e,t,i){var o=n(r(t),!0);return o===!0?h(e).set(t,i):o[e._i]=i,e},ufstore:h}}),zn=qn&&"object"==typeof qn&&"default"in qn?qn["default"]:qn,Wn=(t(function(e){var t,n=Ne(0),r=Ft,i=pn,o=Xt,s=zn,a=X,f=i.getWeak,u=Object.isExtensible,l=s.ufstore,c={},h=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(e){if(a(e)){var t=f(e);return t===!0?l(this).get(e):t?t[this._i]:void 0}},set:function(e,t){return s.def(this,e,t)}},p=e.exports=Dn("WeakMap",h,d,s,!0,!0);7!=(new p).set((Object.freeze||Object)(c),7).get(c)&&(t=s.getConstructor(h),o(t.prototype,d),i.NEED=!0,n(["delete","has","get","set"],function(e){var n=p.prototype,i=n[e];r(n,e,function(n,r){if(a(n)&&!u(n)){this._f||(this._f=new t);var o=this._f[e](n,r);return"set"==e?this:o}return i.call(this,n,r)})}))}),t(function(e){e.exports=u.WeakMap})),$n=Wn&&"object"==typeof Wn&&"default"in Wn?Wn["default"]:Wn,Zn=t(function(e){e.exports={"default":$n,__esModule:!0}}),Jn=Zn&&"object"==typeof Zn&&"default"in Zn?Zn["default"]:Zn,Gn=t(function(e){var t=ae,n=G;e.exports=function(e,r,i){r in e?t.f(e,r,n(0,i)):e[r]=i}}),Hn=Gn&&"object"==typeof Gn&&"default"in Gn?Gn["default"]:Gn,Xn=(t(function(e){var t=de,n=ye,r=Ce,i=bt,o=mt,s=I,a=Hn,f=yt;n(n.S+n.F*!Ve(function(e){Array.from(e)}),"Array",{from:function(e){var n,u,l,c,h=r(e),d="function"==typeof this?this:Array,p=arguments.length,y=p>1?arguments[1]:void 0,g=void 0!==y,m=0,v=f(h);if(g&&(y=t(y,p>2?arguments[2]:void 0,2)),void 0==v||d==Array&&o(v))for(n=s(h.length),u=new d(n);n>m;m++)a(u,m,g?y(h[m],m):h[m]);else for(c=v.call(h),u=new d;!(l=c.next()).done;m++)a(u,m,g?i(c,y,[l.value,m],!0):l.value);return u.length=m,u}})}),t(function(e){e.exports=u.Array.from})),Kn=Xn&&"object"==typeof Xn&&"default"in Xn?Xn["default"]:Xn,Qn=t(function(e){e.exports={"default":Kn,__esModule:!0}}),er=Qn&&"object"==typeof Qn&&"default"in Qn?Qn["default"]:Qn,tr=t(function(e,t){function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=er,i=n(r);t["default"]=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return(0,i["default"])(e)}}),nr=tr&&"object"==typeof tr&&"default"in tr?tr["default"]:tr,rr=t(function(e){var t=Et;e.exports=function(e,n){var r=[];return t(e,!1,r.push,r,n),r}}),ir=rr&&"object"==typeof rr&&"default"in rr?rr["default"]:rr,or=t(function(e){var t=dt,n=ir;e.exports=function(e){return function(){if(t(this)!=e)throw TypeError(e+"#toJSON isn't generic");return n(this)}}}),sr=or&&"object"==typeof or&&"default"in or?or["default"]:or,ar=(t(function(e){var t=ye;t(t.P+t.R,"Set",{toJSON:sr("Set")})}),t(function(e){var t=ae.f,n=Ct,r=Ze,i=de,o=Tt,s=x,a=Et,f=Yt,u=Vt,l=qe,c=Z,h=pn.fastKey,d=c?"_s":"size",p=function(e,t){var n,r=h(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,f,u,l){var h=e(function(e,t){o(e,h,f,"_i"),e._i=n(null),e._f=void 0,e._l=void 0,e[d]=0,void 0!=t&&a(t,u,e[l],e)});return r(h.prototype,{clear:function(){for(var e=this,t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[d]=0},"delete":function(e){var t=this,n=p(t,e);if(n){var r=n.n,i=n.p;delete t._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),t._f==n&&(t._f=r),t._l==n&&(t._l=i),t[d]--}return!!n},forEach:function(e){o(this,h,"forEach");for(var t,n=i(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!p(this,e)}}),c&&t(h.prototype,"size",{get:function(){return s(this[d])}}),h},def:function(e,t,n){var r,i,o=p(e,t);return o?o.v=n:(e._l=o={i:i=h(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[d]++,"F"!==i&&(e._i[i]=o)),e},getEntry:p,setStrong:function(e,t,n){f(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?u(0,n.k):"values"==t?u(0,n.v):u(0,[n.k,n.v]):(e._t=void 0,u(1))},n?"entries":"values",!n,!0),l(t)}}})),fr=ar&&"object"==typeof ar&&"default"in ar?ar["default"]:ar,ur=(t(function(e){var t=fr;e.exports=Dn("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return t.def(this,e=0===e?0:e,e)}},t)}),t(function(e){e.exports=u.Set})),lr=ur&&"object"==typeof ur&&"default"in ur?ur["default"]:ur,cr=t(function(e){e.exports={"default":lr,__esModule:!0}}),hr=cr&&"object"==typeof cr&&"default"in cr?cr["default"]:cr,dr=(t(function(e){var t=ye;t(t.S+t.F*!Z,"Object",{defineProperty:ae.f})}),t(function(e){var t=u.Object;e.exports=function(e,n,r){return t.defineProperty(e,n,r)}})),pr=dr&&"object"==typeof dr&&"default"in dr?dr["default"]:dr,yr=t(function(e){e.exports={"default":pr,__esModule:!0}}),gr=yr&&"object"==typeof yr&&"default"in yr?yr["default"]:yr,mr=t(function(e,t){function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=gr,i=n(r);t["default"]=function(e,t,n){return t in e?(0,i["default"])(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}}),vr=mr&&"object"==typeof mr&&"default"in mr?mr["default"]:mr,br=(t(function(e){var t=Ce,n=Ot;me("keys",function(){return function(e){return n(t(e))}})}),t(function(e){e.exports=u.Object.keys})),wr=br&&"object"==typeof br&&"default"in br?br["default"]:br,Er=t(function(e){e.exports={"default":wr,__esModule:!0}}),_r=Er&&"object"==typeof Er&&"default"in Er?Er["default"]:Er,Tr=t(function(e){function t(e){return!!e&&"object"==typeof e}e.exports=t}),Sr=Tr&&"object"==typeof Tr&&"default"in Tr?Tr["default"]:Tr,Ir=t(function(e){function t(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(n){}return t}e.exports=t}),jr=Ir&&"object"==typeof Ir&&"default"in Ir?Ir["default"]:Ir,xr=t(function(e){function t(e){return n(Object(e))}var n=Object.getPrototypeOf;e.exports=t}),Ar=xr&&"object"==typeof xr&&"default"in xr?xr["default"]:xr,Or=t(function(e){function t(e){if(!i(e)||l.call(e)!=o||r(e))return!1;var t=n(e);if(null===t)return!0;var s=f.call(t,"constructor")&&t.constructor;return"function"==typeof s&&s instanceof s&&a.call(s)==u}var n=Ar,r=jr,i=Sr,o="[object Object]",s=Object.prototype,a=Function.prototype.toString,f=s.hasOwnProperty,u=a.call(Object),l=s.toString;e.exports=t}),Pr=Or&&"object"==typeof Or&&"default"in Or?Or["default"]:Or,Mr=t(function(e){function t(e){if(e=""+e,!(e.length>1e4)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*u;case"days":case"day":case"d":return n*f;case"hours":case"hour":case"hrs":case"hr":case"h":return n*a;case"minutes":case"minute":case"mins":case"min":case"m":return n*s;case"seconds":case"second":case"secs":case"sec":case"s":return n*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}}function n(e){return e>=f?Math.round(e/f)+"d":e>=a?Math.round(e/a)+"h":e>=s?Math.round(e/s)+"m":e>=o?Math.round(e/o)+"s":e+"ms"}function r(e){return i(e,f,"day")||i(e,a,"hour")||i(e,s,"minute")||i(e,o,"second")||e+" ms"}function i(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var o=1e3,s=60*o,a=60*s,f=24*a,u=365.25*f;e.exports=function(e,i){return i=i||{},"string"==typeof e?t(e):i["long"]?r(e):n(e)}}),Rr=Mr&&"object"==typeof Mr&&"default"in Mr?Mr["default"]:Mr,Cr=t(function(e,t){function n(){return t.colors[u++%t.colors.length]}function r(e){function r(){}function i(){var e=i,r=+new Date,o=r-(f||r);e.diff=o,e.prev=f,e.curr=r,f=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=n());var s=Array.prototype.slice.call(arguments);s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(n,r){if("%%"===n)return n;a++;var i=t.formatters[r];if("function"==typeof i){var o=s[a];n=i.call(e,o),s.splice(a,1),a--}return n}),"function"==typeof t.formatArgs&&(s=t.formatArgs.apply(e,s));var u=i.log||t.log||console.log.bind(console);u.apply(e,s)}r.enabled=!1,i.enabled=!0;var o=t.enabled(e)?i:r;return o.namespace=e,o}function i(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;r>i;i++)n[i]&&(e=n[i].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function o(){t.enable("")}function s(e){var n,r;for(n=0,r=t.skips.length;r>n;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;r>n;n++)if(t.names[n].test(e))return!0;return!1}function a(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=r,t.coerce=a,t.disable=o,t.enable=i,t.enabled=s,t.humanize=Rr,t.names=[],t.skips=[],t.formatters={};var f,u=0}),Lr=Cr&&"object"==typeof Cr&&"default"in Cr?Cr["default"]:Cr,Nr=t(function(e,t){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))}),e.splice(o,0,r),e}function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function o(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(n){}}function s(){var e;try{e=t.storage.debug}catch(n){}return e}function a(){try{return window.localStorage}catch(e){}}t=e.exports=Lr,t.log=i,t.formatArgs=r,t.save=o,t.load=s,t.useColors=n,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:a(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(s())}),kr=Nr&&"object"==typeof Nr&&"default"in Nr?Nr["default"]:Nr,Fr=function da(e){var t=new Zt(e[0]);return 1===e.length?t:t["catch"](function(){return da(e.slice(1))})},Ur=function(e){return function(t){return e(t),t}},Yr=kr("LC:Cache"),Br=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"anonymous":arguments[0];rn(this,e),this.name=t,this._map={}}return e.prototype.get=function(e){var t=this._map[e];if(t){var n=t.expiredAt&&t.expiredAt<Date.now();if(!n)return Yr("["+this.name+"] hit: "+e+" "+t.value),t.value;Yr("["+this.name+"] expired: "+e),delete this._map[e]}return Yr("["+this.name+"] missed: "+e),null},e.prototype.set=function(e,t,n){Yr("["+this.name+"] set: "+e+" "+t+" "+n);var r=this._map[e]={value:t};"number"==typeof n&&(r.expiredAt=Date.now()+n)},e}(),Vr=function(e){return e?"string"==typeof e?new Date(e):"Date"===e.__type&&e.iso?new Date(e.iso):e:e},Dr=function(e,t){return _r(t).reduce(function(n,r){var i=e[r]||r;return tn(n,vr({},i,t[r]))},{})},qr=function(e,t){return er(new hr([].concat(nr(e),nr(t))))},zr=function(e,t){return er(function(t){return new hr(e.filter(function(e){return!t.has(e)}))}(new hr(t)))},Wr=new Jn,$r=function(e){return Wr.has(e)||Wr.set(e,{}),Wr.get(e)},Zr=function pa(e){if(!Pr(e))return e;var t=tn({},e);for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];null===r?delete t[n]:t[n]=pa(r)}return t},Jr=function(e){return Zr(JSON.parse(Bn(e)))},Gr=t(function(e){function t(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function n(){}var r=Object.prototype.hasOwnProperty,i="function"!=typeof Object.create?"~":!1;n.prototype._events=void 0,n.prototype.eventNames=function(){var e,t=this._events,n=[];if(!t)return n;for(e in t)r.call(t,e)&&n.push(i?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},n.prototype.listeners=function(e,t){var n=i?i+e:e,r=this._events&&this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var o=0,s=r.length,a=new Array(s);s>o;o++)a[o]=r[o].fn;return a},n.prototype.emit=function(e,t,n,r,o,s){var a=i?i+e:e;if(!this._events||!this._events[a])return!1;var f,u,l=this._events[a],c=arguments.length;if("function"==typeof l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,s),!0}for(u=1,f=new Array(c-1);c>u;u++)f[u-1]=arguments[u];l.fn.apply(l.context,f)}else{var h,d=l.length;for(u=0;d>u;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,n);break;default:if(!f)for(h=1,f=new Array(c-1);c>h;h++)f[h-1]=arguments[h];l[u].fn.apply(l[u].context,f)}}return!0},n.prototype.on=function(e,n,r){var o=new t(n,r||this),s=i?i+e:e;return this._events||(this._events=i?{}:Object.create(null)),this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],o]:this._events[s].push(o):this._events[s]=o,this},n.prototype.once=function(e,n,r){var o=new t(n,r||this,!0),s=i?i+e:e;return this._events||(this._events=i?{}:Object.create(null)),this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],o]:this._events[s].push(o):this._events[s]=o,this},n.prototype.removeListener=function(e,t,n,r){var o=i?i+e:e;if(!this._events||!this._events[o])return this;var s=this._events[o],a=[];if(t)if(s.fn)(s.fn!==t||r&&!s.once||n&&s.context!==n)&&a.push(s);else for(var f=0,u=s.length;u>f;f++)(s[f].fn!==t||r&&!s[f].once||n&&s[f].context!==n)&&a.push(s[f]);return a.length?this._events[o]=1===a.length?a[0]:a:delete this._events[o],this},n.prototype.removeAllListeners=function(e){return this._events?(e?delete this._events[i?i+e:e]:this._events=i?{}:Object.create(null),this):this},n.prototype.off=n.prototype.removeListener,n.prototype.addListener=n.prototype.on,n.prototype.setMaxListeners=function(){return this},n.prefixed=i,"undefined"!=typeof e&&(e.exports=n)}),Hr=Gr&&"object"==typeof Gr&&"default"in Gr?Gr["default"]:Gr,Xr=t(function(e,t){!function(){var n={VERSION:"2.3.5",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(e,t){var r="string"==typeof e.initial?{state:e.initial}:e.initial,i=e.terminal||e["final"],o=t||e.target||{},s=e.events||[],a=e.callbacks||{},f={},u={},l=function(e){var t=e.from instanceof Array?e.from:e.from?[e.from]:[n.WILDCARD];f[e.name]=f[e.name]||{};for(var r=0;r<t.length;r++)u[t[r]]=u[t[r]]||[],u[t[r]].push(e.name),f[e.name][t[r]]=e.to||t[r]};r&&(r.event=r.event||"startup",l({name:r.event,from:"none",to:r.state}));for(var c=0;c<s.length;c++)l(s[c]);for(var h in f)f.hasOwnProperty(h)&&(o[h]=n.buildEvent(h,f[h]));for(var h in a)a.hasOwnProperty(h)&&(o[h]=a[h]);return o.current="none",o.is=function(e){return e instanceof Array?e.indexOf(this.current)>=0:this.current===e},o.can=function(e){return!this.transition&&(f[e].hasOwnProperty(this.current)||f[e].hasOwnProperty(n.WILDCARD))},o.cannot=function(e){return!this.can(e)},o.transitions=function(){return u[this.current]},o.isFinished=function(){return this.is(i)},o.error=e.error||function(e,t,n,r,i,o,s){throw s||o},r&&!r.defer&&o[r.event](),o},doCallback:function(e,t,r,i,o,s){if(t)try{return t.apply(e,[r,i,o].concat(s))}catch(a){return e.error(r,i,o,s,n.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",a)}},beforeAnyEvent:function(e,t,r,i,o){return n.doCallback(e,e.onbeforeevent,t,r,i,o)},afterAnyEvent:function(e,t,r,i,o){return n.doCallback(e,e.onafterevent||e.onevent,t,r,i,o)},leaveAnyState:function(e,t,r,i,o){return n.doCallback(e,e.onleavestate,t,r,i,o)},enterAnyState:function(e,t,r,i,o){return n.doCallback(e,e.onenterstate||e.onstate,t,r,i,o)},changeState:function(e,t,r,i,o){return n.doCallback(e,e.onchangestate,t,r,i,o)},beforeThisEvent:function(e,t,r,i,o){return n.doCallback(e,e["onbefore"+t],t,r,i,o)},afterThisEvent:function(e,t,r,i,o){return n.doCallback(e,e["onafter"+t]||e["on"+t],t,r,i,o)},leaveThisState:function(e,t,r,i,o){return n.doCallback(e,e["onleave"+r],t,r,i,o)},enterThisState:function(e,t,r,i,o){return n.doCallback(e,e["onenter"+i]||e["on"+i],t,r,i,o)},beforeEvent:function(e,t,r,i,o){return!1===n.beforeThisEvent(e,t,r,i,o)||!1===n.beforeAnyEvent(e,t,r,i,o)?!1:void 0},afterEvent:function(e,t,r,i,o){n.afterThisEvent(e,t,r,i,o),n.afterAnyEvent(e,t,r,i,o)},leaveState:function(e,t,r,i,o){var s=n.leaveThisState(e,t,r,i,o),a=n.leaveAnyState(e,t,r,i,o);return!1===s||!1===a?!1:n.ASYNC===s||n.ASYNC===a?n.ASYNC:void 0},enterState:function(e,t,r,i,o){n.enterThisState(e,t,r,i,o),n.enterAnyState(e,t,r,i,o)},buildEvent:function(e,t){return function(){var r=this.current,i=t[r]||t[n.WILDCARD]||r,o=Array.prototype.slice.call(arguments);if(this.transition)return this.error(e,r,i,o,n.Error.PENDING_TRANSITION,"event "+e+" inappropriate because previous transition did not complete");if(this.cannot(e))return this.error(e,r,i,o,n.Error.INVALID_TRANSITION,"event "+e+" inappropriate in current state "+this.current);if(!1===n.beforeEvent(this,e,r,i,o))return n.Result.CANCELLED;if(r===i)return n.afterEvent(this,e,r,i,o),n.Result.NOTRANSITION;var s=this;this.transition=function(){return s.transition=null,s.current=i,n.enterState(s,e,r,i,o),n.changeState(s,e,r,i,o),n.afterEvent(s,e,r,i,o),n.Result.SUCCEEDED},this.transition.cancel=function(){s.transition=null,n.afterEvent(s,e,r,i,o)};var a=n.leaveState(this,e,r,i,o);return!1===a?(this.transition=null,n.Result.CANCELLED):n.ASYNC===a?n.Result.PENDING:this.transition?this.transition():void 0}}};"undefined"!=typeof t?("undefined"!=typeof e&&e.exports&&(t=e.exports=n),t.StateMachine=n):"function"==typeof i&&i.amd?i(function(e){return n}):"undefined"!=typeof window?window.StateMachine=n:"undefined"!=typeof self&&(self.StateMachine=n)}()}),Kr=Xr&&"object"==typeof Xr&&"default"in Xr?Xr["default"]:Xr,Qr=WebSocket=r.WebSocket||r.MozWebSocket,ei=kr("LC:WebSocketPlus"),ti=6e4,ni=18e4,ri=function(e){return Math.min(1e3<<e,3e5)},ii=function(e){function t(n,r){if(rn(this,t),ei("initializing WebSocketPlus"),"undefined"==typeof Qr)throw new Error("WebSocket is undefined. Polyfill is required in this runtime.");var i=jn(this,e.call(this));return"function"!=typeof n?i._getUrls=function(){return Zt.resolve(n)}:i._getUrls=n,i._protocol=r,i.init(),i._createWs(i._getUrls,i._protocol).then(function(){return i.open()},function(e){return i["throw"](e)})["catch"](i["throw"].bind(i)),i.__postponeTimers=i._postponeTimers.bind(i),i}return kn(t,e),t.prototype._createWs=function(e,t){var n=this;return e().then(function(e){var r=e;return r instanceof Array||(r=[r]),Fr(r.map(function(e){return function(r,i){ei("connect ["+e+"] "+t);var o=t?new Qr(e,t):new Qr(e);o.binaryType=n.binaryType||"arraybuffer",o.onopen=function(){return r(o)},o.onerror=function(t){return i(t instanceof Error?t:new Error("Failed to connect ["+e+"]"))}}})).then(function(e){return n._ws=e,n._ws.onclose=n._handleClose.bind(n),n._ws.onmessage=n._handleMessage.bind(n),e})})},t.prototype._destroyWs=function(){var e=this._ws;e&&(e.onopen=e.onclose=e.onerror=e.onmessage=null,this._ws=null,e.close())},t.prototype.onopen=function(){ei("open"),this.emit("open")},t.prototype.onconnected=function(){this._startConnectionKeeper()},t.prototype.onleaveconnected=function(){this._stopConnectionKeeper()},t.prototype.onbeforedisconnect=function(){ei("disconnect"),this.emit("disconnect")},t.prototype.ondisconnect=function(){this._destroyWs()},t.prototype.onreconnect=function(){ei("reconnect"),this.emit("reconnect")},t.prototype.onoffline=function(e,t,n){var r=this,i=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=ri.call(null,i);ei("schedule attempt="+i+" delay="+o),this.emit("schedule",i,o),this.__scheduledRetry&&clearTimeout(this.__scheduledRetry),this.__scheduledRetry=setTimeout(function(){r.is("offline")&&r.retry(i)},o)},t.prototype.onretry=function(e,t,n){var r=this,i=arguments.length<=3||void 0===arguments[3]?0:arguments[3];ei("retry attempt="+i),this.emit("retry",i),this._createWs(this._getUrls,this._protocol).then(function(){return r.reconnect()},function(){return r.fail(i+1)})},t.prototype.onclose=function(){ei("close"),this._ws.close()},t.prototype.onerror=function(e,t,n,r){ei("error",r),this.emit("error",r)},t.prototype.ping=function(){this._ws.ping?this._ws.ping():console.warn("The WebSocket implement does not support sending ping frame.\n        Override ping method to use application defined ping/pong mechanism.")},t.prototype._postponeTimers=function(){var e=this;ei("_postponeTimers"),this._clearTimers(),this._heartbeatTimer=setInterval(function(){ei("ping"),e.ping()},ti),this._timeoutTimer=setTimeout(function(){ei("timeout"),e.disconnect()},ni)},t.prototype._clearTimers=function(){this._heartbeatTimer&&clearInterval(this._heartbeatTimer),this._timeoutTimer&&clearTimeout(this._timeoutTimer)},t.prototype._startConnectionKeeper=function(){ei("start connection keeper");var e=this._ws.addListener||this._ws.addEventListener;e.call(this._ws,"message",this.__postponeTimers),this._postponeTimers()},t.prototype._stopConnectionKeeper=function(){ei("stop connection keeper");var e=this._ws.removeListener||this._ws.removeEventListener;e.call(this._ws,"message",this.__postponeTimers),this._clearTimers()},t.prototype._handleClose=function(e){ei("ws closed ["+e.code+"] "+e.reason),this.isFinished()||this.handleClose(e)},t.prototype.handleClose=function(){this.disconnect()},t.prototype.send=function(e){ei("send",e),this._ws.send(e)},t.prototype._handleMessage=function(e){ei("message",e.data),this.handleMessage(e.data)},t.prototype.handleMessage=function(e){this.emit("message",e)},t}(Hr);Kr.create({target:ii.prototype,initial:{state:"initialized",event:"init",defer:!0},terminal:"closed",events:[{name:"open",from:"initialized",to:"connected"},{name:"disconnect",from:"connected",to:"offline"},{name:"retry",from:"offline",to:"reconnecting"},{name:"fail",from:"reconnecting",to:"offline"},{name:"reconnect",from:"reconnecting",to:"connected"},{name:"close",from:["connected","offline","reconnecting"],to:"closed"},{name:"throw",from:"*",to:"error"}]});var oi={code:4100,message:"App not exists or realtime message service is disabled."},si={code:4103,message:"Malformed clientId."},ai={code:4110,message:"Access denied by domain whitelist."},fi={code:4111},ui=function(e){var t=e.code,n=e.reason,r=e.appCode,i=e.detail,o=new Error(n||i);return tn(o,{code:t,appCode:r,detail:i})},li={},ci=t(function(e,t,n){!function(t,n){"function"==typeof i&&i.amd?i([],n):"function"==typeof o&&"object"==typeof e&&e&&e.exports?e.exports=n():(t.dcodeIO=t.dcodeIO||{}).Long=n()}(s,function(){function e(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function t(e){return(e&&e.__isLong__)===!0}function n(e,t){var n,r,o;return t?(e>>>=0,(o=e>=0&&256>e)&&(r=f[e])?r:(n=i(e,0>(0|e)?-1:0,!0),o&&(f[e]=n),n)):(e|=0,(o=e>=-128&&128>e)&&(r=a[e])?r:(n=i(e,0>e?-1:0,!1),o&&(a[e]=n),n))}function r(e,t){if(isNaN(e)||!isFinite(e))return t?m:g;if(t){if(0>e)return m;if(e>=d)return _}else{if(-p>=e)return T;if(e+1>=p)return E}return 0>e?r(-e,t).neg():i(e%h|0,e/h|0,t)}function i(t,n,r){return new e(t,n,r)}function o(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"==typeof t?(n=t,t=!1):t=!!t,n=n||10,2>n||n>36)throw RangeError("radix");var i;if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return o(e.substring(1),t,n).neg();for(var s=r(u(n,8)),a=g,f=0;f<e.length;f+=8){var l=Math.min(8,e.length-f),c=parseInt(e.substring(f,f+l),n);if(8>l){var h=r(u(n,l));a=a.mul(h).add(r(c))}else a=a.mul(s),a=a.add(r(c))}return a.unsigned=t,a}function s(t){return t instanceof e?t:"number"==typeof t?r(t):"string"==typeof t?o(t):i(t.low,t.high,t.unsigned)}e.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),e.isLong=t;var a={},f={};e.fromInt=n,e.fromNumber=r,e.fromBits=i;var u=Math.pow;e.fromString=o,e.fromValue=s;var l=65536,c=1<<24,h=l*l,d=h*h,p=d/2,y=n(c),g=n(0);e.ZERO=g;var m=n(0,!0);e.UZERO=m;var v=n(1);e.ONE=v;var b=n(1,!0);e.UONE=b;var w=n(-1);e.NEG_ONE=w;var E=i(-1,2147483647,!1);e.MAX_VALUE=E;var _=i(-1,-1,!0);e.MAX_UNSIGNED_VALUE=_;var T=i(0,-2147483648,!1);e.MIN_VALUE=T;var S=e.prototype;return S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},S.toString=function(e){if(e=e||10,2>e||e>36)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var t=r(e),n=this.div(t),i=n.mul(t).sub(this);return n.toString(e)+i.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=r(u(e,6),this.unsigned),s=this,a="";;){var f=s.div(o),l=s.sub(f.mul(o)).toInt()>>>0,c=l.toString(e);if(s=f,s.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},S.isZero=function(){return 0===this.high&&0===this.low},S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1===(1&this.low)},S.isEven=function(){return 0===(1&this.low)},S.equals=function(e){return t(e)||(e=s(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low},S.eq=S.equals,S.notEquals=function(e){return!this.eq(e)},S.neq=S.notEquals,S.lessThan=function(e){return this.comp(e)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(e){return this.comp(e)<=0},S.lte=S.lessThanOrEqual,S.greaterThan=function(e){return this.comp(e)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(e){return this.comp(e)>=0},S.gte=S.greaterThanOrEqual,S.compare=function(e){if(t(e)||(e=s(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(v)},S.neg=S.negate,S.add=function(e){t(e)||(e=s(e));var n=this.high>>>16,r=65535&this.high,o=this.low>>>16,a=65535&this.low,f=e.high>>>16,u=65535&e.high,l=e.low>>>16,c=65535&e.low,h=0,d=0,p=0,y=0;return y+=a+c,p+=y>>>16,y&=65535,p+=o+l,d+=p>>>16,p&=65535,d+=r+u,h+=d>>>16,d&=65535,h+=n+f,h&=65535,i(p<<16|y,h<<16|d,this.unsigned)},S.subtract=function(e){return t(e)||(e=s(e)),this.add(e.neg())},S.sub=S.subtract,S.multiply=function(e){if(this.isZero())return g;if(t(e)||(e=s(e)),e.isZero())return g;if(this.eq(T))return e.isOdd()?T:g;if(e.eq(T))return this.isOdd()?T:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(y)&&e.lt(y))return r(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,a=this.low>>>16,f=65535&this.low,u=e.high>>>16,l=65535&e.high,c=e.low>>>16,h=65535&e.low,d=0,p=0,m=0,v=0;return v+=f*h,m+=v>>>16,v&=65535,m+=a*h,p+=m>>>16,m&=65535,m+=f*c,p+=m>>>16,m&=65535,p+=o*h,d+=p>>>16,p&=65535,p+=a*c,d+=p>>>16,p&=65535,p+=f*l,d+=p>>>16,p&=65535,d+=n*h+o*c+a*l+f*u,d&=65535,i(m<<16|v,d<<16|p,this.unsigned)},S.mul=S.multiply,S.divide=function(e){if(t(e)||(e=s(e)),e.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?m:g;var n,i,o;if(this.unsigned)e.unsigned||(e=e.toUnsigned());else{if(this.eq(T)){if(e.eq(v)||e.eq(w))return T;if(e.eq(T))return v;var a=this.shr(1);return n=a.div(e).shl(1),n.eq(g)?e.isNegative()?v:w:(i=this.sub(e.mul(n)),o=n.add(i.div(e)))}if(e.eq(T))return this.unsigned?m:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg()}if(this.unsigned){if(e.gt(this))return m;if(e.gt(this.shru(1)))return b;o=m}else o=g;for(i=this;i.gte(e);){n=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var f=Math.ceil(Math.log(n)/Math.LN2),l=48>=f?1:u(2,f-48),c=r(n),h=c.mul(e);h.isNegative()||h.gt(i);)n-=l,c=r(n,this.unsigned),h=c.mul(e);c.isZero()&&(c=v),o=o.add(c),i=i.sub(h)}return o},S.div=S.divide,S.modulo=function(e){return t(e)||(e=s(e)),this.sub(this.div(e).mul(e))},S.mod=S.modulo,S.not=function(){return i(~this.low,~this.high,this.unsigned)},S.and=function(e){return t(e)||(e=s(e)),i(this.low&e.low,this.high&e.high,this.unsigned)},S.or=function(e){return t(e)||(e=s(e)),i(this.low|e.low,this.high|e.high,this.unsigned)},S.xor=function(e){return t(e)||(e=s(e)),i(this.low^e.low,this.high^e.high,this.unsigned)},S.shiftLeft=function(e){return t(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?i(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):i(0,this.low<<e-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(e){return t(e)&&(e=e.toInt()),0===(e&=63)?this:32>e?i(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):i(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(e){if(t(e)&&(e=e.toInt()),e&=63,0===e)return this;var n=this.high;if(32>e){var r=this.low;return i(r>>>e|n<<32-e,n>>>e,this.unsigned)}return 32===e?i(n,0,this.unsigned):i(n>>>e-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?i(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:i(this.low,this.high,!0)},e})}),hi=ci&&"object"==typeof ci&&"default"in ci?ci["default"]:ci,di=t(function(e,t,n){!function(t,n){"function"==typeof i&&i.amd?i(["long"],n):"function"==typeof o&&"object"==typeof e&&e&&e.exports?e.exports=function(){var e;try{e=hi}catch(t){}return n(e)}():(t.dcodeIO=t.dcodeIO||{}).ByteBuffer=n(t.dcodeIO.Long)}(s,function(e){function t(e){var t=0;return function(){return t<e.length?e.charCodeAt(t++):null}}function n(){var e=[],t=[];return function(){return 0===arguments.length?t.join("")+f.apply(String,e):(e.length+arguments.length>1024&&(t.push(f.apply(String,e)),e.length=0),void Array.prototype.push.apply(e,arguments))}}function r(e,t,n,r,i){var o,s,a=8*i-r-1,f=(1<<a)-1,u=f>>1,l=-7,c=n?i-1:0,h=n?-1:1,d=e[t+c];for(c+=h,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+e[t+c],
c+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+c],c+=h,l-=8);if(0===o)o=1-u;else{if(o===f)return s?NaN:(d?-1:1)*(1/0);s+=Math.pow(2,r),o-=u}return(d?-1:1)*s*Math.pow(2,o-r)}function i(e,t,n,r,i,o){var s,a,f,u=8*o-i-1,l=(1<<u)-1,c=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,y=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-s))<1&&(s--,f*=2),t+=s+c>=1?h/f:h*Math.pow(2,1-c),t*f>=2&&(s++,f/=2),s+c>=l?(a=0,s=l):s+c>=1?(a=(t*f-1)*Math.pow(2,i),s+=c):(a=t*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+d]=255&s,d+=p,s/=256,u-=8);e[n+d-p]|=128*y}var o=function(e,t,n){if("undefined"==typeof e&&(e=o.DEFAULT_CAPACITY),"undefined"==typeof t&&(t=o.DEFAULT_ENDIAN),"undefined"==typeof n&&(n=o.DEFAULT_NOASSERT),!n){if(e=0|e,0>e)throw RangeError("Illegal capacity");t=!!t,n=!!n}this.buffer=0===e?a:new ArrayBuffer(e),this.view=0===e?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=e,this.littleEndian=t,this.noAssert=n};o.VERSION="5.0.1",o.LITTLE_ENDIAN=!0,o.BIG_ENDIAN=!1,o.DEFAULT_CAPACITY=16,o.DEFAULT_ENDIAN=o.BIG_ENDIAN,o.DEFAULT_NOASSERT=!1,o.Long=e||null;var s=o.prototype;s.__isByteBuffer__,Object.defineProperty(s,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var a=new ArrayBuffer(0),f=String.fromCharCode;o.accessor=function(){return Uint8Array},o.allocate=function(e,t,n){return new o(e,t,n)},o.concat=function(e,t,n,r){("boolean"==typeof t||"string"!=typeof t)&&(r=n,n=t,t=void 0);for(var i,s=0,a=0,f=e.length;f>a;++a)o.isByteBuffer(e[a])||(e[a]=o.wrap(e[a],t)),i=e[a].limit-e[a].offset,i>0&&(s+=i);if(0===s)return new o(0,n,r);var u,l=new o(s,n,r);for(a=0;f>a;)u=e[a++],i=u.limit-u.offset,0>=i||(l.view.set(u.view.subarray(u.offset,u.limit),l.offset),l.offset+=i);return l.limit=l.offset,l.offset=0,l},o.isByteBuffer=function(e){return(e&&e.__isByteBuffer__)===!0},o.type=function(){return ArrayBuffer},o.wrap=function(e,t,n,r){if("string"!=typeof t&&(r=n,n=t,t=void 0),"string"==typeof e)switch("undefined"==typeof t&&(t="utf8"),t){case"base64":return o.fromBase64(e,n);case"hex":return o.fromHex(e,n);case"binary":return o.fromBinary(e,n);case"utf8":return o.fromUTF8(e,n);case"debug":return o.fromDebug(e,n);default:throw Error("Unsupported encoding: "+t)}if(null===e||"object"!=typeof e)throw TypeError("Illegal buffer");var i;if(o.isByteBuffer(e))return i=s.clone.call(e),i.markedOffset=-1,i;if(e instanceof Uint8Array)i=new o(0,n,r),e.length>0&&(i.buffer=e.buffer,i.offset=e.byteOffset,i.limit=e.byteOffset+e.byteLength,i.view=new Uint8Array(e.buffer));else if(e instanceof ArrayBuffer)i=new o(0,n,r),e.byteLength>0&&(i.buffer=e,i.offset=0,i.limit=e.byteLength,i.view=e.byteLength>0?new Uint8Array(e):null);else{if("[object Array]"!==Object.prototype.toString.call(e))throw TypeError("Illegal buffer");i=new o(e.length,n,r),i.limit=e.length;for(var a=0;a<e.length;++a)i.view[a]=e[a]}return i},s.writeBitSet=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if(!(e instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=t,o=e.length,s=o>>3,a=0;for(t+=this.writeVarint32(o,t);s--;)r=1&!!e[a++]|(1&!!e[a++])<<1|(1&!!e[a++])<<2|(1&!!e[a++])<<3|(1&!!e[a++])<<4|(1&!!e[a++])<<5|(1&!!e[a++])<<6|(1&!!e[a++])<<7,this.writeByte(r,t++);if(o>a){var f=0;for(r=0;o>a;)r|=(1&!!e[a++])<<f++;this.writeByte(r,t++)}return n?(this.offset=t,this):t-i},s.readBitSet=function(e){var t="undefined"==typeof e;t&&(e=this.offset);var n,r=this.readVarint32(e),i=r.value,o=i>>3,s=0,a=[];for(e+=r.length;o--;)n=this.readByte(e++),a[s++]=!!(1&n),a[s++]=!!(2&n),a[s++]=!!(4&n),a[s++]=!!(8&n),a[s++]=!!(16&n),a[s++]=!!(32&n),a[s++]=!!(64&n),a[s++]=!!(128&n);if(i>s){var f=0;for(n=this.readByte(e++);i>s;)a[s++]=!!(n>>f++&1)}return t&&(this.offset=e),a},s.readBytes=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+"+e+") <= "+this.buffer.byteLength)}var r=this.slice(t,t+e);return n&&(this.offset+=e),r},s.writeBytes=s.append,s.writeInt8=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view[t]=e,n&&(this.offset+=1),this},s.writeByte=s.writeInt8,s.readInt8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view[e];return 128===(128&n)&&(n=-(255-n+1)),t&&(this.offset+=1),n},s.readByte=s.readInt8,s.writeUint8=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=1;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=1,this.view[t]=e,n&&(this.offset+=1),this},s.writeUInt8=s.writeUint8,s.readUint8=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=this.view[e];return t&&(this.offset+=1),n},s.readUInt8=s.readUint8,s.writeInt16=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},s.writeShort=s.writeInt16,s.readInt16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),32768===(32768&n)&&(n=-(65535-n+1)),t&&(this.offset+=2),n},s.readShort=s.readInt16,s.writeUint16=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=2;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=2,this.littleEndian?(this.view[t+1]=(65280&e)>>>8,this.view[t]=255&e):(this.view[t]=(65280&e)>>>8,this.view[t+1]=255&e),n&&(this.offset+=2),this},s.writeUInt16=s.writeUint16,s.readUint16=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+2) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e],n|=this.view[e+1]<<8):(n=this.view[e]<<8,n|=this.view[e+1]),t&&(this.offset+=2),n},s.readUInt16=s.readUint16,s.writeInt32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},s.writeInt=s.writeInt32,s.readInt32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),n|=0,t&&(this.offset+=4),n},s.readInt=s.readInt32,s.writeUint32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,this.littleEndian?(this.view[t+3]=e>>>24&255,this.view[t+2]=e>>>16&255,this.view[t+1]=e>>>8&255,this.view[t]=255&e):(this.view[t]=e>>>24&255,this.view[t+1]=e>>>16&255,this.view[t+2]=e>>>8&255,this.view[t+3]=255&e),n&&(this.offset+=4),this},s.writeUInt32=s.writeUint32,s.readUint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=0;return this.littleEndian?(n=this.view[e+2]<<16,n|=this.view[e+1]<<8,n|=this.view[e],n+=this.view[e+3]<<24>>>0):(n=this.view[e+1]<<16,n|=this.view[e+2]<<8,n|=this.view[e+3],n+=this.view[e]<<24>>>0),t&&(this.offset+=4),n},s.readUInt32=s.readUint32,e&&(s.writeInt64=function(t,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),n+=8;var i=this.buffer.byteLength;n>i&&this.resize((i*=2)>n?i:n),n-=8;var o=t.low,s=t.high;return this.littleEndian?(this.view[n+3]=o>>>24&255,this.view[n+2]=o>>>16&255,this.view[n+1]=o>>>8&255,this.view[n]=255&o,n+=4,this.view[n+3]=s>>>24&255,this.view[n+2]=s>>>16&255,this.view[n+1]=s>>>8&255,this.view[n]=255&s):(this.view[n]=s>>>24&255,this.view[n+1]=s>>>16&255,this.view[n+2]=s>>>8&255,this.view[n+3]=255&s,n+=4,this.view[n]=o>>>24&255,this.view[n+1]=o>>>16&255,this.view[n+2]=o>>>8&255,this.view[n+3]=255&o),r&&(this.offset+=8),this},s.writeLong=s.writeInt64,s.readInt64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=0,i=0;this.littleEndian?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0,t+=4,i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0,t+=4,r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var o=new e(r,i,!1);return n&&(this.offset+=8),o},s.readLong=s.readInt64,s.writeUint64=function(t,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t)),n+=8;var i=this.buffer.byteLength;n>i&&this.resize((i*=2)>n?i:n),n-=8;var o=t.low,s=t.high;return this.littleEndian?(this.view[n+3]=o>>>24&255,this.view[n+2]=o>>>16&255,this.view[n+1]=o>>>8&255,this.view[n]=255&o,n+=4,this.view[n+3]=s>>>24&255,this.view[n+2]=s>>>16&255,this.view[n+1]=s>>>8&255,this.view[n]=255&s):(this.view[n]=s>>>24&255,this.view[n+1]=s>>>16&255,this.view[n+2]=s>>>8&255,this.view[n+3]=255&s,n+=4,this.view[n]=o>>>24&255,this.view[n+1]=o>>>16&255,this.view[n+2]=o>>>8&255,this.view[n+3]=255&o),r&&(this.offset+=8),this},s.writeUInt64=s.writeUint64,s.readUint64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+8) <= "+this.buffer.byteLength)}var r=0,i=0;this.littleEndian?(r=this.view[t+2]<<16,r|=this.view[t+1]<<8,r|=this.view[t],r+=this.view[t+3]<<24>>>0,t+=4,i=this.view[t+2]<<16,i|=this.view[t+1]<<8,i|=this.view[t],i+=this.view[t+3]<<24>>>0):(i=this.view[t+1]<<16,i|=this.view[t+2]<<8,i|=this.view[t+3],i+=this.view[t]<<24>>>0,t+=4,r=this.view[t+1]<<16,r|=this.view[t+2]<<8,r|=this.view[t+3],r+=this.view[t]<<24>>>0);var o=new e(r,i,!0);return n&&(this.offset+=8),o},s.readUInt64=s.readUint64),s.writeFloat32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=4;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=4,i(this.view,e,t,this.littleEndian,23,4),n&&(this.offset+=4),this},s.writeFloat=s.writeFloat32,s.readFloat32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=r(this.view,e,this.littleEndian,23,4);return t&&(this.offset+=4),n},s.readFloat=s.readFloat32,s.writeFloat64=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e)throw TypeError("Illegal value: "+e+" (not a number)");if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}t+=8;var r=this.buffer.byteLength;return t>r&&this.resize((r*=2)>t?r:t),t-=8,i(this.view,e,t,this.littleEndian,52,8),n&&(this.offset+=8),this},s.writeDouble=s.writeFloat64,s.readFloat64=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+8) <= "+this.buffer.byteLength)}var n=r(this.view,e,this.littleEndian,52,8);return t&&(this.offset+=8),n},s.readDouble=s.readFloat64,o.MAX_VARINT32_BYTES=5,o.calculateVarint32=function(e){return e>>>=0,128>e?1:16384>e?2:1<<21>e?3:1<<28>e?4:5},o.zigZagEncode32=function(e){return((e|=0)<<1^e>>31)>>>0},o.zigZagDecode32=function(e){return e>>>1^-(1&e)|0},s.writeVarint32=function(e,t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+0) <= "+this.buffer.byteLength)}var r,i=o.calculateVarint32(e);t+=i;var s=this.buffer.byteLength;for(t>s&&this.resize((s*=2)>t?s:t),t-=i,e>>>=0;e>=128;)r=127&e|128,this.view[t++]=r,e>>>=7;return this.view[t++]=e,n?(this.offset=t,this):i},s.writeVarint32ZigZag=function(e,t){return this.writeVarint32(o.zigZagEncode32(e),t)},s.readVarint32=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n,r=0,i=0;do{if(!this.noAssert&&e>this.limit){var o=Error("Truncated");throw o.truncated=!0,o}n=this.view[e++],5>r&&(i|=(127&n)<<7*r),++r}while(0!==(128&n));return i|=0,t?(this.offset=e,i):{value:i,length:r}},s.readVarint32ZigZag=function(e){var t=this.readVarint32(e);return"object"==typeof t?t.value=o.zigZagDecode32(t.value):t=o.zigZagDecode32(t),t},e&&(o.MAX_VARINT64_BYTES=10,o.calculateVarint64=function(t){"number"==typeof t?t=e.fromNumber(t):"string"==typeof t&&(t=e.fromString(t));var n=t.toInt()>>>0,r=t.shiftRightUnsigned(28).toInt()>>>0,i=t.shiftRightUnsigned(56).toInt()>>>0;return 0==i?0==r?16384>n?128>n?1:2:1<<21>n?3:4:16384>r?128>r?5:6:1<<21>r?7:8:128>i?9:10},o.zigZagEncode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned()},o.zigZagDecode64=function(t){return"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned()),t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned()},s.writeVarint64=function(t,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"==typeof t)t=e.fromNumber(t);else if("string"==typeof t)t=e.fromString(t);else if(!(t&&t instanceof e))throw TypeError("Illegal value: "+t+" (not an integer or Long)");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}"number"==typeof t?t=e.fromNumber(t,!1):"string"==typeof t?t=e.fromString(t,!1):t.unsigned!==!1&&(t=t.toSigned());var i=o.calculateVarint64(t),s=t.toInt()>>>0,a=t.shiftRightUnsigned(28).toInt()>>>0,f=t.shiftRightUnsigned(56).toInt()>>>0;n+=i;var u=this.buffer.byteLength;switch(n>u&&this.resize((u*=2)>n?u:n),n-=i,i){case 10:this.view[n+9]=f>>>7&1;case 9:this.view[n+8]=9!==i?128|f:127&f;case 8:this.view[n+7]=8!==i?a>>>21|128:a>>>21&127;case 7:this.view[n+6]=7!==i?a>>>14|128:a>>>14&127;case 6:this.view[n+5]=6!==i?a>>>7|128:a>>>7&127;case 5:this.view[n+4]=5!==i?128|a:127&a;case 4:this.view[n+3]=4!==i?s>>>21|128:s>>>21&127;case 3:this.view[n+2]=3!==i?s>>>14|128:s>>>14&127;case 2:this.view[n+1]=2!==i?s>>>7|128:s>>>7&127;case 1:this.view[n]=1!==i?128|s:127&s}return r?(this.offset+=i,this):i},s.writeVarint64ZigZag=function(e,t){return this.writeVarint64(o.zigZagEncode64(e),t)},s.readVarint64=function(t){var n="undefined"==typeof t;if(n&&(t=this.offset),!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: "+t+" (not an integer)");if(t>>>=0,0>t||t+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+t+" (+1) <= "+this.buffer.byteLength)}var r=t,i=0,o=0,s=0,a=0;if(a=this.view[t++],i=127&a,128&a&&(a=this.view[t++],i|=(127&a)<<7,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],i|=(127&a)<<14,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],i|=(127&a)<<21,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],o=127&a,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],o|=(127&a)<<7,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],o|=(127&a)<<14,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],o|=(127&a)<<21,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],s=127&a,(128&a||this.noAssert&&"undefined"==typeof a)&&(a=this.view[t++],s|=(127&a)<<7,128&a||this.noAssert&&"undefined"==typeof a))))))))))throw Error("Buffer overrun");var f=e.fromBits(i|o<<28,o>>>4|s<<24,!1);return n?(this.offset=t,f):{value:f,length:t-r}},s.readVarint64ZigZag=function(t){var n=this.readVarint64(t);return n&&n.value instanceof e?n.value=o.zigZagDecode64(n.value):n=o.zigZagDecode64(n),n}),s.writeCString=function(e,n){var r="undefined"==typeof n;r&&(n=this.offset);var i,o=e.length;if(!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");for(i=0;o>i;++i)if(0===e.charCodeAt(i))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}o=l.calculateUTF16asUTF8(t(e))[1],n+=o+1;var s=this.buffer.byteLength;return n>s&&this.resize((s*=2)>n?s:n),n-=o+1,l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),this.view[n++]=0,r?(this.offset=n,this):o},s.readCString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var r,i=e,o=-1;return l.decodeUTF8toUTF16(function(){if(0===o)return null;if(e>=this.limit)throw RangeError("Illegal range: Truncated data, "+e+" < "+this.limit);return o=this.view[e++],0===o?null:o}.bind(this),r=n(),!0),t?(this.offset=e,r()):{string:r(),length:e-i}},s.writeIString=function(e,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=n;i=l.calculateUTF16asUTF8(t(e),this.noAssert)[1],n+=4+i;var s=this.buffer.byteLength;if(n>s&&this.resize((s*=2)>n?s:n),n-=4+i,this.littleEndian?(this.view[n+3]=i>>>24&255,this.view[n+2]=i>>>16&255,this.view[n+1]=i>>>8&255,this.view[n]=255&i):(this.view[n]=i>>>24&255,this.view[n+1]=i>>>16&255,this.view[n+2]=i>>>8&255,this.view[n+3]=255&i),n+=4,l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==o+4+i)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+4+i));return r?(this.offset=n,this):n-o},s.readIString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+4) <= "+this.buffer.byteLength)}var n=e,r=this.readUint32(e),i=this.readUTF8String(r,o.METRICS_BYTES,e+=4);return e+=i.length,t?(this.offset=e,i.string):{string:i.string,length:e-n}},o.METRICS_CHARS="c",o.METRICS_BYTES="b",s.writeUTF8String=function(e,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,o=n;i=l.calculateUTF16asUTF8(t(e))[1],n+=i;var s=this.buffer.byteLength;return n>s&&this.resize((s*=2)>n?s:n),n-=i,l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),r?(this.offset=n,this):n-o},s.writeString=s.writeUTF8String,o.calculateUTF8Chars=function(e){return l.calculateUTF16asUTF8(t(e))[0]},o.calculateUTF8Bytes=function(e){return l.calculateUTF16asUTF8(t(e))[1]},o.calculateString=o.calculateUTF8Bytes,s.readUTF8String=function(e,t,r){"number"==typeof t&&(r=t,t=void 0);var i="undefined"==typeof r;if(i&&(r=this.offset),"undefined"==typeof t&&(t=o.METRICS_CHARS),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal length: "+e+" (not an integer)");if(e|=0,"number"!=typeof r||r%1!==0)throw TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+0) <= "+this.buffer.byteLength)}var s,a=0,f=r;if(t===o.METRICS_CHARS){if(s=n(),l.decodeUTF8(function(){return e>a&&r<this.limit?this.view[r++]:null}.bind(this),function(e){++a,l.UTF8toUTF16(e,s)}),a!==e)throw RangeError("Illegal range: Truncated data, "+a+" == "+e);return i?(this.offset=r,s()):{string:s(),length:r-f}}if(t===o.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof r||r%1!==0)throw TypeError("Illegal offset: "+r+" (not an integer)");if(r>>>=0,0>r||r+e>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+r+" (+"+e+") <= "+this.buffer.byteLength)}var u=r+e;if(l.decodeUTF8toUTF16(function(){return u>r?this.view[r++]:null}.bind(this),s=n(),this.noAssert),r!==u)throw RangeError("Illegal range: Truncated data, "+r+" == "+u);return i?(this.offset=r,s()):{string:s(),length:r-f}}throw TypeError("Unsupported metrics: "+t)},s.readString=s.readUTF8String,s.writeVString=function(e,n){var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}var i,s,a=n;i=l.calculateUTF16asUTF8(t(e),this.noAssert)[1],s=o.calculateVarint32(i),n+=s+i;var f=this.buffer.byteLength;if(n>f&&this.resize((f*=2)>n?f:n),n-=s+i,n+=this.writeVarint32(i,n),l.encodeUTF16toUTF8(t(e),function(e){this.view[n++]=e}.bind(this)),n!==a+i+s)throw RangeError("Illegal range: Truncated data, "+n+" == "+(n+i+s));return r?(this.offset=n,this):n-a},s.readVString=function(e){var t="undefined"==typeof e;if(t&&(e=this.offset),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+1) <= "+this.buffer.byteLength)}var n=e,r=this.readVarint32(e),i=this.readUTF8String(r.value,o.METRICS_BYTES,e+=r.length);return e+=i.length,t?(this.offset=e,i.string):{string:i.string,length:e-n}},s.append=function(e,t,n){("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0);var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof o||(e=o.wrap(e,t));var i=e.limit-e.offset;if(0>=i)return this;n+=i;var s=this.buffer.byteLength;return n>s&&this.resize((s*=2)>n?s:n),n-=i,this.view.set(e.view.subarray(e.offset,e.limit),n),e.offset+=i,r&&(this.offset+=i),this},s.appendTo=function(e,t){return e.append(this,t),this},s.assert=function(e){return this.noAssert=!e,this},s.capacity=function(){return this.buffer.byteLength},s.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},s.clone=function(e){var t=new o(0,this.littleEndian,this.noAssert);return e?(t.buffer=new ArrayBuffer(this.buffer.byteLength),t.view=new Uint8Array(t.buffer)):(t.buffer=this.buffer,t.view=this.view),t.offset=this.offset,t.markedOffset=this.markedOffset,t.limit=this.limit,t},s.compact=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(0===e&&t===this.buffer.byteLength)return this;var n=t-e;if(0===n)return this.buffer=a,this.view=null,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=0,this;var r=new ArrayBuffer(n),i=new Uint8Array(r);return i.set(this.view.subarray(e,t)),this.buffer=r,this.view=i,this.markedOffset>=0&&(this.markedOffset-=e),this.offset=0,this.limit=n,this},s.copy=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}if(e===t)return new o(0,this.littleEndian,this.noAssert);var n=t-e,r=new o(n,this.littleEndian,this.noAssert);return r.offset=0,r.limit=n,r.markedOffset>=0&&(r.markedOffset-=e),this.copyTo(r,0,e,t),r},s.copyTo=function(e,t,n,r){var i,s;if(!this.noAssert&&!o.isByteBuffer(e))throw TypeError("Illegal target: Not a ByteBuffer");if(t=(s="undefined"==typeof t)?e.offset:0|t,n=(i="undefined"==typeof n)?this.offset:0|n,r="undefined"==typeof r?this.limit:0|r,0>t||t>e.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+t+" <= "+e.buffer.byteLength);if(0>n||r>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+n+" <= "+this.buffer.byteLength);var a=r-n;return 0===a?e:(e.ensureCapacity(t+a),e.view.set(this.view.subarray(n,r),t),i&&(this.offset+=a),s&&(e.offset+=a),this)},s.ensureCapacity=function(e){var t=this.buffer.byteLength;return e>t?this.resize((t*=2)>e?t:e):this},s.fill=function(e,t,n){var r="undefined"==typeof t;if(r&&(t=this.offset),"string"==typeof e&&e.length>0&&(e=e.charCodeAt(0)),"undefined"==typeof t&&(t=this.offset),"undefined"==typeof n&&(n=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal value: "+e+" (not an integer)");if(e|=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal begin: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!==0)throw TypeError("Illegal end: Not an integer");if(n>>>=0,0>t||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(t>=n)return this;for(;n>t;)this.view[t++]=e;return r&&(this.offset=t),this},s.flip=function(){return this.limit=this.offset,this.offset=0,this},s.mark=function(e){if(e="undefined"==typeof e?this.offset:e,!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal offset: "+e+" (not an integer)");if(e>>>=0,0>e||e+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+e+" (+0) <= "+this.buffer.byteLength);
}return this.markedOffset=e,this},s.order=function(e){if(!this.noAssert&&"boolean"!=typeof e)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!e,this},s.LE=function(e){return this.littleEndian="undefined"!=typeof e?!!e:!0,this},s.BE=function(e){return this.littleEndian="undefined"!=typeof e?!e:!1,this},s.prepend=function(e,t,n){("number"==typeof t||"string"!=typeof t)&&(n=t,t=void 0);var r="undefined"==typeof n;if(r&&(n=this.offset),!this.noAssert){if("number"!=typeof n||n%1!==0)throw TypeError("Illegal offset: "+n+" (not an integer)");if(n>>>=0,0>n||n+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+n+" (+0) <= "+this.buffer.byteLength)}e instanceof o||(e=o.wrap(e,t));var i=e.limit-e.offset;if(0>=i)return this;var s=i-n;if(s>0){var a=new ArrayBuffer(this.buffer.byteLength+s),f=new Uint8Array(a);f.set(this.view.subarray(n,this.buffer.byteLength),i),this.buffer=a,this.view=f,this.offset+=s,this.markedOffset>=0&&(this.markedOffset+=s),this.limit+=s,n+=s}else{new Uint8Array(this.buffer)}return this.view.set(e.view.subarray(e.offset,e.limit),n-i),e.offset=e.limit,r&&(this.offset-=i),this},s.prependTo=function(e,t){return e.prepend(this,t),this},s.printDebug=function(e){"function"!=typeof e&&(e=console.log.bind(console)),e(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},s.remaining=function(){return this.limit-this.offset},s.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},s.resize=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal capacity: "+e+" (not an integer)");if(e|=0,0>e)throw RangeError("Illegal capacity: 0 <= "+e)}if(this.buffer.byteLength<e){var t=new ArrayBuffer(e),n=new Uint8Array(t);n.set(this.view),this.buffer=t,this.view=n}return this},s.reverse=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}return e===t?this:(Array.prototype.reverse.call(this.view.subarray(e,t)),this)},s.skip=function(e){if(!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal length: "+e+" (not an integer)");e|=0}var t=this.offset+e;if(!this.noAssert&&(0>t||t>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+e+" <= "+this.buffer.byteLength);return this.offset=t,this},s.slice=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var n=this.clone();return n.offset=e,n.limit=t,n},s.toBuffer=function(e){var t=this.offset,n=this.limit;if(!this.noAssert){if("number"!=typeof t||t%1!==0)throw TypeError("Illegal offset: Not an integer");if(t>>>=0,"number"!=typeof n||n%1!==0)throw TypeError("Illegal limit: Not an integer");if(n>>>=0,0>t||t>n||n>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+t+" <= "+n+" <= "+this.buffer.byteLength)}if(!e&&0===t&&n===this.buffer.byteLength)return this.buffer;if(t===n)return a;var r=new ArrayBuffer(n-t);return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(t,n),0),r},s.toArrayBuffer=s.toBuffer,s.toString=function(e,t,n){if("undefined"==typeof e)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof e&&(e="utf8",t=e,n=t),e){case"utf8":return this.toUTF8(t,n);case"base64":return this.toBase64(t,n);case"hex":return this.toHex(t,n);case"binary":return this.toBinary(t,n);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+e)}};var u=function(){for(var e={},t=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],n=[],r=0,i=t.length;i>r;++r)n[t[r]]=r;return e.encode=function(e,n){for(var r,i;null!==(r=e());)n(t[r>>2&63]),i=(3&r)<<4,null!==(r=e())?(i|=r>>4&15,n(t[63&(i|r>>4&15)]),i=(15&r)<<2,null!==(r=e())?(n(t[63&(i|r>>6&3)]),n(t[63&r])):(n(t[63&i]),n(61))):(n(t[63&i]),n(61),n(61))},e.decode=function(e,t){function r(e){throw Error("Illegal character code: "+e)}for(var i,o,s;null!==(i=e());)if(o=n[i],"undefined"==typeof o&&r(i),null!==(i=e())&&(s=n[i],"undefined"==typeof s&&r(i),t(o<<2>>>0|(48&s)>>4),null!==(i=e()))){if(o=n[i],"undefined"==typeof o){if(61===i)break;r(i)}if(t((15&s)<<4>>>0|(60&o)>>2),null!==(i=e())){if(s=n[i],"undefined"==typeof s){if(61===i)break;r(i)}t((3&o)<<6>>>0|s)}}},e.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)},e}();s.toBase64=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),e=0|e,t=0|t,0>e||t>this.capacity||e>t)throw RangeError("begin, end");var r;return u.encode(function(){return t>e?this.view[e++]:null}.bind(this),r=n()),r()},o.fromBase64=function(e,n){if("string"!=typeof e)throw TypeError("str");var r=new o(e.length/4*3,n),i=0;return u.decode(t(e),function(e){r.view[i++]=e}),r.limit=i,r},o.btoa=function(e){return o.fromBinary(e).toBase64()},o.atob=function(e){return o.fromBase64(e).toBinary()},s.toBinary=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),e|=0,t|=0,0>e||t>this.capacity()||e>t)throw RangeError("begin, end");if(e===t)return"";for(var n=[],r=[];t>e;)n.push(this.view[e++]),n.length>=1024&&(r.push(String.fromCharCode.apply(String,n)),n=[]);return r.join("")+String.fromCharCode.apply(String,n)},o.fromBinary=function(e,t){if("string"!=typeof e)throw TypeError("str");for(var n,r=0,i=e.length,s=new o(i,t);i>r;){if(n=e.charCodeAt(r),n>255)throw RangeError("illegal char code: "+n);s.view[r++]=n}return s.limit=i,s},s.toDebug=function(e){for(var t,n=-1,r=this.buffer.byteLength,i="",o="",s="";r>n;){if(-1!==n&&(t=this.view[n],i+=16>t?"0"+t.toString(16).toUpperCase():t.toString(16).toUpperCase(),e&&(o+=t>32&&127>t?String.fromCharCode(t):".")),++n,e&&n>0&&n%16===0&&n!==r){for(;i.length<51;)i+=" ";s+=i+o+"\n",i=o=""}i+=n===this.offset&&n===this.limit?n===this.markedOffset?"!":"|":n===this.offset?n===this.markedOffset?"[":"<":n===this.limit?n===this.markedOffset?"]":">":n===this.markedOffset?"'":e||0!==n&&n!==r?" ":""}if(e&&" "!==i){for(;i.length<51;)i+=" ";s+=i+o+"\n"}return e?s:i},o.fromDebug=function(e,t,n){for(var r,i,s=e.length,a=new o((s+1)/3|0,t,n),f=0,u=0,l=!1,c=!1,h=!1,d=!1,p=!1;s>f;){switch(r=e.charAt(f++)){case"!":if(!n){if(c||h||d){p=!0;break}c=h=d=!0}a.offset=a.markedOffset=a.limit=u,l=!1;break;case"|":if(!n){if(c||d){p=!0;break}c=d=!0}a.offset=a.limit=u,l=!1;break;case"[":if(!n){if(c||h){p=!0;break}c=h=!0}a.offset=a.markedOffset=u,l=!1;break;case"<":if(!n){if(c){p=!0;break}c=!0}a.offset=u,l=!1;break;case"]":if(!n){if(d||h){p=!0;break}d=h=!0}a.limit=a.markedOffset=u,l=!1;break;case">":if(!n){if(d){p=!0;break}d=!0}a.limit=u,l=!1;break;case"'":if(!n){if(h){p=!0;break}h=!0}a.markedOffset=u,l=!1;break;case" ":l=!1;break;default:if(!n&&l){p=!0;break}if(i=parseInt(r+e.charAt(f++),16),!n&&(isNaN(i)||0>i||i>255))throw TypeError("Illegal str: Not a debug encoded string");a.view[u++]=i,l=!0}if(p)throw TypeError("Illegal str: Invalid symbol at "+f)}if(!n){if(!c||!d)throw TypeError("Illegal str: Missing offset or limit");if(u<a.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+u+" < "+s)}return a},s.toHex=function(e,t){if(e="undefined"==typeof e?this.offset:e,t="undefined"==typeof t?this.limit:t,!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}for(var n,r=new Array(t-e);t>e;)n=this.view[e++],16>n?r.push("0",n.toString(16)):r.push(n.toString(16));return r.join("")},o.fromHex=function(e,t,n){if(!n){if("string"!=typeof e)throw TypeError("Illegal str: Not a string");if(e.length%2!==0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var r,i=e.length,s=new o(i/2|0,t),a=0,f=0;i>a;a+=2){if(r=parseInt(e.substring(a,a+2),16),!n&&(!isFinite(r)||0>r||r>255))throw TypeError("Illegal str: Contains non-hex characters");s.view[f++]=r}return s.limit=f,s};var l=function(){var e={};return e.MAX_CODEPOINT=1114111,e.encodeUTF8=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)128>n?t(127&n):2048>n?(t(n>>6&31|192),t(63&n|128)):65536>n?(t(n>>12&15|224),t(n>>6&63|128),t(63&n|128)):(t(n>>18&7|240),t(n>>12&63|128),t(n>>6&63|128),t(63&n|128)),n=null},e.decodeUTF8=function(e,t){for(var n,r,i,o,s=function(e){e=e.slice(0,e.indexOf(null));var t=Error(e.toString());throw t.name="TruncatedError",t.bytes=e,t};null!==(n=e());)if(0===(128&n))t(n);else if(192===(224&n))null===(r=e())&&s([n,r]),t((31&n)<<6|63&r);else if(224===(240&n))(null===(r=e())||null===(i=e()))&&s([n,r,i]),t((15&n)<<12|(63&r)<<6|63&i);else{if(240!==(248&n))throw RangeError("Illegal starting byte: "+n);(null===(r=e())||null===(i=e())||null===(o=e()))&&s([n,r,i,o]),t((7&n)<<18|(63&r)<<12|(63&i)<<6|63&o)}},e.UTF16toUTF8=function(e,t){for(var n,r=null;;){if(null===(n=null!==r?r:e()))break;n>=55296&&57343>=n&&null!==(r=e())&&r>=56320&&57343>=r?(t(1024*(n-55296)+r-56320+65536),r=null):t(n)}null!==r&&t(r)},e.UTF8toUTF16=function(e,t){var n=null;for("number"==typeof e&&(n=e,e=function(){return null});null!==n||null!==(n=e());)65535>=n?t(n):(n-=65536,t((n>>10)+55296),t(n%1024+56320)),n=null},e.encodeUTF16toUTF8=function(t,n){e.UTF16toUTF8(t,function(t){e.encodeUTF8(t,n)})},e.decodeUTF8toUTF16=function(t,n){e.decodeUTF8(t,function(t){e.UTF8toUTF16(t,n)})},e.calculateCodePoint=function(e){return 128>e?1:2048>e?2:65536>e?3:4},e.calculateUTF8=function(e){for(var t,n=0;null!==(t=e());)n+=128>t?1:2048>t?2:65536>t?3:4;return n},e.calculateUTF16asUTF8=function(t){var n=0,r=0;return e.UTF16toUTF8(t,function(e){++n,r+=128>e?1:2048>e?2:65536>e?3:4}),[n,r]},e}();return s.toUTF8=function(e,t){if("undefined"==typeof e&&(e=this.offset),"undefined"==typeof t&&(t=this.limit),!this.noAssert){if("number"!=typeof e||e%1!==0)throw TypeError("Illegal begin: Not an integer");if(e>>>=0,"number"!=typeof t||t%1!==0)throw TypeError("Illegal end: Not an integer");if(t>>>=0,0>e||e>t||t>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+e+" <= "+t+" <= "+this.buffer.byteLength)}var r;try{l.decodeUTF8toUTF16(function(){return t>e?this.view[e++]:null}.bind(this),r=n())}catch(i){if(e!==t)throw RangeError("Illegal range: Truncated data, "+e+" != "+t)}return r()},o.fromUTF8=function(e,n,r){if(!r&&"string"!=typeof e)throw TypeError("Illegal str: Not a string");var i=new o(l.calculateUTF16asUTF8(t(e),!0)[1],n,r),s=0;return l.encodeUTF16toUTF8(t(e),function(e){i.view[s++]=e}),i.limit=s,i},o})}),pi=di&&"object"==typeof di&&"default"in di?di["default"]:di,yi=t(function(e,t,n){!function(t,n){"function"==typeof i&&i.amd?i(["bytebuffer"],n):"function"==typeof o&&"object"==typeof e&&e&&e.exports?e.exports=n(pi,!0):(t.dcodeIO=t.dcodeIO||{}).ProtoBuf=n(t.dcodeIO.ByteBuffer)}(s,function(e,t){var n={};return n.ByteBuffer=e,n.Long=e.Long||null,n.VERSION="5.0.1",n.WIRE_TYPES={},n.WIRE_TYPES.VARINT=0,n.WIRE_TYPES.BITS64=1,n.WIRE_TYPES.LDELIM=2,n.WIRE_TYPES.STARTGROUP=3,n.WIRE_TYPES.ENDGROUP=4,n.WIRE_TYPES.BITS32=5,n.PACKABLE_WIRE_TYPES=[n.WIRE_TYPES.VARINT,n.WIRE_TYPES.BITS64,n.WIRE_TYPES.BITS32],n.TYPES={int32:{name:"int32",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},uint32:{name:"uint32",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},sint32:{name:"sint32",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},int64:{name:"int64",wireType:n.WIRE_TYPES.VARINT,defaultValue:n.Long?n.Long.ZERO:void 0},uint64:{name:"uint64",wireType:n.WIRE_TYPES.VARINT,defaultValue:n.Long?n.Long.UZERO:void 0},sint64:{name:"sint64",wireType:n.WIRE_TYPES.VARINT,defaultValue:n.Long?n.Long.ZERO:void 0},bool:{name:"bool",wireType:n.WIRE_TYPES.VARINT,defaultValue:!1},"double":{name:"double",wireType:n.WIRE_TYPES.BITS64,defaultValue:0},string:{name:"string",wireType:n.WIRE_TYPES.LDELIM,defaultValue:""},bytes:{name:"bytes",wireType:n.WIRE_TYPES.LDELIM,defaultValue:null},fixed32:{name:"fixed32",wireType:n.WIRE_TYPES.BITS32,defaultValue:0},sfixed32:{name:"sfixed32",wireType:n.WIRE_TYPES.BITS32,defaultValue:0},fixed64:{name:"fixed64",wireType:n.WIRE_TYPES.BITS64,defaultValue:n.Long?n.Long.UZERO:void 0},sfixed64:{name:"sfixed64",wireType:n.WIRE_TYPES.BITS64,defaultValue:n.Long?n.Long.ZERO:void 0},"float":{name:"float",wireType:n.WIRE_TYPES.BITS32,defaultValue:0},"enum":{name:"enum",wireType:n.WIRE_TYPES.VARINT,defaultValue:0},message:{name:"message",wireType:n.WIRE_TYPES.LDELIM,defaultValue:null},group:{name:"group",wireType:n.WIRE_TYPES.STARTGROUP,defaultValue:null}},n.MAP_KEY_TYPES=[n.TYPES.int32,n.TYPES.sint32,n.TYPES.sfixed32,n.TYPES.uint32,n.TYPES.fixed32,n.TYPES.int64,n.TYPES.sint64,n.TYPES.sfixed64,n.TYPES.uint64,n.TYPES.fixed64,n.TYPES.bool,n.TYPES.string,n.TYPES.bytes],n.ID_MIN=1,n.ID_MAX=536870911,n.convertFieldsToCamelCase=!1,n.populateAccessors=!0,n.populateDefaults=!0,n.Util=function(){var e={};return e.IS_NODE=!("object"!=typeof a||a+""!="[object process]"||a.browser),e.XHR=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=null,n=0;n<e.length;n++){try{t=e[n]()}catch(r){continue}break}if(!t)throw Error("XMLHttpRequest is not supported");return t},e.fetch=function(t,n){if(n&&"function"!=typeof n&&(n=null),e.IS_NODE){var r=li;if(n)r.readFile(t,function(e,t){n(e?null:""+t)});else try{return r.readFileSync(t)}catch(i){return null}}else{var o=e.XHR();if(o.open("GET",t,n?!0:!1),o.setRequestHeader("Accept","text/plain"),"function"==typeof o.overrideMimeType&&o.overrideMimeType("text/plain"),!n)return o.send(null),200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null;if(o.onreadystatechange=function(){4==o.readyState&&n(200==o.status||0==o.status&&"string"==typeof o.responseText?o.responseText:null)},4==o.readyState)return;o.send(null)}},e.toCamelCase=function(e){return e.replace(/_([a-zA-Z])/g,function(e,t){return t.toUpperCase()})},e}(),n.Lang={DELIM:/[\s\{\}=;:\[\],'"\(\)<>]/g,RULE:/^(?:required|optional|repeated|map)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0[xX][0-9a-fA-F]+$/,NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/,BOOL:/^(?:true|false)$/i,ID:/^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,STRING_DQ:/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,STRING_SQ:/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g},n.Reflect=function(t){function n(n){if("string"==typeof n&&(n=t.TYPES[n]),"undefined"==typeof n.defaultValue)throw Error("default value for type "+n.name+" is not supported");return n==t.TYPES.bytes?new e(0):n.defaultValue}function r(e,n){if(e&&"number"==typeof e.low&&"number"==typeof e.high&&"boolean"==typeof e.unsigned&&e.low===e.low&&e.high===e.high)return new t.Long(e.low,e.high,"undefined"==typeof n?e.unsigned:n);if("string"==typeof e)return t.Long.fromString(e,n||!1,10);if("number"==typeof e)return t.Long.fromNumber(e,n||!1);throw Error("not convertible to Long")}function i(e,n){var r=n.readVarint32(),o=7&r,s=r>>>3;switch(o){case t.WIRE_TYPES.VARINT:do r=n.readUint8();while(128===(128&r));break;case t.WIRE_TYPES.BITS64:n.offset+=8;break;case t.WIRE_TYPES.LDELIM:r=n.readVarint32(),n.offset+=r;break;case t.WIRE_TYPES.STARTGROUP:i(s,n);break;case t.WIRE_TYPES.ENDGROUP:if(s===e)return!1;throw Error("Illegal GROUPEND after unknown group: "+s+" ("+e+" expected)");case t.WIRE_TYPES.BITS32:n.offset+=4;break;default:throw Error("Illegal wire type in unknown group "+e+": "+o)}return!0}var o={},s=function(e,t,n){this.builder=e,this.parent=t,this.name=n,this.className},a=s.prototype;a.fqn=function(){for(var e=this.name,t=this;;){if(t=t.parent,null==t)break;e=t.name+"."+e}return e},a.toString=function(e){return(e?this.className+" ":"")+this.fqn()},a.build=function(){throw Error(this.toString(!0)+" cannot be built directly")},o.T=s;var f=function(e,t,n,r,i){s.call(this,e,t,n),this.className="Namespace",this.children=[],this.options=r||{},this.syntax=i||"proto2"},u=f.prototype=Object.create(s.prototype);u.getChildren=function(e){if(e=e||null,null==e)return this.children.slice();for(var t=[],n=0,r=this.children.length;r>n;++n)this.children[n]instanceof e&&t.push(this.children[n]);return t},u.addChild=function(e){var t;if(t=this.getChild(e.name))if(t instanceof h.Field&&t.name!==t.originalName&&null===this.getChild(t.originalName))t.name=t.originalName;else{if(!(e instanceof h.Field&&e.name!==e.originalName&&null===this.getChild(e.originalName)))throw Error("Duplicate name in namespace "+this.toString(!0)+": "+e.name);e.name=e.originalName}this.children.push(e)},u.getChild=function(e){for(var t="number"==typeof e?"id":"name",n=0,r=this.children.length;r>n;++n)if(this.children[n][t]===e)return this.children[n];return null},u.resolve=function(e,t){var n="string"==typeof e?e.split("."):e,r=this,i=0;if(""===n[i]){for(;null!==r.parent;)r=r.parent;i++}var s;do{do{if(!(r instanceof o.Namespace)){r=null;break}if(s=r.getChild(n[i]),!s||!(s instanceof o.T)||t&&!(s instanceof o.Namespace)){r=null;break}r=s,i++}while(i<n.length);if(null!=r)break;if(null!==this.parent)return this.parent.resolve(e,t)}while(null!=r);return r},u.qn=function(e){var t=[],n=e;do t.unshift(n.name),n=n.parent;while(null!==n);for(var r=1;r<=t.length;r++){var i=t.slice(t.length-r);if(e===this.resolve(i,e instanceof o.Namespace))return i.join(".")}return e.fqn()},u.build=function(){for(var e,t={},n=this.children,r=0,i=n.length;i>r;++r)e=n[r],e instanceof f&&(t[e.name]=e.build());return Object.defineProperty&&Object.defineProperty(t,"$options",{value:this.buildOpt()}),t},u.buildOpt=function(){for(var e={},t=Object.keys(this.options),n=0,r=t.length;r>n;++n){var i=t[n],o=this.options[t[n]];e[i]=o}return e},u.getOption=function(e){return"undefined"==typeof e?this.options:"undefined"!=typeof this.options[e]?this.options[e]:null},o.Namespace=f;var l=function(e,n,r,i){if(this.type=e,this.resolvedType=n,this.isMapKey=r,this.syntax=i,r&&t.MAP_KEY_TYPES.indexOf(e)<0)throw Error("Invalid map key type: "+e.name)},c=l.prototype;l.defaultFieldValue=n,c.verifyValue=function(n){function i(e,t){throw Error("Illegal value for "+o.toString(!0)+" of type "+o.type.name+": "+e+" ("+t+")")}var o=this;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:return("number"!=typeof n||n===n&&n%1!==0)&&i(typeof n,"not an integer"),n>4294967295?0|n:n;case t.TYPES.uint32:case t.TYPES.fixed32:return("number"!=typeof n||n===n&&n%1!==0)&&i(typeof n,"not an integer"),0>n?n>>>0:n;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:if(t.Long)try{return r(n,!1)}catch(s){i(typeof n,s.message)}else i(typeof n,"requires Long.js");case t.TYPES.uint64:case t.TYPES.fixed64:if(t.Long)try{return r(n,!0)}catch(s){i(typeof n,s.message)}else i(typeof n,"requires Long.js");case t.TYPES.bool:return"boolean"!=typeof n&&i(typeof n,"not a boolean"),n;case t.TYPES["float"]:case t.TYPES["double"]:return"number"!=typeof n&&i(typeof n,"not a number"),n;case t.TYPES.string:return"string"==typeof n||n&&n instanceof String||i(typeof n,"not a string"),""+n;case t.TYPES.bytes:return e.isByteBuffer(n)?n:e.wrap(n,"base64");case t.TYPES["enum"]:var a=this.resolvedType.getChildren(t.Reflect.Enum.Value);for(u=0;u<a.length;u++){if(a[u].name==n)return a[u].id;if(a[u].id==n)return a[u].id}if("proto3"===this.syntax)return("number"!=typeof n||n===n&&n%1!==0)&&i(typeof n,"not an integer"),(n>4294967295||0>n)&&i(typeof n,"not in range for uint32"),n;i(n,"not a valid enum value");case t.TYPES.group:case t.TYPES.message:if(n&&"object"==typeof n||i(typeof n,"object expected"),n instanceof this.resolvedType.clazz)return n;if(n instanceof t.Builder.Message){var f={};for(var u in n)n.hasOwnProperty(u)&&(f[u]=n[u]);n=f}return new this.resolvedType.clazz(n)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+n+" (undefined type "+this.type+")")},c.calculateLength=function(n,r){if(null===r)return 0;var i;switch(this.type){case t.TYPES.int32:return 0>r?e.calculateVarint64(r):e.calculateVarint32(r);case t.TYPES.uint32:return e.calculateVarint32(r);case t.TYPES.sint32:return e.calculateVarint32(e.zigZagEncode32(r));case t.TYPES.fixed32:case t.TYPES.sfixed32:case t.TYPES["float"]:return 4;case t.TYPES.int64:case t.TYPES.uint64:return e.calculateVarint64(r);case t.TYPES.sint64:return e.calculateVarint64(e.zigZagEncode64(r));case t.TYPES.fixed64:case t.TYPES.sfixed64:return 8;case t.TYPES.bool:return 1;case t.TYPES["enum"]:return e.calculateVarint32(r);case t.TYPES["double"]:return 8;case t.TYPES.string:return i=e.calculateUTF8Bytes(r),e.calculateVarint32(i)+i;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");return e.calculateVarint32(r.remaining())+r.remaining();case t.TYPES.message:return i=this.resolvedType.calculate(r),e.calculateVarint32(i)+i;case t.TYPES.group:return i=this.resolvedType.calculate(r),i+e.calculateVarint32(n<<3|t.WIRE_TYPES.ENDGROUP)}throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")},c.encodeValue=function(n,r,i){if(null===r)return i;switch(this.type){case t.TYPES.int32:0>r?i.writeVarint64(r):i.writeVarint32(r);break;case t.TYPES.uint32:i.writeVarint32(r);break;case t.TYPES.sint32:i.writeVarint32ZigZag(r);break;case t.TYPES.fixed32:i.writeUint32(r);break;case t.TYPES.sfixed32:i.writeInt32(r);break;case t.TYPES.int64:case t.TYPES.uint64:i.writeVarint64(r);break;case t.TYPES.sint64:i.writeVarint64ZigZag(r);break;case t.TYPES.fixed64:i.writeUint64(r);break;case t.TYPES.sfixed64:i.writeInt64(r);break;case t.TYPES.bool:"string"==typeof r?i.writeVarint32("false"===r.toLowerCase()?0:!!r):i.writeVarint32(r?1:0);break;case t.TYPES["enum"]:i.writeVarint32(r);break;case t.TYPES["float"]:i.writeFloat32(r);break;case t.TYPES["double"]:i.writeFloat64(r);break;case t.TYPES.string:i.writeVString(r);break;case t.TYPES.bytes:if(r.remaining()<0)throw Error("Illegal value for "+this.toString(!0)+": "+r.remaining()+" bytes remaining");var o=r.offset;i.writeVarint32(r.remaining()),i.append(r),r.offset=o;break;case t.TYPES.message:var s=(new e).LE();this.resolvedType.encode(r,s),i.writeVarint32(s.offset),i.append(s.flip());break;case t.TYPES.group:this.resolvedType.encode(r,i),i.writeVarint32(n<<3|t.WIRE_TYPES.ENDGROUP);break;default:throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+r+" (unknown type)")}return i},c.decode=function(e,n,r){if(n!=this.type.wireType)throw Error("Unexpected wire type for element");var i,o;switch(this.type){case t.TYPES.int32:return 0|e.readVarint32();case t.TYPES.uint32:return e.readVarint32()>>>0;case t.TYPES.sint32:return 0|e.readVarint32ZigZag();case t.TYPES.fixed32:return e.readUint32()>>>0;case t.TYPES.sfixed32:return 0|e.readInt32();case t.TYPES.int64:return e.readVarint64();case t.TYPES.uint64:return e.readVarint64().toUnsigned();case t.TYPES.sint64:return e.readVarint64ZigZag();case t.TYPES.fixed64:return e.readUint64();case t.TYPES.sfixed64:return e.readInt64();case t.TYPES.bool:return!!e.readVarint32();case t.TYPES["enum"]:return e.readVarint32();case t.TYPES["float"]:return e.readFloat();case t.TYPES["double"]:return e.readDouble();case t.TYPES.string:return e.readVString();case t.TYPES.bytes:if(o=e.readVarint32(),e.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+e.remaining());return i=e.clone(),i.limit=i.offset+o,e.offset+=o,i;case t.TYPES.message:return o=e.readVarint32(),this.resolvedType.decode(e,o);case t.TYPES.group:return this.resolvedType.decode(e,-1,r)}throw Error("[INTERNAL] Illegal decode type")},c.valueFromString=function(n){if(!this.isMapKey)throw Error("valueFromString() called on non-map-key element");switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return this.verifyValue(parseInt(n));case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return this.verifyValue(n);case t.TYPES.bool:return"true"===n;case t.TYPES.string:return this.verifyValue(n);case t.TYPES.bytes:return e.fromBinary(n)}},c.valueToString=function(e){if(!this.isMapKey)throw Error("valueToString() called on non-map-key element");return this.type===t.TYPES.bytes?e.toString("binary"):e.toString()},o.Element=l;var h=function(e,t,n,r,i,o){f.call(this,e,t,n,r,o),this.className="Message",this.extensions=void 0,this.clazz=null,this.isGroup=!!i,this._fields=null,this._fieldsById=null,this._fieldsByName=null},d=h.prototype=Object.create(f.prototype);d.build=function(n){if(this.clazz&&!n)return this.clazz;var r=function(t,n){function r(n,i,o,s){if(null===n||"object"!=typeof n){if(s&&s instanceof t.Reflect.Enum){var a=t.Reflect.Enum.getName(s.object,n);if(null!==a)return a}return n}if(e.isByteBuffer(n))return i?n.toBase64():n.toBuffer();if(t.Long.isLong(n))return o?n.toString():t.Long.fromValue(n);var f;if(Array.isArray(n))return f=[],n.forEach(function(e,t){f[t]=r(e,i,o,s)}),f;if(f={},n instanceof t.Map){for(var u=n.entries(),l=u.next();!l.done;l=u.next())f[n.keyElem.valueToString(l.value[0])]=r(l.value[1],i,o,n.valueElem.resolvedType);return f}var c=n.$type,h=void 0;for(var d in n)n.hasOwnProperty(d)&&(c&&(h=c.getChild(d))?f[d]=r(n[d],i,o,h.resolvedType):f[d]=r(n[d],i,o));return f}var i=n.getChildren(t.Reflect.Message.Field),o=n.getChildren(t.Reflect.Message.OneOf),s=function(r,a){t.Builder.Message.call(this);for(var f=0,u=o.length;u>f;++f)this[o[f].name]=null;for(f=0,u=i.length;u>f;++f){var l=i[f];this[l.name]=l.repeated?[]:l.map?new t.Map(l):null,!l.required&&"proto3"!==n.syntax||null===l.defaultValue||(this[l.name]=l.defaultValue)}if(arguments.length>0){var c;if(1!==arguments.length||null===r||"object"!=typeof r||!("function"!=typeof r.encode||r instanceof s)||Array.isArray(r)||r instanceof t.Map||e.isByteBuffer(r)||r instanceof ArrayBuffer||t.Long&&r instanceof t.Long)for(f=0,u=arguments.length;u>f;++f)"undefined"!=typeof(c=arguments[f])&&this.$set(i[f].name,c);else this.$set(r)}},a=s.prototype=Object.create(t.Builder.Message.prototype);a.add=function(e,r,i){var o=n._fieldsByName[e];if(!i){if(!o)throw Error(this+"#"+e+" is undefined");if(!(o instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+o.toString(!0));if(!o.repeated)throw Error(this+"#"+e+" is not a repeated field");r=o.verifyValue(r,!0)}return null===this[e]&&(this[e]=[]),this[e].push(r),this},a.$add=a.add,a.set=function(e,r,i){if(e&&"object"==typeof e){i=r;for(var o in e)e.hasOwnProperty(o)&&"undefined"!=typeof(r=e[o])&&this.$set(o,r,i);return this}var s=n._fieldsByName[e];if(i)this[e]=r;else{if(!s)throw Error(this+"#"+e+" is not a field: undefined");if(!(s instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+s.toString(!0));this[s.name]=r=s.verifyValue(r)}if(s&&s.oneof){var a=this[s.oneof.name];null!==r?(null!==a&&a!==s.name&&(this[a]=null),this[s.oneof.name]=s.name):a===e&&(this[s.oneof.name]=null)}return this},a.$set=a.set,a.get=function(e,r){if(r)return this[e];var i=n._fieldsByName[e];if(!(i&&i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: undefined");if(!(i instanceof t.Reflect.Message.Field))throw Error(this+"#"+e+" is not a field: "+i.toString(!0));return this[i.name]},a.$get=a.get;for(var f=0;f<i.length;f++){var u=i[f];u instanceof t.Reflect.Message.ExtensionField||n.builder.options.populateAccessors&&function(e){var t=e.originalName.replace(/(_[a-zA-Z])/g,function(e){return e.toUpperCase().replace("_","")});t=t.substring(0,1).toUpperCase()+t.substring(1);var r=e.originalName.replace(/([A-Z])/g,function(e){return"_"+e}),i=function(t,n){return this[e.name]=n?t:e.verifyValue(t),this},o=function(){return this[e.name]};null===n.getChild("set"+t)&&(a["set"+t]=i),null===n.getChild("set_"+r)&&(a["set_"+r]=i),null===n.getChild("get"+t)&&(a["get"+t]=o),null===n.getChild("get_"+r)&&(a["get_"+r]=o)}(u)}a.encode=function(t,r){"boolean"==typeof t&&(r=t,t=void 0);var i=!1;t||(t=new e,i=!0);var o=t.littleEndian;try{return n.encode(this,t.LE(),r),(i?t.flip():t).LE(o)}catch(s){throw t.LE(o),s}},s.encode=function(e,t,n){return new s(e).encode(t,n)},a.calculate=function(){return n.calculate(this)},a.encodeDelimited=function(t,r){var i=!1;t||(t=new e,i=!0);var o=(new e).LE();return n.encode(this,o,r).flip(),t.writeVarint32(o.remaining()),t.append(o),i?t.flip():t},a.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toArrayBuffer()),e}},a.toArrayBuffer=a.encodeAB,a.encodeNB=function(){try{return this.encode().toBuffer()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBuffer()),e}},a.toBuffer=a.encodeNB,a.encode64=function(){try{return this.encode().toBase64()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toBase64()),e}},a.toBase64=a.encode64,a.encodeHex=function(){try{return this.encode().toHex()}catch(e){throw e.encoded&&(e.encoded=e.encoded.toHex()),e}},a.toHex=a.encodeHex,a.toRaw=function(e,t){return r(this,!!e,!!t,this.$type)},a.encodeJSON=function(){return JSON.stringify(r(this,!0,!0,this.$type))},s.decode=function(t,r,i){"string"==typeof r&&(i=r,r=-1),"string"==typeof t&&(t=e.wrap(t,i?i:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t);var o=t.littleEndian;try{var s=n.decode(t.LE());return t.LE(o),s}catch(a){throw t.LE(o),a}},s.decodeDelimited=function(t,r){if("string"==typeof t&&(t=e.wrap(t,r?r:"base64")),t=e.isByteBuffer(t)?t:e.wrap(t),t.remaining()<1)return null;var i=t.offset,o=t.readVarint32();if(t.remaining()<o)return t.offset=i,null;try{var s=n.decode(t.slice(t.offset,t.offset+o).LE());return t.offset+=o,s}catch(a){throw t.offset+=o,a}},s.decode64=function(e){return s.decode(e,"base64")},s.decodeHex=function(e){return s.decode(e,"hex")},s.decodeJSON=function(e){return new s(JSON.parse(e))},a.toString=function(){return n.toString()};return Object.defineProperty&&(Object.defineProperty(s,"$options",{value:n.buildOpt()}),Object.defineProperty(a,"$options",{value:s.$options}),Object.defineProperty(s,"$type",{value:n}),Object.defineProperty(a,"$type",{value:n})),s}(t,this);this._fields=[],this._fieldsById={},this._fieldsByName={};for(var i,o=0,s=this.children.length;s>o;o++)if(i=this.children[o],i instanceof v||i instanceof h||i instanceof _){if(r.hasOwnProperty(i.name))throw Error("Illegal reflect child of "+this.toString(!0)+": "+i.toString(!0)+" cannot override static property '"+i.name+"'");r[i.name]=i.build()}else if(i instanceof h.Field)i.build(),
this._fields.push(i),this._fieldsById[i.id]=i,this._fieldsByName[i.name]=i;else if(!(i instanceof h.OneOf||i instanceof E))throw Error("Illegal reflect child of "+this.toString(!0)+": "+this.children[o].toString(!0));return this.clazz=r},d.encode=function(e,t,n){for(var r,i,o=null,s=0,a=this._fields.length;a>s;++s)r=this._fields[s],i=e[r.name],r.required&&null===i?null===o&&(o=r):r.encode(n?i:r.verifyValue(i),t,e);if(null!==o){var f=Error("Missing at least one required field for "+this.toString(!0)+": "+o);throw f.encoded=t,f}return t},d.calculate=function(e){for(var t,n,r=0,i=0,o=this._fields.length;o>i;++i){if(t=this._fields[i],n=e[t.name],t.required&&null===n)throw Error("Missing at least one required field for "+this.toString(!0)+": "+t);r+=t.calculate(n,e)}return r},d.decode=function(e,n,r){n="number"==typeof n?n:-1;for(var o,s,a,f,u=e.offset,l=new this.clazz;e.offset<u+n||-1===n&&e.remaining()>0;){if(o=e.readVarint32(),s=7&o,a=o>>>3,s===t.WIRE_TYPES.ENDGROUP){if(a!==r)throw Error("Illegal group end indicator for "+this.toString(!0)+": "+a+" ("+(r?r+" expected":"not a group")+")");break}if(f=this._fieldsById[a]){if(f.repeated&&!f.options.packed)l[f.name].push(f.decode(s,e));else if(f.map){var c=f.decode(s,e);l[f.name].set(c[0],c[1])}else if(l[f.name]=f.decode(s,e),f.oneof){var h=l[f.oneof.name];null!==h&&h!==f.name&&(l[h]=null),l[f.oneof.name]=f.name}}else switch(s){case t.WIRE_TYPES.VARINT:e.readVarint32();break;case t.WIRE_TYPES.BITS32:e.offset+=4;break;case t.WIRE_TYPES.BITS64:e.offset+=8;break;case t.WIRE_TYPES.LDELIM:var d=e.readVarint32();e.offset+=d;break;case t.WIRE_TYPES.STARTGROUP:for(;i(a,e););break;default:throw Error("Illegal wire type for unknown field "+a+" in "+this.toString(!0)+"#decode: "+s)}}for(var p=0,y=this._fields.length;y>p;++p)if(f=this._fields[p],null===l[f.name])if("proto3"===this.syntax)l[f.name]=f.defaultValue;else{if(f.required){var g=Error("Missing at least one required field for "+this.toString(!0)+": "+f.name);throw g.decoded=l,g}t.populateDefaults&&null!==f.defaultValue&&(l[f.name]=f.defaultValue)}return l},o.Message=h;var p=function(e,n,r,i,o,a,f,u,l,c){s.call(this,e,n,a),this.className="Message.Field",this.required="required"===r,this.repeated="repeated"===r,this.map="map"===r,this.keyType=i||null,this.type=o,this.resolvedType=null,this.id=f,this.options=u||{},this.defaultValue=null,this.oneof=l||null,this.syntax=c||"proto2",this.originalName=this.name,this.element=null,this.keyElement=null,!this.builder.options.convertFieldsToCamelCase||this instanceof h.ExtensionField||(this.name=t.Util.toCamelCase(this.name))},y=p.prototype=Object.create(s.prototype);y.build=function(){this.element=new l(this.type,this.resolvedType,!1,this.syntax),this.map&&(this.keyElement=new l(this.keyType,void 0,!0,this.syntax)),"proto3"!==this.syntax||this.repeated||this.map?"undefined"!=typeof this.options["default"]&&(this.defaultValue=this.verifyValue(this.options["default"])):this.defaultValue=l.defaultFieldValue(this.type)},y.verifyValue=function(e,n){function r(e,t){throw Error("Illegal value for "+i.toString(!0)+" of type "+i.type.name+": "+e+" ("+t+")")}n=n||!1;var i=this;if(null===e)return this.required&&r(typeof e,"required"),"proto3"===this.syntax&&this.type!==t.TYPES.message&&r(typeof e,"proto3 field without field presence cannot be null"),null;var o;if(this.repeated&&!n){Array.isArray(e)||(e=[e]);var s=[];for(o=0;o<e.length;o++)s.push(this.element.verifyValue(e[o]));return s}return this.map&&!n?e instanceof t.Map?e:(e instanceof Object||r(typeof e,"expected ProtoBuf.Map or raw object for map field"),new t.Map(this,e)):(!this.repeated&&Array.isArray(e)&&r(typeof e,"no array expected"),this.element.verifyValue(e))},y.hasWirePresence=function(e,n){if("proto3"!==this.syntax)return null!==e;if(this.oneof&&n[this.oneof.name]===this.name)return!0;switch(this.type){case t.TYPES.int32:case t.TYPES.sint32:case t.TYPES.sfixed32:case t.TYPES.uint32:case t.TYPES.fixed32:return 0!==e;case t.TYPES.int64:case t.TYPES.sint64:case t.TYPES.sfixed64:case t.TYPES.uint64:case t.TYPES.fixed64:return 0!==e.low||0!==e.high;case t.TYPES.bool:return e;case t.TYPES["float"]:case t.TYPES["double"]:return 0!==e;case t.TYPES.string:return e.length>0;case t.TYPES.bytes:return e.remaining()>0;case t.TYPES["enum"]:return 0!==e;case t.TYPES.message:return null!==e;default:return!0}},y.encode=function(n,r,i){if(null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===n||this.repeated&&0==n.length)return r;try{if(this.repeated){var o;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.ensureCapacity(r.offset+=1);var s=r.offset;for(o=0;o<n.length;o++)this.element.encodeValue(this.id,n[o],r);var a=r.offset-s,f=e.calculateVarint32(a);if(f>1){var u=r.slice(s,r.offset);s+=f-1,r.offset=s,r.append(u)}r.writeVarint32(a,s-f)}else for(o=0;o<n.length;o++)r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,n[o],r)}else this.map?n.forEach(function(n,i,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,i)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,n);r.writeVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),r.writeVarint32(s),r.writeVarint32(8|this.keyType.wireType),this.keyElement.encodeValue(1,i,r),r.writeVarint32(16|this.type.wireType),this.element.encodeValue(2,n,r)},this):this.hasWirePresence(n,i)&&(r.writeVarint32(this.id<<3|this.type.wireType),this.element.encodeValue(this.id,n,r))}catch(l){throw Error("Illegal value for "+this.toString(!0)+": "+n+" ("+l+")")}return r},y.calculate=function(n,r){if(n=this.verifyValue(n),null===this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===n||this.repeated&&0==n.length)return 0;var i=0;try{if(this.repeated){var o,s;if(this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0){for(i+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),s=0,o=0;o<n.length;o++)s+=this.element.calculateLength(this.id,n[o]);i+=e.calculateVarint32(s),i+=s}else for(o=0;o<n.length;o++)i+=e.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,n[o])}else this.map?n.forEach(function(n,r,o){var s=e.calculateVarint32(8|this.keyType.wireType)+this.keyElement.calculateLength(1,r)+e.calculateVarint32(16|this.type.wireType)+this.element.calculateLength(2,n);i+=e.calculateVarint32(this.id<<3|t.WIRE_TYPES.LDELIM),i+=e.calculateVarint32(s),i+=s},this):this.hasWirePresence(n,r)&&(i+=e.calculateVarint32(this.id<<3|this.type.wireType),i+=this.element.calculateLength(this.id,n))}catch(a){throw Error("Illegal value for "+this.toString(!0)+": "+n+" ("+a+")")}return i},y.decode=function(e,n,r){var i,o,s=!this.map&&e==this.type.wireType||!r&&this.repeated&&this.options.packed&&e==t.WIRE_TYPES.LDELIM||this.map&&e==t.WIRE_TYPES.LDELIM;if(!s)throw Error("Illegal wire type for field "+this.toString(!0)+": "+e+" ("+this.type.wireType+" expected)");if(e==t.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType)>=0&&!r){o=n.readVarint32(),o=n.offset+o;for(var a=[];n.offset<o;)a.push(this.decode(this.type.wireType,n,!0));return a}if(this.map){var f=l.defaultFieldValue(this.keyType);if(i=l.defaultFieldValue(this.type),o=n.readVarint32(),n.remaining()<o)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+o+" required but got only "+n.remaining());var u=n.clone();for(u.limit=u.offset+o,n.offset+=o;u.remaining()>0;){var c=u.readVarint32();e=7&c;var h=c>>>3;if(1===h)f=this.keyElement.decode(u,e,h);else{if(2!==h)throw Error("Unexpected tag in map field key/value submessage");i=this.element.decode(u,e,h)}}return[f,i]}return this.element.decode(n,e,this.id)},o.Message.Field=p;var g=function(e,t,n,r,i,o,s){p.call(this,e,t,n,null,r,i,o,s),this.extension};g.prototype=Object.create(p.prototype),o.Message.ExtensionField=g;var m=function(e,t,n){s.call(this,e,t,n),this.fields=[]};o.Message.OneOf=m;var v=function(e,t,n,r,i){f.call(this,e,t,n,r,i),this.className="Enum",this.object=null};v.getName=function(e,t){for(var n,r=Object.keys(e),i=0;i<r.length;++i)if(e[n=r[i]]===t)return n;return null};var b=v.prototype=Object.create(f.prototype);b.build=function(e){if(this.object&&!e)return this.object;for(var n=new t.Builder.Enum,r=this.getChildren(v.Value),i=0,o=r.length;o>i;++i)n[r[i].name]=r[i].id;return Object.defineProperty&&Object.defineProperty(n,"$options",{value:this.buildOpt(),enumerable:!1}),this.object=n},o.Enum=v;var w=function(e,t,n,r){s.call(this,e,t,n),this.className="Enum.Value",this.id=r};w.prototype=Object.create(s.prototype),o.Enum.Value=w;var E=function(e,t,n,r){s.call(this,e,t,n),this.field=r};E.prototype=Object.create(s.prototype),o.Extension=E;var _=function(e,t,n,r){f.call(this,e,t,n,r),this.className="Service",this.clazz=null},T=_.prototype=Object.create(f.prototype);T.build=function(n){return this.clazz&&!n?this.clazz:this.clazz=function(t,n){for(var r=function(e){t.Builder.Service.call(this),this.rpcImpl=e||function(e,t,n){setTimeout(n.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}},i=r.prototype=Object.create(t.Builder.Service.prototype),o=n.getChildren(t.Reflect.Service.RPCMethod),s=0;s<o.length;s++)!function(t){i[t.name]=function(r,i){try{try{r=t.resolvedRequestType.clazz.decode(e.wrap(r))}catch(o){if(!(o instanceof TypeError))throw o}if(null===r||"object"!=typeof r)throw Error("Illegal arguments");r instanceof t.resolvedRequestType.clazz||(r=new t.resolvedRequestType.clazz(r)),this.rpcImpl(t.fqn(),r,function(e,r){if(e)return void i(e);null===r&&(r="");try{r=t.resolvedResponseType.clazz.decode(r)}catch(o){}return r&&r instanceof t.resolvedResponseType.clazz?void i(null,r):void i(Error("Illegal response type received in service method "+n.name+"#"+t.name))})}catch(o){setTimeout(i.bind(this,o),0)}},r[t.name]=function(e,n,i){new r(e)[t.name](n,i)},Object.defineProperty&&(Object.defineProperty(r[t.name],"$options",{value:t.buildOpt()}),Object.defineProperty(i[t.name],"$options",{value:r[t.name].$options}))}(o[s]);return Object.defineProperty&&(Object.defineProperty(r,"$options",{value:n.buildOpt()}),Object.defineProperty(i,"$options",{value:r.$options}),Object.defineProperty(r,"$type",{value:n}),Object.defineProperty(i,"$type",{value:n})),r}(t,this)},o.Service=_;var S=function(e,t,n,r){s.call(this,e,t,n),this.className="Service.Method",this.options=r||{}},I=S.prototype=Object.create(s.prototype);I.buildOpt=u.buildOpt,o.Service.Method=S;var j=function(e,t,n,r,i,o,s,a){S.call(this,e,t,n,a),this.className="Service.RPCMethod",this.requestName=r,this.responseName=i,this.requestStream=o,this.responseStream=s,this.resolvedRequestType=null,this.resolvedResponseType=null};return j.prototype=Object.create(S.prototype),o.Service.RPCMethod=j,o}(n),n.Builder=function(e,t,n){function r(e){e.messages&&e.messages.forEach(function(t){t.syntax=e.syntax,r(t)}),e.enums&&e.enums.forEach(function(t){t.syntax=e.syntax})}var i=function(e){this.ns=new n.Namespace(this,null,""),this.ptr=this.ns,this.resolved=!1,this.result=null,this.files={},this.importRoot=null,this.options=e||{}},o=i.prototype;return i.isMessage=function(e){return"string"!=typeof e.name?!1:"undefined"!=typeof e.values||"undefined"!=typeof e.rpc?!1:!0},i.isMessageField=function(e){return"string"!=typeof e.rule||"string"!=typeof e.name||"string"!=typeof e.type||"undefined"==typeof e.id?!1:!0},i.isEnum=function(e){return"string"!=typeof e.name?!1:"undefined"!=typeof e.values&&Array.isArray(e.values)&&0!==e.values.length?!0:!1},i.isService=function(e){return"string"==typeof e.name&&"object"==typeof e.rpc&&e.rpc?!0:!1},i.isExtend=function(e){return"string"!=typeof e.ref?!1:!0},o.reset=function(){return this.ptr=this.ns,this},o.define=function(e){if("string"!=typeof e||!t.TYPEREF.test(e))throw Error("illegal namespace: "+e);return e.split(".").forEach(function(e){var t=this.ptr.getChild(e);null===t&&this.ptr.addChild(t=new n.Namespace(this,this.ptr,e)),this.ptr=t},this),this},o.create=function(t){if(!t)return this;if(Array.isArray(t)){if(0===t.length)return this;t=t.slice()}else t=[t];for(var r=[t];r.length>0;){if(t=r.pop(),!Array.isArray(t))throw Error("not a valid namespace: "+JSON.stringify(t));for(;t.length>0;){var o=t.shift();if(i.isMessage(o)){var s=new n.Message(this,this.ptr,o.name,o.options,o.isGroup,o.syntax),a={};o.oneofs&&Object.keys(o.oneofs).forEach(function(e){s.addChild(a[e]=new n.Message.OneOf(this,s,e))},this),o.fields&&o.fields.forEach(function(e){if(null!==s.getChild(0|e.id))throw Error("duplicate or invalid field id in "+s.name+": "+e.id);if(e.options&&"object"!=typeof e.options)throw Error("illegal field options in "+s.name+"#"+e.name);var t=null;if("string"==typeof e.oneof&&!(t=a[e.oneof]))throw Error("illegal oneof in "+s.name+"#"+e.name+": "+e.oneof);e=new n.Message.Field(this,s,e.rule,e.keytype,e.type,e.name,e.id,e.options,t,o.syntax),t&&t.fields.push(e),s.addChild(e)},this);var f=[];if(o.enums&&o.enums.forEach(function(e){f.push(e)}),o.messages&&o.messages.forEach(function(e){f.push(e)}),o.services&&o.services.forEach(function(e){f.push(e)}),o.extensions&&("number"==typeof o.extensions[0]?s.extensions=[o.extensions]:s.extensions=o.extensions),this.ptr.addChild(s),f.length>0){r.push(t),t=f,f=null,this.ptr=s,s=null;continue}f=null}else if(i.isEnum(o))s=new n.Enum(this,this.ptr,o.name,o.options,o.syntax),o.values.forEach(function(e){s.addChild(new n.Enum.Value(this,s,e.name,e.id))},this),this.ptr.addChild(s);else if(i.isService(o))s=new n.Service(this,this.ptr,o.name,o.options),Object.keys(o.rpc).forEach(function(e){var t=o.rpc[e];s.addChild(new n.Service.RPCMethod(this,s,e,t.request,t.response,!!t.request_stream,!!t.response_stream,t.options))},this),this.ptr.addChild(s);else{if(!i.isExtend(o))throw Error("not a valid definition: "+JSON.stringify(o));if(s=this.ptr.resolve(o.ref,!0))o.fields.forEach(function(t){if(null!==s.getChild(0|t.id))throw Error("duplicate extended field id in "+s.name+": "+t.id);if(s.extensions){var r=!1;if(s.extensions.forEach(function(e){t.id>=e[0]&&t.id<=e[1]&&(r=!0)}),!r)throw Error("illegal extended field id in "+s.name+": "+t.id+" (not within valid ranges)")}var i=t.name;this.options.convertFieldsToCamelCase&&(i=e.Util.toCamelCase(i));var o=new n.Message.ExtensionField(this,s,t.rule,t.type,this.ptr.fqn()+"."+i,t.id,t.options),a=new n.Extension(this,this.ptr,t.name,o);o.extension=a,this.ptr.addChild(a),s.addChild(o)},this);else if(!/\.?google\.protobuf\./.test(o.ref))throw Error("extended message "+o.ref+" is not defined")}o=null,s=null}t=null,this.ptr=this.ptr.parent}return this.resolved=!1,this.result=null,this},o["import"]=function(t,n){var i="/";if("string"==typeof n){if(e.Util.IS_NODE&&(n=li.resolve(n)),this.files[n]===!0)return this.reset();this.files[n]=!0}else if("object"==typeof n){var o=n.root;e.Util.IS_NODE&&(o=li.resolve(o)),(o.indexOf("\\")>=0||n.file.indexOf("\\")>=0)&&(i="\\");var s=o+i+n.file;if(this.files[s]===!0)return this.reset();this.files[s]=!0}if(t.imports&&t.imports.length>0){var a,f=!1;"object"==typeof n?(this.importRoot=n.root,f=!0,a=this.importRoot,n=n.file,(a.indexOf("\\")>=0||n.indexOf("\\")>=0)&&(i="\\")):"string"==typeof n?this.importRoot?a=this.importRoot:n.indexOf("/")>=0?(a=n.replace(/\/[^\/]*$/,""),""===a&&(a="/")):n.indexOf("\\")>=0?(a=n.replace(/\\[^\\]*$/,""),i="\\"):a=".":a=null;for(var u=0;u<t.imports.length;u++)if("string"==typeof t.imports[u]){if(!a)throw Error("cannot determine import root");var l=t.imports[u];if("google/protobuf/descriptor.proto"===l)continue;if(l=a+i+l,this.files[l]===!0)continue;/\.proto$/i.test(l)&&!e.DotProto&&(l=l.replace(/\.proto$/,".json"));var c=e.Util.fetch(l);if(null===c)throw Error("failed to import '"+l+"' in '"+n+"': file not found");/\.json$/i.test(l)?this["import"](JSON.parse(c+""),l):this["import"](e.DotProto.Parser.parse(c),l)}else n?/\.(\w+)$/.test(n)?this["import"](t.imports[u],n.replace(/^(.+)\.(\w+)$/,function(e,t,n){return t+"_import"+u+"."+n})):this["import"](t.imports[u],n+"_import"+u):this["import"](t.imports[u]);f&&(this.importRoot=null)}t["package"]&&this.define(t["package"]),t.syntax&&r(t);var h=this.ptr;return t.options&&Object.keys(t.options).forEach(function(e){h.options[e]=t.options[e]}),t.messages&&(this.create(t.messages),this.ptr=h),t.enums&&(this.create(t.enums),this.ptr=h),t.services&&(this.create(t.services),this.ptr=h),t["extends"]&&this.create(t["extends"]),this.reset()},o.resolveAll=function(){var r;if(null==this.ptr||"object"==typeof this.ptr.type)return this;if(this.ptr instanceof n.Namespace)this.ptr.children.forEach(function(e){this.ptr=e,this.resolveAll()},this);else if(this.ptr instanceof n.Message.Field){if(t.TYPE.test(this.ptr.type))this.ptr.type=e.TYPES[this.ptr.type];else{if(!t.TYPEREF.test(this.ptr.type))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(r=(this.ptr instanceof n.Message.ExtensionField?this.ptr.extension.parent:this.ptr.parent).resolve(this.ptr.type,!0),!r)throw Error("unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);if(this.ptr.resolvedType=r,r instanceof n.Enum){if(this.ptr.type=e.TYPES["enum"],"proto3"===this.ptr.syntax&&"proto3"!==r.syntax)throw Error("proto3 message cannot reference proto2 enum")}else{if(!(r instanceof n.Message))throw Error("illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.type=r.isGroup?e.TYPES.group:e.TYPES.message}}if(this.ptr.map){if(!t.TYPE.test(this.ptr.keyType))throw Error("illegal key type for map field in "+this.ptr.toString(!0)+": "+this.ptr.keyType);this.ptr.keyType=e.TYPES[this.ptr.keyType]}}else if(this.ptr instanceof e.Reflect.Service.Method){if(!(this.ptr instanceof e.Reflect.Service.RPCMethod))throw Error("illegal service type in "+this.ptr.toString(!0));if(r=this.ptr.parent.resolve(this.ptr.requestName,!0),!(r&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.requestName);if(this.ptr.resolvedRequestType=r,r=this.ptr.parent.resolve(this.ptr.responseName,!0),!(r&&r instanceof e.Reflect.Message))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=r}else if(!(this.ptr instanceof e.Reflect.Message.OneOf||this.ptr instanceof e.Reflect.Extension||this.ptr instanceof e.Reflect.Enum.Value))throw Error("illegal object in namespace: "+typeof this.ptr+": "+this.ptr);return this.reset()},o.build=function(e){if(this.reset(),this.resolved||(this.resolveAll(),this.resolved=!0,this.result=null),null===this.result&&(this.result=this.ns.build()),!e)return this.result;for(var t="string"==typeof e?e.split("."):e,n=this.result,r=0;r<t.length;r++){if(!n[t[r]]){n=null;break}n=n[t[r]]}return n},o.lookup=function(e,t){return e?this.ns.resolve(e,t):this.ns},o.toString=function(){return"Builder"},i.Message=function(){},i.Enum=function(){},i.Service=function(){},i}(n,n.Lang,n.Reflect),n.Map=function(e,t){function n(e){var t=0;return{next:function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}}var r=function(e,n){if(!e.map)throw Error("field is not a map");if(this.field=e,this.keyElem=new t.Element(e.keyType,null,!0,e.syntax),this.valueElem=new t.Element(e.type,e.resolvedType,!1,e.syntax),this.map={},Object.defineProperty(this,"size",{get:function(){return Object.keys(this.map).length}}),n)for(var r=Object.keys(n),i=0;i<r.length;i++){var o=this.keyElem.valueFromString(r[i]),s=this.valueElem.verifyValue(n[r[i]]);this.map[this.keyElem.valueToString(o)]={key:o,value:s}}},i=r.prototype;return i.clear=function(){this.map={}},i["delete"]=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e)),n=t in this.map;return delete this.map[t],n},i.entries=function(){for(var e,t=[],r=Object.keys(this.map),i=0;i<r.length;i++)t.push([(e=this.map[r[i]]).key,e.value]);return n(t)},i.keys=function(){for(var e=[],t=Object.keys(this.map),r=0;r<t.length;r++)e.push(this.map[t[r]].key);return n(e)},i.values=function(){for(var e=[],t=Object.keys(this.map),r=0;r<t.length;r++)e.push(this.map[t[r]].value);return n(e)},i.forEach=function(e,t){for(var n,r=Object.keys(this.map),i=0;i<r.length;i++)e.call(t,(n=this.map[r[i]]).value,n.key,this)},i.set=function(e,t){var n=this.keyElem.verifyValue(e),r=this.valueElem.verifyValue(t);return this.map[this.keyElem.valueToString(n)]={key:n,value:r},this},i.get=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));if(t in this.map)return this.map[t].value},i.has=function(e){var t=this.keyElem.valueToString(this.keyElem.verifyValue(e));return t in this.map},r}(n,n.Reflect),n.newBuilder=function(e){return e=e||{},"undefined"==typeof e.convertFieldsToCamelCase&&(e.convertFieldsToCamelCase=n.convertFieldsToCamelCase),"undefined"==typeof e.populateAccessors&&(e.populateAccessors=n.populateAccessors),new n.Builder(e)},n.loadJson=function(e,t,r){return("string"==typeof t||t&&"string"==typeof t.file&&"string"==typeof t.root)&&(r=t,t=null),t&&"object"==typeof t||(t=n.newBuilder()),"string"==typeof e&&(e=JSON.parse(e)),t["import"](e,r),t.resolveAll(),t},n.loadJsonFile=function(e,t,r){if(t&&"object"==typeof t?(r=t,t=null):t&&"function"==typeof t||(t=null),t)return n.Util.fetch("string"==typeof e?e:e.root+"/"+e.file,function(i){if(null===i)return void t(Error("Failed to fetch file"));try{t(null,n.loadJson(JSON.parse(i),r,e))}catch(o){t(o)}});var i=n.Util.fetch("object"==typeof e?e.root+"/"+e.file:e);return null===i?null:n.loadJson(JSON.parse(i),r,e)},n})}),gi=yi&&"object"==typeof yi&&"default"in yi?yi["default"]:yi,mi=t(function(e){e.exports=gi.newBuilder({})["import"]({"package":"push_server.messages",options:{objc_class_prefix:"AVIM"},messages:[{name:"JsonObjectMessage",fields:[{rule:"required",type:"string",name:"data",id:1}]},{name:"UnreadTuple",fields:[{rule:"required",type:"string",name:"cid",id:1},{rule:"required",type:"int32",name:"unread",id:2},{rule:"optional",type:"string",name:"mid",id:3},{rule:"optional",type:"int64",name:"timestamp",id:4}]},{name:"LogItem",fields:[{rule:"optional",type:"string",name:"from",id:1},{rule:"optional",type:"string",name:"data",id:2},{rule:"optional",type:"int64",name:"timestamp",id:3},{rule:"optional",type:"string",name:"msgId",id:4},{rule:"optional",type:"int64",name:"ackAt",id:5}]},{name:"LoginCommand",fields:[]},{name:"DataCommand",fields:[{rule:"repeated",type:"string",name:"ids",id:1},{rule:"repeated",type:"JsonObjectMessage",name:"msg",id:2}]},{name:"SessionCommand",fields:[{rule:"optional",type:"int64",name:"t",id:1},{rule:"optional",type:"string",name:"n",id:2},{rule:"optional",type:"string",name:"s",id:3},{rule:"optional",type:"string",name:"ua",id:4},{rule:"optional",type:"bool",name:"r",id:5},{rule:"optional",type:"string",name:"tag",id:6},{rule:"optional",type:"string",name:"deviceId",id:7},{rule:"repeated",type:"string",name:"sessionPeerIds",id:8},{rule:"repeated",type:"string",name:"onlineSessionPeerIds",id:9},{rule:"optional",type:"string",name:"st",id:10},{rule:"optional",type:"int32",name:"stTtl",id:11},{rule:"optional",type:"int32",name:"code",id:12},{rule:"optional",type:"string",name:"reason",id:13},{rule:"optional",type:"string",name:"deviceToken",id:14},{rule:"optional",type:"bool",name:"sp",id:15}]},{name:"ErrorCommand",fields:[{rule:"required",type:"int32",name:"code",id:1},{rule:"required",type:"string",name:"reason",id:2},{rule:"optional",type:"int32",name:"appCode",id:3},{rule:"optional",type:"string",name:"detail",id:4}]},{name:"DirectCommand",fields:[{rule:"optional",type:"string",name:"msg",id:1},{rule:"optional",type:"string",name:"uid",id:2},{rule:"optional",type:"string",name:"fromPeerId",id:3},{rule:"optional",type:"int64",name:"timestamp",id:4},{rule:"optional",type:"bool",name:"offline",id:5},{rule:"optional",type:"bool",name:"hasMore",id:6},{rule:"repeated",type:"string",name:"toPeerIds",id:7},{rule:"optional",type:"bool",name:"r",id:10},{rule:"optional",type:"string",name:"cid",id:11},{rule:"optional",type:"string",name:"id",id:12},{rule:"optional",type:"bool",name:"transient",id:13},{rule:"optional",type:"string",name:"dt",id:14},{rule:"optional",type:"string",name:"roomId",id:15}]},{name:"AckCommand",fields:[{rule:"optional",type:"int32",name:"code",id:1},{rule:"optional",type:"string",name:"reason",id:2},{rule:"optional",type:"string",name:"mid",id:3},{rule:"optional",type:"string",name:"cid",id:4},{rule:"optional",type:"int64",name:"t",id:5},{rule:"optional",type:"string",name:"uid",id:6},{rule:"optional",type:"int64",name:"fromts",id:7},{rule:"optional",type:"int64",name:"tots",id:8},{rule:"optional",type:"string",name:"type",id:9},{rule:"repeated",type:"string",name:"ids",id:10},{rule:"optional",type:"int32",name:"appCode",id:11}]},{name:"UnreadCommand",fields:[{rule:"repeated",type:"UnreadTuple",name:"convs",id:1}]},{name:"ConvCommand",fields:[{rule:"repeated",type:"string",name:"m",id:1},{rule:"optional",type:"bool",name:"transient",id:2},{rule:"optional",type:"bool",name:"unique",id:3},{rule:"optional",type:"string",name:"cid",id:4},{rule:"optional",type:"string",name:"cdate",id:5},{rule:"optional",type:"string",name:"initBy",id:6},{rule:"optional",type:"string",name:"sort",id:7},{rule:"optional",type:"int32",name:"limit",id:8},{rule:"optional",type:"int32",name:"skip",id:9},{rule:"optional",type:"int32",name:"flag",id:10},{rule:"optional",type:"int32",name:"count",id:11},{rule:"optional",type:"string",name:"udate",id:12},{rule:"optional",type:"int64",name:"t",id:13},{rule:"optional",type:"string",name:"n",id:14},{rule:"optional",type:"string",name:"s",id:15},{rule:"optional",type:"JsonObjectMessage",name:"results",id:100},{rule:"optional",type:"JsonObjectMessage",name:"where",id:101},{rule:"optional",type:"JsonObjectMessage",name:"attr",id:103}]},{name:"RoomCommand",fields:[{rule:"optional",type:"string",name:"roomId",id:1},{rule:"optional",type:"string",name:"s",id:2},{rule:"optional",type:"int64",name:"t",id:3},{rule:"optional",type:"string",name:"n",id:4},{rule:"optional",type:"bool",name:"transient",id:5},{rule:"repeated",type:"string",name:"roomPeerIds",id:6},{rule:"optional",type:"string",name:"byPeerId",id:7}]},{name:"LogsCommand",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"optional",type:"int32",name:"l",id:2},{rule:"optional",type:"int32",name:"limit",id:3},{rule:"optional",type:"int64",name:"t",id:4},{rule:"optional",type:"int64",name:"tt",id:5},{rule:"optional",type:"string",name:"tmid",id:6},{rule:"optional",type:"string",name:"mid",id:7},{rule:"optional",type:"string",name:"checksum",id:8},{rule:"optional",type:"bool",name:"stored",id:9},{rule:"repeated",type:"LogItem",name:"logs",id:105}]},{name:"RcpCommand",fields:[{rule:"optional",type:"string",name:"id",id:1},{rule:"optional",type:"string",name:"cid",id:2},{rule:"optional",type:"int64",name:"t",id:3}]},{name:"ReadTuple",fields:[{rule:"required",type:"string",name:"cid",id:1},{rule:"optional",type:"int64",name:"timestamp",id:2},{rule:"optional",type:"string",name:"mid",id:3}]},{name:"ReadCommand",fields:[{rule:"optional",type:"string",name:"cid",id:1},{rule:"repeated",type:"string",name:"cids",id:2},{rule:"repeated",type:"ReadTuple",name:"convs",id:3}]},{name:"PresenceCommand",fields:[{rule:"optional",type:"StatusType",name:"status",id:1},{rule:"repeated",type:"string",name:"sessionPeerIds",id:2}]},{name:"ReportCommand",fields:[{rule:"optional",type:"bool",name:"initiative",id:1},{rule:"optional",type:"string",name:"type",id:2},{rule:"optional",type:"string",name:"data",id:3}]},{name:"GenericCommand",fields:[{rule:"required",type:"CommandType",name:"cmd",id:1},{rule:"optional",type:"OpType",name:"op",id:2},{rule:"optional",type:"string",name:"appId",id:3},{rule:"optional",type:"string",name:"peerId",id:4},{rule:"optional",type:"int32",name:"i",id:5},{rule:"optional",type:"string",name:"installationId",id:6},{rule:"optional",type:"LoginCommand",name:"loginMessage",id:100},{rule:"optional",type:"DataCommand",name:"dataMessage",id:101},{rule:"optional",type:"SessionCommand",name:"sessionMessage",id:102},{rule:"optional",type:"ErrorCommand",name:"errorMessage",id:103},{rule:"optional",type:"DirectCommand",name:"directMessage",id:104},{rule:"optional",type:"AckCommand",name:"ackMessage",id:105},{rule:"optional",type:"UnreadCommand",name:"unreadMessage",id:106},{rule:"optional",type:"ReadCommand",name:"readMessage",id:107},{rule:"optional",type:"RcpCommand",name:"rcpMessage",id:108},{rule:"optional",type:"LogsCommand",name:"logsMessage",id:109},{rule:"optional",type:"ConvCommand",name:"convMessage",id:110},{rule:"optional",type:"RoomCommand",name:"roomMessage",id:111},{rule:"optional",type:"PresenceCommand",name:"presenceMessage",id:112},{rule:"optional",type:"ReportCommand",name:"reportMessage",id:113}]}],enums:[{name:"CommandType",values:[{name:"session",id:0},{name:"conv",id:1},{name:"direct",id:2},{name:"ack",id:3},{name:"rcp",id:4},{name:"unread",id:5},{name:"logs",id:6},{name:"error",id:7},{name:"login",id:8},{name:"data",id:9},{name:"room",id:10},{name:"read",id:11},{name:"presence",id:12},{name:"report",id:13},{name:"echo",id:14}]},{name:"OpType",values:[{name:"open",id:1},{name:"add",id:2},{name:"remove",id:3},{name:"close",id:4},{name:"opened",id:5},{name:"closed",id:6},{name:"query",id:7},{name:"query_result",id:8},{name:"conflict",id:9},{name:"added",id:10},{name:"removed",id:11},{name:"start",id:30},{name:"started",id:31},{name:"joined",id:32},{name:"members_joined",id:33},{name:"left",id:39},{name:"members_left",id:40},{name:"results",id:42},{name:"count",id:43},{name:"result",id:44},{name:"update",id:45},{name:"updated",id:46},{name:"mute",id:47},{name:"unmute",id:48},{name:"join",id:80},{name:"invite",id:81},{name:"leave",id:82},{name:"kick",id:83},{name:"reject",id:84},{name:"invited",id:85},{name:"kicked",id:86},{name:"upload",id:100},{name:"uploaded",id:101}]},{name:"StatusType",values:[{name:"on",id:1},{name:"off",id:2}]}]}).build()}),vi=mi&&"object"===("undefined"==typeof mi?"undefined":Sn(mi))&&"default"in mi?mi["default"]:mi,bi=vi.push_server.messages,wi=bi.JsonObjectMessage,Ei=(bi.UnreadTuple,bi.LogItem,bi.LoginCommand,bi.DataCommand,bi.SessionCommand),_i=(bi.ErrorCommand,bi.DirectCommand),Ti=bi.AckCommand,Si=(bi.UnreadCommand,bi.ConvCommand),Ii=(bi.RoomCommand,bi.LogsCommand),ji=(bi.RcpCommand,bi.ReadTuple),xi=bi.ReadCommand,Ai=(bi.PresenceCommand,bi.ReportCommand,bi.GenericCommand),Oi=bi.CommandType,Pi=bi.OpType,Mi=(bi.StatusType,kr("LC:Connection")),Ri=2e4,Ci=function(e){function t(n,r){var i=r.format,o=r.version;rn(this,t),Mi("initializing Connection");var s="lc."+i+"."+o,a=jn(this,e.call(this,n,s));return a._protocalFormat=i,a._commands={},a._serialId=0,a}return kn(t,e),t.prototype.send=function(t){var n=this,r=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],i=void 0;r&&(i=++this._serialId,t.i=i),Mi("↑",Jr(t),"sent");var o=void 0;if("protobase64"===this._protocalFormat?o=t.toBase64():t.toBuffer?o=t.toBuffer():t.toArrayBuffer&&(o=t.toArrayBuffer()),!o)throw new TypeError(t+" is not a GenericCommand");return e.prototype.send.call(this,o),r?new Zt(function(e,r){n._commands[i]={resolve:e,reject:r},setTimeout(function(){n._commands[i]&&(Mi("✗",Jr(t),"timeout"),r(new Error("Command Timeout.")),delete n._commands[i])},Ri)}):Zt.resolve()},t.prototype.handleMessage=function(e){var t=void 0;try{t=Ai.decode(e),Mi("↓",Jr(t),"received")}catch(n){console.warn("Decode message failed",e)}this.emit("allmessage",t);var r=t.i;r?this._commands[r]?(t.cmd===Oi.error?this._commands[r].reject(ui(t.errorMessage)):this._commands[r].resolve(t),delete this._commands[r]):console.warn("Unexpected command received with serialId ["+r+"],\n         which have timed out or never been requested."):t.cmd===Oi.error?this.emit("error",ui(t.errorMessage)):this.emit("message",t)},t.prototype.ping=function(){
return this.send(new Ai({cmd:"echo"}))["catch"](function(e){return console.warn("ping failed:",e)})},t}(ii),Li=t(function(e){e.exports=function(e){return function(t){return e.apply(null,t)}}}),Ni=Li&&"object"===("undefined"==typeof Li?"undefined":Sn(Li))&&"default"in Li?Li["default"]:Li,ki=t(function(e){function t(e){return"[object Array]"===v.call(e)}function n(e){return"[object ArrayBuffer]"===v.call(e)}function r(e){return"[object FormData]"===v.call(e)}function i(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function o(e){return"string"==typeof e}function s(e){return"number"==typeof e}function a(e){return"undefined"==typeof e}function f(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":Sn(e))}function u(e){return"[object Date]"===v.call(e)}function l(e){return"[object File]"===v.call(e)}function c(e){return"[object Blob]"===v.call(e)}function h(e){return"[object Function]"===v.call(e)}function d(e){return f(e)&&h(e.pipe)}function p(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function y(){return"undefined"!=typeof window&&"undefined"!=typeof document&&"function"==typeof document.createElement}function g(e,n){if(null!==e&&"undefined"!=typeof e)if("object"===("undefined"==typeof e?"undefined":Sn(e))||t(e)||(e=[e]),t(e))for(var r=0,i=e.length;i>r;r++)n.call(null,e[r],r,e);else for(var o in e)e.hasOwnProperty(o)&&n.call(null,e[o],o,e)}function m(){function e(e,n){"object"===Sn(t[n])&&"object"===("undefined"==typeof e?"undefined":Sn(e))?t[n]=m(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;r>n;n++)g(arguments[n],e);return t}var v=Object.prototype.toString;e.exports={isArray:t,isArrayBuffer:n,isFormData:r,isArrayBufferView:i,isString:o,isNumber:s,isObject:f,isUndefined:a,isDate:u,isFile:l,isBlob:c,isFunction:h,isStream:d,isStandardBrowserEnv:y,forEach:g,merge:m,trim:p}}),Fi=ki&&"object"===("undefined"==typeof ki?"undefined":Sn(ki))&&"default"in ki?ki["default"]:ki,Ui=t(function(e){var t=Fi;e.exports=function(e,n,r){return t.forEach(r,function(t){e=t(e,n)}),e}}),Yi=Ui&&"object"===("undefined"==typeof Ui?"undefined":Sn(Ui))&&"default"in Ui?Ui["default"]:Ui,Bi=t(function(e){e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}}),Vi=Bi&&"object"===("undefined"==typeof Bi?"undefined":Sn(Bi))&&"default"in Bi?Bi["default"]:Bi,Di=t(function(e){e.exports=function(e,t){return e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,"")}}),qi=Di&&"object"===("undefined"==typeof Di?"undefined":Sn(Di))&&"default"in Di?Di["default"]:Di,zi=t(function(e){e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}}),Wi=zi&&"object"===("undefined"==typeof zi?"undefined":Sn(zi))&&"default"in zi?zi["default"]:zi,$i=t(function(e){function t(){this.handlers=[]}var n=Fi;t.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},t.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},t.prototype.forEach=function(e){n.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=t}),Zi=$i&&"object"===("undefined"==typeof $i?"undefined":Sn($i))&&"default"in $i?$i["default"]:$i,Ji=t(function(e){var t=Fi;e.exports=t.isStandardBrowserEnv()?function(){return{write:function(e,n,r,i,o,s){var a=[];a.push(e+"="+encodeURIComponent(n)),t.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),t.isString(i)&&a.push("path="+i),t.isString(o)&&a.push("domain="+o),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()}),Gi=Ji&&"object"===("undefined"==typeof Ji?"undefined":Sn(Ji))&&"default"in Ji?Ji["default"]:Ji,Hi=t(function(e){e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(n):e(n)}}),Xi=Hi&&"object"===("undefined"==typeof Hi?"undefined":Sn(Hi))&&"default"in Hi?Hi["default"]:Hi,Ki=t(function(e){function t(){this.message="String contains an invalid character"}function n(e){for(var n,i,o=String(e),s="",a=0,f=r;o.charAt(0|a)||(f="=",a%1);s+=f.charAt(63&n>>8-a%1*8)){if(i=o.charCodeAt(a+=.75),i>255)throw new t;n=n<<8|i}return s}var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.code=5,t.prototype.name="InvalidCharacterError",e.exports=n}),Qi=Ki&&"object"===("undefined"==typeof Ki?"undefined":Sn(Ki))&&"default"in Ki?Ki["default"]:Ki,eo=t(function(e){var t=Fi;e.exports=t.isStandardBrowserEnv()?function(){function e(e){var t=e;return r&&(i.setAttribute("href",t),t=i.href),i.setAttribute("href",t),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}var n,r=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");return n=e(window.location.href),function(r){var i=t.isString(r)?e(r):r;return i.protocol===n.protocol&&i.host===n.host}}():function(){return function(){return!0}}()}),to=eo&&"object"===("undefined"==typeof eo?"undefined":Sn(eo))&&"default"in eo?eo["default"]:eo,no=t(function(e){var t=Fi;e.exports=function(e){var n,r,i,o={};return e?(t.forEach(e.split("\n"),function(e){i=e.indexOf(":"),n=t.trim(e.substr(0,i)).toLowerCase(),r=t.trim(e.substr(i+1)),n&&(o[n]=o[n]?o[n]+", "+r:r)}),o):o}}),ro=no&&"object"===("undefined"==typeof no?"undefined":Sn(no))&&"default"in no?no["default"]:no,io=t(function(e){function t(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var n=Fi;e.exports=function(e,r,i){if(!r)return e;var o;if(i)o=i(r);else{var s=[];n.forEach(r,function(e,r){null!==e&&"undefined"!=typeof e&&(n.isArray(e)&&(r+="[]"),n.isArray(e)||(e=[e]),n.forEach(e,function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=Bn(e)),s.push(t(r)+"="+t(e))}))}),o=s.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}}),oo=io&&"object"===("undefined"==typeof io?"undefined":Sn(io))&&"default"in io?io["default"]:io,so=t(function(e){var t=Fi,n=oo,r=ro,i=Yi,o=to,s="undefined"!=typeof window&&window.btoa||Qi,f=Xi;e.exports=function(e,u,l){var c=l.data,h=l.headers;t.isFormData(c)&&delete h["Content-Type"];var d=new XMLHttpRequest,p="onreadystatechange",y=!1;if("test"===a.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||o(l.url)||(d=new window.XDomainRequest,p="onload",y=!0),l.auth){var g=l.auth.username||"",m=l.auth.password||"";h.Authorization="Basic "+s(g+":"+m)}if(d.open(l.method.toUpperCase(),n(l.url,l.params,l.paramsSerializer),!0),d.timeout=l.timeout,d.onprogress=function(){},d.ontimeout=function(){},d[p]=function(){if(d&&(4===d.readyState||y)&&0!==d.status){var t="getAllResponseHeaders"in d?r(d.getAllResponseHeaders()):null,n=l.responseType&&"text"!==l.responseType?d.response:d.responseText,o={data:i(n,t,l.transformResponse),status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:t,config:l,request:d};f(e,u,o),d=null}},d.onerror=function(){u(new Error("Network Error")),d=null},d.ontimeout=function(){var e=new Error("timeout of "+l.timeout+"ms exceeded");e.timeout=l.timeout,e.code="ECONNABORTED",u(e),d=null},t.isStandardBrowserEnv()){var v=Gi,b=l.withCredentials||o(l.url)?v.read(l.xsrfCookieName):void 0;b&&(h[l.xsrfHeaderName]=b)}if("setRequestHeader"in d&&t.forEach(h,function(e,t){"undefined"==typeof c&&"content-type"===t.toLowerCase()?delete h[t]:d.setRequestHeader(t,e)}),l.withCredentials&&(d.withCredentials=!0),l.responseType)try{d.responseType=l.responseType}catch(w){if("json"!==d.responseType)throw w}l.progress&&("post"===l.method||"put"===l.method?d.upload.addEventListener("progress",l.progress):"get"===l.method&&d.addEventListener("progress",l.progress)),void 0===c&&(c=null),d.send(c)}}),ao=so&&"object"===("undefined"==typeof so?"undefined":Sn(so))&&"default"in so?so["default"]:so,fo=t(function(e){e.exports=function(e){return new Zt(function(t,n){try{var r;"function"==typeof e.adapter?r=e.adapter:"undefined"!=typeof XMLHttpRequest?r=ao:"undefined"!=typeof a&&(r=ao),"function"==typeof r&&r(t,n,e)}catch(i){n(i)}})}}),uo=fo&&"object"===("undefined"==typeof fo?"undefined":Sn(fo))&&"default"in fo?fo["default"]:fo,lo=t(function(e){var t=Fi,n=/^\)\]\}',?\n/,r={"Content-Type":"application/x-www-form-urlencoded"};e.exports={transformRequest:[function(e,n){return t.isFormData(e)||t.isArrayBuffer(e)||t.isStream(e)?e:t.isArrayBufferView(e)?e.buffer:!t.isObject(e)||t.isFile(e)||t.isBlob(e)?e:(t.isUndefined(n)||(t.forEach(n,function(e,t){"content-type"===t.toLowerCase()&&(n["Content-Type"]=e)}),t.isUndefined(n["Content-Type"])&&(n["Content-Type"]="application/json;charset=utf-8")),Bn(e))}],transformResponse:[function(e){if("string"==typeof e){e=e.replace(n,"");try{e=JSON.parse(e)}catch(t){}}return e}],headers:{common:{Accept:"application/json, text/plain, */*"},patch:t.merge(r),post:t.merge(r),put:t.merge(r)},timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&300>e}}}),co=lo&&"object"===("undefined"==typeof lo?"undefined":Sn(lo))&&"default"in lo?lo["default"]:lo,ho=t(function(e){function t(e){this.defaults=r.merge({},e),this.interceptors={request:new o,response:new o}}var n=co,r=Fi,i=uo,o=Zi,s=Wi,a=qi,f=Vi,u=Yi;t.prototype.request=function(e){"string"==typeof e&&(e=r.merge({url:arguments[0]},arguments[1])),e=r.merge(n,this.defaults,{method:"get"},e),e.baseURL&&!s(e.url)&&(e.url=a(e.baseURL,e.url)),e.withCredentials=e.withCredentials||this.defaults.withCredentials,e.data=u(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=[i,void 0],o=Zt.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)o=o.then(t.shift(),t.shift());return o};var l=new t(n),c=e.exports=f(t.prototype.request,l);c.defaults=l.defaults,c.interceptors=l.interceptors,c.create=function(e){return new t(e)},c.all=function(e){return Zt.all(e)},c.spread=Ni,r.forEach(["delete","get","head"],function(e){t.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))},c[e]=f(t.prototype[e],l)}),r.forEach(["post","put","patch"],function(e){t.prototype[e]=function(t,n,i){return this.request(r.merge(i||{},{method:e,url:t,data:n}))},c[e]=f(t.prototype[e],l)})}),po=ho&&"object"===("undefined"==typeof ho?"undefined":Sn(ho))&&"default"in ho?ho["default"]:ho,yo=t(function(e){e.exports=po}),go=yo&&"object"===("undefined"==typeof yo?"undefined":Sn(yo))&&"default"in yo?yo["default"]:yo,mo=t(function(e,t,n){var r;if(n.crypto&&crypto.getRandomValues){var i=new Uint8Array(16);r=function(){return crypto.getRandomValues(i),i}}if(!r){var o=new Array(16);r=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}e.exports=r}),vo=mo&&"object"==typeof mo&&"default"in mo?mo["default"]:mo,bo=t(function(e){function t(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>i&&(t[r+i++]=a[e])});16>i;)t[r+i++]=0;return t}function n(e,t){var n=t||0,r=s;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function r(e,t,r){var i=t&&r||0,o=t||[];e=e||{};var s=void 0!==e.clockseq?e.clockseq:c,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),f=void 0!==e.nsecs?e.nsecs:d+1,u=a-h+(f-d)/1e4;if(0>u&&void 0===e.clockseq&&(s=s+1&16383),(0>u||a>h)&&void 0===e.nsecs&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");h=a,d=f,c=s,a+=122192928e5;var p=(1e4*(268435455&a)+f)%4294967296;o[i++]=p>>>24&255,o[i++]=p>>>16&255,o[i++]=p>>>8&255,o[i++]=255&p;var y=a/4294967296*1e4&268435455;o[i++]=y>>>8&255,o[i++]=255&y,o[i++]=y>>>24&15|16,o[i++]=y>>>16&255,o[i++]=s>>>8|128,o[i++]=255&s;for(var g=e.node||l,m=0;6>m;m++)o[i+m]=g[m];return t?t:n(o)}function i(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var s=e.random||(e.rng||o)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;16>a;a++)t[i+a]=s[a];return t||n(s)}for(var o=vo,s=[],a={},f=0;256>f;f++)s[f]=(f+256).toString(16).substr(1),a[s[f]]=f;var u=o(),l=[1|u[0],u[1],u[2],u[3],u[4],u[5]],c=16383&(u[6]<<8|u[7]),h=0,d=0,p=i;p.v1=r,p.v4=i,p.parse=t,p.unparse=n,e.exports=p}),wo=bo&&"object"==typeof bo&&"default"in bo?bo["default"]:bo,Eo=function(e){function t(n){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=arguments[2],o=arguments[3];if(rn(this,t),void 0!==n&&"string"!=typeof n)throw new TypeError("Client id ["+n+"] is not a String");var s=jn(this,e.call(this));return tn(s,{id:n,_connection:i,options:r},o),s}return kn(t,e),t.prototype._dispatchMessage=function(e){this.emit("message",e)},t}(Hr),_o=t(function(e,t){function n(e){return e&&e.__esModule?e:{"default":e}}t.__esModule=!0;var r=gr,i=n(r);t["default"]=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,i["default"])(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()}),To=_o&&"object"==typeof _o&&"default"in _o?_o["default"]:_o,So=kr("LC:SignatureFactoryRunner"),Io=function(e,t){return Zt.resolve().then(function(){return So("call signatureFactory with "+t),e.apply(null,t)}).then(Ur(function(e){return So("sign result",e)}),function(e){throw e.message="sign error: "+e.message,So(e),e}).then(n)},jo=function(){function e(t){rn(this,e),tn(this,{content:t},{id:wo.v4(),cid:null,timestamp:new Date,from:void 0,needReceipt:!1,"transient":!1})}return e.prototype.setNeedReceipt=function(e){return this.needReceipt=e,this},e.prototype.setTransient=function(e){return this["transient"]=e,this},e.prototype.toJSON=function(){return this.content},e.validate=function(){return!0},e.parse=function(e,t){return t||new this(e)},e}(),xo=t(function(e){function t(e){var t=e&&e.constructor,r="function"==typeof t&&t.prototype||n;return e===r}var n=Object.prototype;e.exports=t}),Ao=xo&&"object"==typeof xo&&"default"in xo?xo["default"]:xo,Oo=t(function(e){function t(e,t){return t=null==t?n:t,!!t&&("number"==typeof e||r.test(e))&&e>-1&&e%1==0&&t>e}var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;e.exports=t}),Po=Oo&&"object"==typeof Oo&&"default"in Oo?Oo["default"]:Oo,Mo=t(function(e){function t(e){return"number"==typeof e&&e>-1&&e%1==0&&n>=e}var n=9007199254740991;e.exports=t}),Ro=Mo&&"object"==typeof Mo&&"default"in Mo?Mo["default"]:Mo,Co=t(function(e){function t(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}e.exports=t}),Lo=Co&&"object"==typeof Co&&"default"in Co?Co["default"]:Co,No=t(function(e){function t(e){var t=n(e)?s.call(e):"";return t==r||t==i}var n=Lo,r="[object Function]",i="[object GeneratorFunction]",o=Object.prototype,s=o.toString;e.exports=t}),ko=No&&"object"==typeof No&&"default"in No?No["default"]:No,Fo=t(function(e){function t(e){return function(t){return null==t?void 0:t[e]}}e.exports=t}),Uo=Fo&&"object"==typeof Fo&&"default"in Fo?Fo["default"]:Fo,Yo=t(function(e){var t=Uo,n=t("length");e.exports=n}),Bo=Yo&&"object"==typeof Yo&&"default"in Yo?Yo["default"]:Yo,Vo=t(function(e){function t(e){return null!=e&&i(n(e))&&!r(e)}var n=Bo,r=ko,i=Ro;e.exports=t}),Do=Vo&&"object"==typeof Vo&&"default"in Vo?Vo["default"]:Vo,qo=t(function(e){var t=Array.isArray;e.exports=t}),zo=qo&&"object"==typeof qo&&"default"in qo?qo["default"]:qo,Wo=t(function(e){function t(e){return"string"==typeof e||!n(e)&&r(e)&&s.call(e)==i}var n=zo,r=Sr,i="[object String]",o=Object.prototype,s=o.toString;e.exports=t}),$o=Wo&&"object"==typeof Wo&&"default"in Wo?Wo["default"]:Wo,Zo=t(function(e){function t(e){return r(e)&&n(e)}var n=Do,r=Sr;e.exports=t}),Jo=Zo&&"object"==typeof Zo&&"default"in Zo?Zo["default"]:Zo,Go=t(function(e){function t(e){return n(e)&&o.call(e,"callee")&&(!a.call(e,"callee")||s.call(e)==r)}var n=Jo,r="[object Arguments]",i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=i.propertyIsEnumerable;e.exports=t}),Ho=Go&&"object"==typeof Go&&"default"in Go?Go["default"]:Go,Xo=t(function(e){function t(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}e.exports=t}),Ko=Xo&&"object"==typeof Xo&&"default"in Xo?Xo["default"]:Xo,Qo=t(function(e){function t(e){var t=e?e.length:void 0;return o(t)&&(i(e)||s(e)||r(e))?n(t,String):null}var n=Ko,r=Ho,i=zo,o=Ro,s=$o;e.exports=t}),es=Qo&&"object"==typeof Qo&&"default"in Qo?Qo["default"]:Qo,ts=t(function(e){function t(e){return n(Object(e))}var n=Object.keys;e.exports=t}),ns=ts&&"object"==typeof ts&&"default"in ts?ts["default"]:ts,rs=t(function(e){function t(e,t){return i.call(e,t)||"object"==typeof e&&t in e&&null===n(e)}var n=Ar,r=Object.prototype,i=r.hasOwnProperty;e.exports=t}),is=rs&&"object"==typeof rs&&"default"in rs?rs["default"]:rs,os=t(function(e){function t(e){var t=a(e);if(!t&&!o(e))return r(e);var f=i(e),u=!!f,l=f||[],c=l.length;for(var h in e)!n(e,h)||u&&("length"==h||s(h,c))||t&&"constructor"==h||l.push(h);return l}var n=is,r=ns,i=es,o=Do,s=Po,a=Ao;e.exports=t}),ss=os&&"object"==typeof os&&"default"in os?os["default"]:os,as=t(function(e){function t(e){return e&&e.Object===Object?e:null}e.exports=t}),fs=as&&"object"==typeof as&&"default"in as?as["default"]:as,us=t(function(e,t,n){var r=fs,i={"function":!0,object:!0},o=i[typeof t]&&t&&!t.nodeType?t:void 0,a=i[typeof e]&&e&&!e.nodeType?e:void 0,f=r(o&&a&&"object"==typeof n&&n),u=r(i[typeof self]&&self),l=r(i[typeof window]&&window),c=r(i[typeof s]&&s),h=f||l!==(c&&c.window)&&l||u||c||Function("return this")();e.exports=h}),ls=us&&"object"==typeof us&&"default"in us?us["default"]:us,cs=t(function(e){function t(e){return function(){return e}}e.exports=t}),hs=cs&&"object"==typeof cs&&"default"in cs?cs["default"]:cs,ds=t(function(e,t){var n=hs,r=ls,i={"function":!0,object:!0},o=i[typeof t]&&t&&!t.nodeType?t:void 0,s=i[typeof e]&&e&&!e.nodeType?e:void 0,a=s&&s.exports===o?o:void 0,f=a?r.Buffer:void 0,u=f?function(e){return e instanceof f}:n(!1);e.exports=u}),ps=ds&&"object"==typeof ds&&"default"in ds?ds["default"]:ds,ys=t(function(e){function t(e){if(null!=e){try{return n.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var n=Function.prototype.toString;e.exports=t}),gs=ys&&"object"==typeof ys&&"default"in ys?ys["default"]:ys,ms=t(function(e){function t(e){if(!i(e))return!1;var t=n(e)||r(e)?c:a;return t.test(o(e))}var n=ko,r=jr,i=Lo,o=gs,s=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,f=Object.prototype,u=Function.prototype.toString,l=f.hasOwnProperty,c=RegExp("^"+u.call(l).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=t}),vs=ms&&"object"==typeof ms&&"default"in ms?ms["default"]:ms,bs=t(function(e){function t(e,t){var r=e[t];return n(r)?r:void 0}var n=vs;e.exports=t}),ws=bs&&"object"==typeof bs&&"default"in bs?bs["default"]:bs,Es=t(function(e){var t=ws,n=ls,r=t(n,"WeakMap");e.exports=r}),_s=Es&&"object"==typeof Es&&"default"in Es?Es["default"]:Es,Ts=t(function(e){var t=ws,n=ls,r=t(n,"Set");e.exports=r}),Ss=Ts&&"object"==typeof Ts&&"default"in Ts?Ts["default"]:Ts,Is=t(function(e){var t=ws,n=ls,r=t(n,"Promise");e.exports=r}),js=Is&&"object"==typeof Is&&"default"in Is?Is["default"]:Is,xs=t(function(e){var t=ws,n=ls,r=t(n,"Map");e.exports=r}),As=xs&&"object"==typeof xs&&"default"in xs?xs["default"]:xs,Os=t(function(e){var t=ws,n=ls,r=t(n,"DataView");e.exports=r}),Ps=Os&&"object"==typeof Os&&"default"in Os?Os["default"]:Os,Ms=t(function(e){function t(e){return y.call(e)}var n=Ps,r=As,i=js,o=Ss,s=_s,a=gs,f="[object Map]",u="[object Object]",l="[object Promise]",c="[object Set]",h="[object WeakMap]",d="[object DataView]",p=Object.prototype,y=p.toString,g=a(n),m=a(r),v=a(i),b=a(o),w=a(s);(n&&t(new n(new ArrayBuffer(1)))!=d||r&&t(new r)!=f||i&&t(i.resolve())!=l||o&&t(new o)!=c||s&&t(new s)!=h)&&(t=function(e){var t=y.call(e),n=t==u?e.constructor:void 0,r=n?a(n):void 0;if(r)switch(r){case g:return d;case m:return f;case v:return l;case b:return c;case w:return h}return t}),e.exports=t}),Rs=Ms&&"object"==typeof Ms&&"default"in Ms?Ms["default"]:Ms,Cs=t(function(e){function t(e){if(o(e)&&(i(e)||u(e)||a(e.splice)||r(e)||s(e)))return!e.length;if(f(e)){var t=n(e);if(t==c||t==h)return!e.size}for(var d in e)if(p.call(e,d))return!1;return!(g&&l(e).length)}var n=Rs,r=Ho,i=zo,o=Do,s=ps,a=ko,f=Sr,u=$o,l=ss,c="[object Map]",h="[object Set]",d=Object.prototype,p=d.hasOwnProperty,y=d.propertyIsEnumerable,g=!y.call({valueOf:1},"valueOf");e.exports=t}),Ls=Cs&&"object"==typeof Cs&&"default"in Cs?Cs["default"]:Cs,Ns=kr("LC:Conversation"),ks=function(e){function t(n,r){rn(this,t);var i=jn(this,e.call(this));if(tn(i,{mutedMembers:[],members:[],_attributes:{},"transient":!1,muted:!1,unreadMessagesCount:0},Dr({attributes:"_attributes",name:"_name"},n)),i.members=er(new hr(i.members)),!(r instanceof Xs))throw new TypeError("Conversation must be initialized with a client");return i._client=r,["kicked","membersjoined","membersleft","message"].forEach(function(e){return i.on(e,function(t){return i._debug(e+" event emitted.",t)})}),i}return kn(t,e),t.prototype.setAttributes=function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];if(this._debug("set attributes: value="+Bn(e)+", assign="+t),!Pr(e))throw new TypeError("attributes must be a plain object");return t?this._pendingAttributes=tn({},this.attributes,e):this._pendingAttributes=e,this},t.prototype.setAttribute=function(e,t){return"undefined"==typeof this._pendingAttributes&&(this._pendingAttributes={}),this._pendingAttributes[e]=t,this},t.prototype.setName=function(e){return this._debug("set name: "+e),this._pendingName=e,this},t.prototype._debug=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];Ns.apply(void 0,t.concat(["["+this.id+"]"]))},t.prototype._send=function(e){var t;null===e.cmd&&(e.cmd="conv"),"conv"===e.cmd&&null===e.convMessage&&(e.convMessage=new Si),e.convMessage&&null===e.convMessage.cid&&(e.convMessage.cid=this.id);for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;n>i;i++)r[i-1]=arguments[i];return(t=this._client)._send.apply(t,[e].concat(r))},t.prototype.save=function(){var e=this;this._debug("save");var t={};if("undefined"!=typeof this._pendingAttributes&&(t.attr=this._pendingAttributes),"undefined"!=typeof this._pendingName&&(t.name=this._pendingName),Ls(t))return this._debug("nothing touched, resolve with self"),Zt.resolve(this);this._debug("attr: "+Bn(t));var n=new Si({attr:new wi({data:Bn(t)})});return this._send(new Ai({op:"update",convMessage:n})).then(function(t){return e.updatedAt=t.convMessage.udate,"undefined"!=typeof e._pendingAttributes&&(e._attributes=e._pendingAttributes,delete e._pendingAttributes),"undefined"!=typeof e._pendingName&&(e._name=e._pendingName,delete e._pendingName),e})},t.prototype.fetch=function(){var e=this;return this._client.getQuery().equalTo("objectId",this.id).find().then(function(){return e})},t.prototype.mute=function(){var e=this;return this._debug("mute"),this._send(new Ai({op:"mute"})).then(function(){return e["transient"]||(e.muted=!0,e.mutedMembers=qr(e.mutedMembers,[e._client.id])),e})},t.prototype.unmute=function(){var e=this;return this._debug("unmute"),this._send(new Ai({op:"unmute"})).then(function(){return e["transient"]||(e.muted=!1,e.mutedMembers=zr(e.mutedMembers,[e._client.id])),e})},t.prototype.count=function(){return this._debug("unmute"),this._send(new Ai({op:"count"})).then(function(e){return e.convMessage.count})},t.prototype.add=function(e){var t=this;this._debug("add",e),"string"==typeof e&&(e=[e]);var n=new Si({m:e});return Zt.resolve(new Ai({op:"add",convMessage:n})).then(function(n){if(t._client.options.conversationSignatureFactory){var r=[t.id,t._client.id,e.sort(),"add"];return Io(t._client.options.conversationSignatureFactory,r).then(function(e){return tn(n.convMessage,Dr({signature:"s",timestamp:"t",nonce:"n"},e)),n})}return n}).then(this._send.bind(this)).then(function(){return t["transient"]||(t.members=qr(t.members,e)),t})},t.prototype.remove=function(e){var t=this;this._debug("remove",e),"string"==typeof e&&(e=[e]);var n=new Si({m:e});return Zt.resolve(new Ai({op:"remove",convMessage:n})).then(function(n){if(t._client.options.conversationSignatureFactory){var r=[t.id,t._client.id,e.sort(),"remove"];return Io(t._client.options.conversationSignatureFactory,r).then(function(e){return tn(n.convMessage,Dr({signature:"s",timestamp:"t",nonce:"n"},e)),n})}return n}).then(this._send.bind(this)).then(function(){return t["transient"]||(t.members=zr(t.members,e)),t})},t.prototype.join=function(){return this._debug("join"),this.add(this._client.id)},t.prototype.quit=function(){return this._debug("quit"),this.remove(this._client.id)},t.prototype.send=function(e){var t=this;if(this._debug(e,"send"),!(e instanceof jo))throw new TypeError(e+" is not a Message");tn(e,{cid:this.id,from:this._client.id});var n=e.toJSON();"string"!=typeof n&&(n=Bn(n));var r=this._send(new Ai({cmd:"direct",directMessage:new _i({msg:n,cid:this.id,r:e.needReceipt,"transient":e["transient"],dt:e.id})}),!e["transient"]);return e["transient"]||(r=r.then(function(n){var r=n.ackMessage,i=r.uid,o=r.t,s=r.code,a=r.reason,f=r.appCode;if(null!==s)throw ui({code:s,reason:a,appCode:f});return tn(e,{id:i,timestamp:new Date(o.toNumber())}),t.lastMessage=e,t.lastMessageAt=e.timestamp,e})),r},t.prototype.queryMessages=function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this._debug("query messages",t),t.beforeMessageId&&!t.beforeTime)throw new Error("query option beforeMessageId must be used with option beforeTime");if(t.afterMessageId&&!t.afterTime)throw new Error("query option afterMessageId must be used with option afterTime");var n=Dr({beforeTime:"t",beforeMessageId:"mid",afterTime:"tt",afterMessageId:"tmid",limit:"l"},t);return n.t instanceof Date&&(n.t=n.t.getTime()),n.tt instanceof Date&&(n.tt=n.tt.getTime()),this._send(new Ai({cmd:"logs",logsMessage:new Ii(tn(n,{cid:this.id}))})).then(function(t){return t.logsMessage.logs.map(function(t){var n={id:t.msgId,cid:e.id,timestamp:new Date(t.timestamp.toNumber()),from:t.from},r=e._client._messageParser.parse(t.data);return tn(r,n),r})})},t.prototype.createMessagesIterator=function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.beforeTime,r=t.beforeMessageId,i=t.limit,o=void 0;return{next:function(){return o=void 0===o?e.queryMessages({limit:i,beforeTime:n,beforeMessageId:r}):o.then(function(t){return 0===t.length||t.length<i?[]:e.queryMessages({beforeTime:t[0].timestamp,beforeMessageId:t[0].id,limit:i})}),o.then(function(e){return{value:e,done:0===e.length||e.length<i}})}}},t.prototype.markAsRead=function(){var e=this;return this._client.markAllAsRead([this]).then(function(){return e})},To(t,[{key:"createdAt",set:function(e){this._createdAt=Vr(e)},get:function(){return this._createdAt}},{key:"updatedAt",set:function(e){this._updatedAt=Vr(e)},get:function(){return this._updatedAt}},{key:"lastMessageAt",set:function(e){this._lastMessageAt=Vr(e)},get:function(){return this._lastMessageAt}},{key:"attributes",get:function(){return"undefined"!=typeof this._pendingAttributes?this._pendingAttributes:this._attributes},set:function(e){this.setAttributes(e)}},{key:"name",get:function(){return"undefined"!=typeof this._pendingName?this._pendingName:this._name},set:function(e){this.setName(e)}}]),t}(Hr),Fs=kr("LC:ConversationQuery"),Us=function(){function e(t){rn(this,e),this._client=t,this._where={},this._extraOptions={}}return e._encode=function(e){return e instanceof Date?{__type:"Date",iso:e.toJSON()}:e instanceof RegExp?e.source:e},e._quote=function(e){return"\\Q"+e.replace("\\E","\\E\\\\E\\Q")+"\\E"},e._calculateFlag=function(e){return["withLastMessages","compact"].reduce(function(t,n){return(t<<1)+Boolean(e[n])},0)},e.prototype._addCondition=function(e,t,n){return this._where[e]||(this._where[e]={}),this._where[e][t]=this.constructor._encode(n),this},e.prototype.toJSON=function(){var e={where:this._where,flag:this.constructor._calculateFlag(this._extraOptions)};return"undefined"!=typeof this._skip&&(e.skip=this._skip),"undefined"!=typeof this._limit&&(e.limit=this._limit),Fs(e),e},e.prototype.containsMembers=function(e){return this.containsAll("m",e)},e.prototype.withMembers=function(e,t){var n=new hr(e);return t&&n.add(this._client.id),this.sizeEqualTo("m",n.size),this.containsMembers(er(n))},e.prototype.equalTo=function(e,t){return this._where[e]=this.constructor._encode(t),this},e.prototype.lessThan=function(e,t){return this._addCondition(e,"$lt",t)},e.prototype.lessThanOrEqualTo=function(e,t){return this._addCondition(e,"$lte",t)},e.prototype.greaterThan=function(e,t){return this._addCondition(e,"$gt",t)},e.prototype.greaterThanOrEqualTo=function(e,t){return this._addCondition(e,"$gte",t)},e.prototype.notEqualTo=function(e,t){return this._addCondition(e,"$ne",t)},e.prototype.containedIn=function(e,t){return this._addCondition(e,"$in",t)},e.prototype.notContainsIn=function(e,t){return this._addCondition(e,"$nin",t)},e.prototype.containsAll=function(e,t){return this._addCondition(e,"$all",t)},e.prototype.contains=function(t,n){return this._addCondition(t,"$regex",e._quote(n))},e.prototype.startsWith=function(t,n){return this._addCondition(t,"$regex","^"+e._quote(n))},e.prototype.endsWith=function(t,n){return this._addCondition(t,"$regex",e._quote(n)+"$")},e.prototype.matches=function(e,t){this._addCondition(e,"$regex",t);var n="";return t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),n&&n.length&&this._addCondition(e,"$options",n),this},e.prototype.sizeEqualTo=function(e,t){return this._addCondition(e,"$size",t)},e.prototype.limit=function(e){return this._limit=e,this},e.prototype.skip=function(e){return this._skip=e,this},e.prototype.ascending=function(e){return this._order=e,this},e.prototype.addAscending=function(e){return this._order?this._order+=","+e:this._order=e,this},e.prototype.descending=function(e){return this._order="-"+e,this},e.prototype.addDescending=function(e){return this._order?this._order+=",-"+e:this._order="-"+e,e},e.prototype.withLastMessages=function(e){return this._extraOptions.withLastMessages=e,this},e.prototype.compact=function(e){return this._extraOptions.compact=e,this},e.prototype.find=function(){return this._client._executeQuery(this)},e}(),Ys=t(function(e){function t(e){return"symbol"==typeof e||n(e)&&o.call(e)==r}var n=Sr,r="[object Symbol]",i=Object.prototype,o=i.toString;e.exports=t}),Bs=Ys&&"object"==typeof Ys&&"default"in Ys?Ys["default"]:Ys,Vs=t(function(e){function t(e){if("number"==typeof e)return e;if(i(e))return o;if(r(e)){var t=n(e.valueOf)?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var c=f.test(e);return c||u.test(e)?l(e.slice(2),c?2:8):a.test(e)?o:+e}var n=ko,r=Lo,i=Bs,o=NaN,s=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,u=/^0o[0-7]+$/i,l=parseInt;e.exports=t}),Ds=Vs&&"object"==typeof Vs&&"default"in Vs?Vs["default"]:Vs,qs=t(function(e){var t=Date.now;e.exports=t}),zs=qs&&"object"==typeof qs&&"default"in qs?qs["default"]:qs,Ws=t(function(e){function t(e,t,f){function u(t){var n=v,r=b;return v=b=void 0,S=t,E=e.apply(r,n)}function l(e){return S=e,_=setTimeout(d,t),I?u(e):E}function c(e){var n=e-T,r=e-S,i=t-n;return j?a(i,w-r):i}function h(e){
var n=e-T,r=e-S;return!T||n>=t||0>n||j&&r>=w}function d(){var e=r();return h(e)?p(e):void(_=setTimeout(d,c(e)))}function p(e){return clearTimeout(_),_=void 0,x&&v?u(e):(v=b=void 0,E)}function y(){void 0!==_&&clearTimeout(_),T=S=0,v=b=_=void 0}function g(){return void 0===_?E:p(r())}function m(){var e=r(),n=h(e);if(v=arguments,b=this,T=e,n){if(void 0===_)return l(T);if(j)return clearTimeout(_),_=setTimeout(d,t),u(T)}return void 0===_&&(_=setTimeout(d,t)),E}var v,b,w,E,_,T=0,S=0,I=!1,j=!1,x=!0;if("function"!=typeof e)throw new TypeError(o);return t=i(t)||0,n(f)&&(I=!!f.leading,j="maxWait"in f,w=j?s(i(f.maxWait)||0,t):w,x="trailing"in f?!!f.trailing:x),m.cancel=y,m.flush=g,m}var n=Lo,r=zs,i=Ds,o="Expected a function",s=Math.max,a=Math.min;e.exports=t}),$s=Ws&&"object"==typeof Ws&&"default"in Ws?Ws["default"]:Ws,Zs=t(function(e){function t(e,t,o){var s=!0,a=!0;if("function"!=typeof e)throw new TypeError(i);return r(o)&&(s="leading"in o?!!o.leading:s,a="trailing"in o?!!o.trailing:a),n(e,t,{leading:s,maxWait:t,trailing:a})}var n=$s,r=Lo,i="Expected a function";e.exports=t}),Js=Zs&&"object"==typeof Zs&&"default"in Zs?Zs["default"]:Zs,Gs="3.0.0-beta.3",Hs=kr("LC:IMClient"),Xs=function(e){function t(){rn(this,t);for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];var o=jn(this,e.call.apply(e,[this].concat(r)));if(!o._messageParser)throw new Error("IMClient must be initialized with a MessageParser");return o._conversationCache=new Br("client:"+o.id),o._ackMessageBuffer={},["invited","kicked","membersjoined","membersleft","message","unreadmessages","close","conflict","unhandledmessage"].forEach(function(e){return o.on(e,function(t){return o._debug(e+" event emitted.",t)})}),o}return kn(t,e),t.prototype._debug=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];Hs.apply(void 0,t.concat(["["+this.id+"]"]))},t.prototype._dispatchMessage=function(e){switch(this._debug(Jr(e),"received"),e.cmd){case Oi.conv:return this._dispatchConvMessage(e);case Oi.direct:return this._dispatchDirectMessage(e);case Oi.session:return this._dispatchSessionMessage(e);case Oi.unread:return this._dispatchUnreadMessage(e);default:return this.emit("unhandledmessage",e),Zt.resolve()}},t.prototype._dispatchSessionMessage=function(e){var t=e.sessionMessage,n=t.code,r=t.reason;switch(e.op){case Pi.closed:return n===fi.code?this.emit("conflict",{reason:r}):this.emit("close",{code:n,reason:r});default:return this.emit("unhandledmessage",e),Zt.reject(new Error("Unrecognized session command"))}},t.prototype._dispatchUnreadMessage=function(e){var t=this,n=e.unreadMessage.convs;n.forEach(function(e){return t.getConversation(e.cid).then(function(n){var r=void 0;e.timestamp&&(r=new Date(e.timestamp.toNumber())),n.unreadMessagesCount=e.unread,t.emit("unreadmessages",{count:e.unread,lastMessageId:e.mid,lastMessageTimestamp:r},n)})})},t.prototype._dispatchConvMessage=function(e){var t=this,n=e.convMessage,r=e.convMessage,i=r.initBy,o=r.m;switch(e.op){case Pi.joined:return this.getConversation(n.cid).then(function(e){e["transient"]||(e.members=qr(e.members,[t.id]));var n={invitedBy:i};t.emit("invited",n,e),e.emit("invited",n)});case Pi.left:return this.getConversation(n.cid).then(function(e){e["transient"]||(e.members=zr(e.members,[t.id]));var n={kickedBy:i};t.emit("kicked",n,e),e.emit("kicked",n)});case Pi.members_joined:return this.getConversation(n.cid).then(function(e){e["transient"]||(e.members=qr(e.members,n.m));var r={invitedBy:i,members:o};t.emit("membersjoined",r,e),e.emit("membersjoined",r)});case Pi.members_left:return this.getConversation(n.cid).then(function(e){e["transient"]||(e.members=zr(e.members,n.m));var r={kickedBy:i,members:o};t.emit("membersleft",r,e),e.emit("membersleft",r)});default:return this.emit("unhandledmessage",e),Zt.reject(new Error("Unrecognized conversation command"))}},t.prototype._dispatchDirectMessage=function(e){var t=this,n=e.directMessage,r=e.directMessage,i=r.id,o=r.cid,s=r.fromPeerId,a=r.timestamp,f=r["transient"];return this.getConversation(n.cid).then(function(e){var r={id:i,cid:o,timestamp:new Date(a.toNumber()),from:s,"transient":f},u=t._messageParser.parse(n.msg);tn(u,r),e.lastMessage=u,e.lastMessageAt=u.timestamp,e.unreadMessagesCount++,t.emit("message",u,e),e.emit("message",u),f||e["transient"]||t._sendAck(u)})},t.prototype._sendAck=function(e){this._debug("send ack for",e);var t=e.cid;return t?(this._ackMessageBuffer[t]||(this._ackMessageBuffer[t]=[]),this._ackMessageBuffer[t].push(e),this._doSendAckThrottled||(this._doSendAckThrottled=Js(this._doSendAck.bind(this),1e3)),this._doSendAckThrottled()):Zt.reject(new Error("missing cid"))},t.prototype._doSendAck=function(){var e=this;return this._connection.is("connected")?(Hs("do send ack",this._ackMessageBuffer),Zt.all(_r(this._ackMessageBuffer).map(function(t){var n=e._ackMessageBuffer[t],r=n.map(function(e){return e.timestamp}),i=new Ai({cmd:"ack",ackMessage:new Ti({cid:t,fromts:Math.min.apply(null,r),tots:Math.max.apply(null,r)})});return e._send(i,!1).then(function(){return delete e._ackMessageBuffer[t]})["catch"](function(e){return console.warn("send ack failed:",e)})}))):Zt.resolve()},t.prototype._send=function(e){var t,n=e;this.id&&(n.peerId=this.id);for(var r=arguments.length,i=Array(r>1?r-1:0),o=1;r>o;o++)i[o-1]=arguments[o];return(t=this._connection).send.apply(t,[n].concat(i))},t.prototype._open=function(e,t,n){var r=this,i=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];return this._debug("open session"),Zt.resolve(new Ai({cmd:"session",op:"open",appId:e,sessionMessage:new Ei({ua:"js/"+Gs,r:i,tag:t,deviceId:n})})).then(function(e){return r.options.signatureFactory?Io(r.options.signatureFactory,[r.id]).then(function(t){return tn(e.sessionMessage,Dr({signature:"s",timestamp:"t",nonce:"n"},t)),e}):e}).then(this._send.bind(this)).then(function(e){var t=e.peerId;return t?void(r.id=t):void console.warn("Unexpected session opened without peerId.")})},t.prototype.close=function(){var e=this;this._debug("close session");var t=new Ai({cmd:"session",op:"close"});return this._send(t).then(function(){e.emit("close",{code:0})})},t.prototype.ping=function(e){if(this._debug("ping"),!(e instanceof Array))throw new TypeError("clientIds "+e+" is not an Array");if(!e.length)return Zt.resolve([]);var t=new Ai({cmd:"session",op:"query",sessionMessage:new Ei({sessionPeerIds:e})});return this._send(t).then(function(e){return e.sessionMessage.onlineSessionPeerIds})},t.prototype.getConversation=function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];if("string"!=typeof e)throw new TypeError(e+" is not a String");if(!t){var n=this._conversationCache.get(e);if(n)return Zt.resolve(n)}return this.getQuery().equalTo("objectId",e).find().then(function(e){return e[0]||null})},t.prototype.getQuery=function(){return new Us(this)},t.prototype._executeQuery=function(e){var t=this,n=e.toJSON();n.where=new wi({data:Bn(n.where)});var r=new Ai({cmd:"conv",op:"query",convMessage:new Si(n)});return this._send(r).then(function(e){try{return JSON.parse(e.convMessage.results.data)}catch(t){var n=Bn(Jr(e));throw new Error("Parse query result failed: "+t.message+". Command: "+n)}}).then(function(e){return e.map(t._parseConversationFromRawData.bind(t))}).then(function(e){return e.map(function(e){var n=t._conversationCache.get(e.id);return n?(t._debug("update cached conversation"),["_name","creator","createdAt","updatedAt","lastMessageAt","lastMessage","mutedMembers","members","_attributes","transient","muted"].forEach(function(t){var r=e[t];null!==r&&(n[t]=r)}),delete n._pendingAttributes,delete n._pendingName):(n=e,t._debug("no match, set cache"),t._conversationCache.set(e.id,e)),n})})},t.prototype._parseConversationFromRawData=function(e){var t=Dr({objectId:"id",lm:"lastMessageAt",msg:"lastMessage",m:"members",attr:"attributes",tr:"transient",c:"creator",mu:"mutedMembers"},e);return t.lastMessage&&(t.lastMessage=this._messageParser.parse(t.lastMessage)),new ks(t,this)},t.prototype.createConversation=function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n={},r=t.members,i=t.name,o=t.attributes,s=t["transient"],a=t.unique;if(!s&&!Array.isArray(r))throw new TypeError("conversation members "+r+" is not an array");if(r=new hr(r),r.add(this.id),r=er(r).sort(),i){if("string"!=typeof i)throw new TypeError("conversation name "+i+" is not a string");n.name=i}o&&(n.attr=o),n=new wi({data:Bn(n)});var f={m:r,attr:n,"transient":s,unique:a};return Zt.resolve(new Ai({cmd:"conv",op:"start",convMessage:new Si(f)})).then(function(t){if(e.options.conversationSignatureFactory){var n=[null,e.id,r,"create"];return Io(e.options.conversationSignatureFactory,n).then(function(e){return tn(t.convMessage,Dr({signature:"s",timestamp:"t",nonce:"n"},e)),t})}return t}).then(this._send.bind(this)).then(function(n){return new ks(tn({},t,{id:n.convMessage.cid,createdAt:n.convMessage.cdate,updatedAt:n.convMessage.cdate,lastMessageAt:null,creator:e.id,members:s?[]:r}),e)}).then(Ur(function(t){return e._conversationCache.set(t.id,t)}))},t.prototype.markAllAsRead=function(e){if(!Array.isArray(e))throw new TypeError(e+" is not an Array");var t=e.map(function(e){if(!(e instanceof ks))throw new TypeError(e+" is not a Conversation");return e.id});return this._debug("mark ["+t+"] as read"),e.length?this._send(new Ai({cmd:"read",readMessage:new xi({convs:e.map(function(e){return new ji({cid:e.id,timestamp:(e.lastMessageAt||new Date).getTime()})})})}),!1).then(function(){return e.forEach(function(e){return e.unreadMessagesCount=0}),e}):Zt.resolve([])},t}(Eo),Ks=t(function(e){var t=oe,n=yt;e.exports=u.getIterator=function(e){var r=n(e);if("function"!=typeof r)throw TypeError(e+" is not iterable!");return t(r.call(e))}}),Qs=Ks&&"object"==typeof Ks&&"default"in Ks?Ks["default"]:Ks,ea=t(function(e){e.exports=Qs}),ta=ea&&"object"==typeof ea&&"default"in ea?ea["default"]:ea,na=t(function(e){e.exports={"default":ta,__esModule:!0}}),ra=na&&"object"==typeof na&&"default"in na?na["default"]:na,ia=kr("LC:MessageParser"),oa=function(){function e(){rn(this,e),this._messageClasses=[]}return e.prototype.register=function(e){if(!(e&&e.parse&&e.prototype&&e.prototype.toJSON))throw new TypeError("Invalid messageClass");this._messageClasses.unshift(e)},e.prototype.parse=function(e){ia("parsing message:",e);var t=void 0;try{t=JSON.parse(e)}catch(n){t=e}var r=!0,i=!1,o=void 0;try{for(var s,a=ra(this._messageClasses);!(r=(s=a.next()).done);r=!0){var f=s.value,u=Pr(t)?tn({},t):t,l=void 0,c=void 0;try{l=f.validate(u)}catch(n){}if(l){try{c=f.parse(u)}catch(n){console.warn("parsing a valid message content error",{error:n,Klass:f,content:u})}if(void 0!==c)return ia("parse result:",c),c}}}catch(h){i=!0,o=h}finally{try{!r&&a["return"]&&a["return"]()}finally{if(i)throw o}}throw new Error("No Message Class matched")},e}(),sa=function(e){if("number"!=typeof e)throw new TypeError(e+" is not a Number");return function(t){t.TYPE=e,t.validate=function(t){return t._lctype===e},t.prototype._getType=function(){return{_lctype:e}}}},aa=function(e){if("string"!=typeof e){if(!Array.isArray(e))throw new TypeError(e+" is not an Array");if(e.some(function(e){return"string"!=typeof e}))throw new TypeError("fields contains non-string typed member")}return function(t){var n=Array.isArray(t._customFields)?t._customFields:[];t._customFields=n.concat(e)}},fa=function(e){function t(){rn(this,t);var n=jn(this,e.call(this));return n._={},n}return kn(t,e),t.prototype.setText=function(e){return this._lctext=e,this},t.prototype.getText=function(){return this._lctext},t.prototype.setAttributes=function(e){return this._lcattrs=e,this},t.prototype.getAttributes=function(){return this._lcattrs},t.prototype._getCustomFields=function(){var e=this,t=Array.isArray(this.constructor._customFields)?this.constructor._customFields:[];return t.reduce(function(t,n){return"string"!=typeof n?t:(t[n]=e[n],t)},{})},t.prototype._getType=function(){throw new Error("not implemented")},t.prototype.toJSON=function(){return tn({_lctext:this.getText(),_lcattrs:this.getAttributes()},this._getCustomFields(),this._getType())},t.parse=function(t){var n=arguments.length<=1||void 0===arguments[1]?new this:arguments[1];n.content=t;var r=Array.isArray(n.constructor._customFields)?n.constructor._customFields:[];return r=r.reduce(function(e,n){return"string"!=typeof n?e:(e[n]=t[n],e)},{}),tn(n,r),e.parse.call(this,t,n)},To(t,[{key:"type",get:function(){return this.constructor.TYPE}},{key:"text",set:function(e){return this.setText(e)},get:function(){return this.getText()}},{key:"attributes",set:function(e){return this.setAttributes(e)},get:function(){return this.getAttributes()}}]),t}(jo);aa(["_lctext","_lcattrs"])(fa);var ua=function(e){function t(){var n=arguments.length<=0||void 0===arguments[0]?"":arguments[0];if(rn(this,t),"string"!=typeof n)throw new TypeError(n+" is not a string");var r=jn(this,e.call(this));return r.setText(n),r}return kn(t,e),t}(fa);sa(-1)(ua);var la=kr("LC:Realtime"),ca=new Br("push-router"),ha=function(e){function t(n){rn(this,t),la("initializing Realtime");var r=jn(this,e.call(this));if("string"!=typeof n.appId)throw new TypeError("appId ["+n.appId+"] is not a string");return r._options=tn({appId:void 0,region:"cn",pushOfflineMessages:!1,ssl:!0},n),r._id=wo.v4(),r._cache=new Br("endpoints"),r._clients={},r._messageParser=new oa,r.register([jo,ua]),r}return kn(t,e),t.prototype._open=function(){var e=this;if(this._openPromise)return this._openPromise;var t="protobuf";this._options.noBinary&&(t="protobase64");var n=3;this._options.pushOfflineMessages&&(n=1);var r={format:t,version:n};return this._openPromise=new Zt(function(t,n){la("No connection established, create a new one.");var i=new Ci(function(){return e._getEndpoints(e._options)},r);i.binaryType="arraybuffer",i.on("open",function(){return t(i)}),i.on("error",n),i.on("message",e._dispatchMessage.bind(e)),["disconnect","reconnect","retry","schedule"].forEach(function(t){return i.on(t,function(){for(var n=arguments.length,r=Array(n),i=0;n>i;i++)r[i]=arguments[i];la.apply(void 0,[t+" event emitted."].concat(r)),e.emit.apply(e,[t].concat(r))})}),i.handleClose=function(e){var t=Ye([oi,si,ai],function(t){return t.code===e.code});if(t){var n=new Error(""+(t.message||e.reason));n.code=e.code,this["throw"](n)}else this.disconnect()},$r(e).connection=i}),this._openPromise},t.prototype._getEndpoints=function(e){var t=this;return Zt.resolve(this._cache.get("endpoints")||this.constructor._fetchEndpointsInfo(e).then(Ur(function(e){return t._cache.set("endpoints",e,1e3*e.ttl)}))).then(function(e){return la("endpoint info:",e),[e.server,e.secondary]})},t._fetchPushRouter=function(e){var t=e.appId,n=e.region;switch(la("fetch router"),n){case"cn":var r=ca.get(t);return r?Zt.resolve(r):go.get("https://app-router.leancloud.cn/1/route",{params:{appId:t},timeout:2e4}).then(function(e){return e.data}).then(Ur(la)).then(function(e){var n=e.push_router_server;if(!n)throw new Error("push router not exists");var r=e.ttl;return"number"!=typeof r&&(r=3600),ca.set(t,n,1e3*r),n})["catch"](function(){return"router-g0-push.leancloud.cn"});case"us":return Zt.resolve("router-a0-push.leancloud.cn");default:throw new Error("Region ["+n+"] is not supported.")}},t._fetchEndpointsInfo=function(e){var t=e.appId,n=e.region,r=e.ssl,i=e._debug;return la("fetch endpoint info"),this._fetchPushRouter({appId:t,region:n}).then(Ur(la)).then(function(e){return go.get("https://"+e+"/v1/route",{params:{appId:t,secure:r,debug:i,_t:Date.now()},timeout:2e4}).then(function(e){return e.data}).then(Ur(la))})},t.prototype._close=function(){this._openPromise&&this._openPromise.then(function(e){return e.close()}),delete this._openPromise},t.prototype.retry=function(){var e=$r(this).connection;if(!e)throw new Error("no connection established");if(e.cannot("retry"))throw new Error("retrying not allowed when not offline. the connection is now "+e.current);return e.retry()},t.prototype._register=function(e){if(!(e instanceof Eo))throw new TypeError(e+" is not a Client");if(!e.id)throw new Error("Client must have an id to be registered");this._clients[e.id]=e},t.prototype._deregister=function(e){if(!(e instanceof Eo))throw new TypeError(e+" is not a Client");if(!e.id)throw new Error("Client must have an id to be deregistered");delete this._clients[e.id],0===Ee(this._clients).length&&this._close()},t.prototype._dispatchMessage=function(e){if(null!==e.peerId){var t=this._clients[e.peerId];return t?Zt.resolve(t._dispatchMessage(e))["catch"](la):la("[WARN] Unexpected message received without any live client match",Jr(e))}return la("[WARN] Unexpected message received without peerId",Jr(e))},t.prototype.createIMClient=function(e,t,n){var r=this,i="string"==typeof e;if(i&&void 0!==this._clients[e])return Zt.resolve(this._clients[e]);var o=this._open().then(function(i){var o=new Xs(e,t,i,{_messageParser:r._messageParser});return i.on("reconnect",function(){return o._open(r._options.appId,n,r._id,!0)}),o.on("close",function(){return r._deregister(o)},r),o._open(r._options.appId,n,r._id).then(function(){return r._register(o),o})});return i&&(this._clients[e]=o),o},t.prototype.createPushClient=function(){return this._open()},t.prototype.register=function(e){var t=[].concat(e);return t.map(this._messageParser.register.bind(this._messageParser))},t}(Hr);e.Realtime=ha,e.Message=jo,e.TypedMessage=fa,e.TextMessage=ua,e.messageType=sa,e.messageField=aa});